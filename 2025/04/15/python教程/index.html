<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 6.3.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"lsqyling.github.io","root":"/","scheme":"Gemini","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":true,"show_result":true,"style":"default"},"back2top":{"enable":true,"sidebar":true,"scrollpercent":true},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"path":"search.xml"};
  </script>

  <meta name="description" content="前言：  什么是Python？ 优缺点？Python是一个叫龟叔的荷兰老头写的（89年）擅长： 1.爬虫 2.自动化 3.科学计算 4.人工智能; deepseek给出的简介如下：">
<meta property="og:type" content="article">
<meta property="og:title" content="Python核心教程">
<meta property="og:url" content="https://lsqyling.github.io/2025/04/15/python%E6%95%99%E7%A8%8B/index.html">
<meta property="og:site_name" content="积累沉淀">
<meta property="og:description" content="前言：  什么是Python？ 优缺点？Python是一个叫龟叔的荷兰老头写的（89年）擅长： 1.爬虫 2.自动化 3.科学计算 4.人工智能; deepseek给出的简介如下：">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://lsqyling.github.io/images/vector_1.png">
<meta property="og:image" content="https://lsqyling.github.io/images/in_out_scatter_plot.png">
<meta property="og:image" content="https://lsqyling.github.io/images/in_out_regression_result.png">
<meta property="og:image" content="https://lsqyling.github.io/images/ser_bar_graph.png">
<meta property="og:image" content="https://lsqyling.github.io/images/ser_pie_graph.png">
<meta property="og:image" content="https://lsqyling.github.io/images/3sigma.png">
<meta property="og:image" content="https://lsqyling.github.io/images/pivot_table_1.png">
<meta property="og:image" content="https://lsqyling.github.io/images/pivot_table_2.png">
<meta property="og:image" content="https://lsqyling.github.io/images/sales_bar_graph.png">
<meta property="og:image" content="https://lsqyling.github.io/images/sales_pie_graph.png">
<meta property="article:published_time" content="2025-04-15T09:32:37.000Z">
<meta property="article:modified_time" content="2025-08-05T12:07:24.087Z">
<meta property="article:author" content="lsqyling">
<meta property="article:tag" content="Python">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://lsqyling.github.io/images/vector_1.png">

<link rel="canonical" href="https://lsqyling.github.io/2025/04/15/python%E6%95%99%E7%A8%8B/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'en'
  };
</script>

  <title>Python核心教程 | 积累沉淀</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

<!-- hexo injector head_end start -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css">

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/hexo-math@4.0.0/dist/style.css">
<!-- hexo injector head_end end --></head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">积累沉淀</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
      <p class="site-subtitle" itemprop="description">待山花烂漫，化茧成蝶</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>Tags</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>Archives</a>

  </li>
        <li class="menu-item menu-item-logs">

    <a href="/logs/" rel="section"><i class="fa fa-sync-alt fa-fw"></i>Logs</a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>Search
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off"
           placeholder="Searching..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result">
  <div id="no-result">
    <i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>
  </div>
</div>

    </div>
  </div>

</div>
    </header>

    
  <div class="reading-progress-bar"></div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://lsqyling.github.io/2025/04/15/python%E6%95%99%E7%A8%8B/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/rabbit_cartoon.jpeg">
      <meta itemprop="name" content="lsqyling">
      <meta itemprop="description" content="技术分享">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="积累沉淀">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          Python核心教程
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2025-04-15 17:32:37" itemprop="dateCreated datePublished" datetime="2025-04-15T17:32:37+08:00">2025-04-15</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2025-08-05 20:07:24" itemprop="dateModified" datetime="2025-08-05T20:07:24+08:00">2025-08-05</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <p>前言：  什么是<code>Python</code>？ 优缺点？<code>Python</code>是一个叫龟叔的荷兰老头写的（89年）擅长： 1.爬虫 2.自动化 3.科学计算 4.人工智能;<br />
deepseek给出的简介如下：</p>
<span id="more"></span>
<p>Python是一种简洁易读的高级编程语言，以动态类型和解释执行为特点，凭借丰富的标准库和第三方生态（如Django、NumPy、TensorFlow等），广泛应用于Web开发、数据分析、人工智能及自动化领域。其&quot;用缩进定义代码块&quot;的设计哲学降低了学习门槛，同时支持面向对象、函数式编程范式，被誉为平衡开发效率与工程化的&quot;胶水语言&quot;，适用于快速原型开发和企业级项目构建。</p>
<h2 id="重要的话"><a class="markdownIt-Anchor" href="#重要的话"></a> 重要的话</h2>
<ul>
<li><code>Make English as your working language.</code> （让英语成为你的工作语言）</li>
<li><code>Practice makes perfect.</code> （熟能生巧）</li>
<li><code>All experience comes from the mistakes you've made.</code> （所有的经验都源于你犯过的错误）</li>
<li><code>Don't be a freeloader.</code> （不要当伸手党）</li>
<li><code>Either outstanding or out.</code> （要么出众，要么出局）</li>
</ul>
<h2 id="语法基础"><a class="markdownIt-Anchor" href="#语法基础"></a> 语法基础</h2>
<ol start="0">
<li>注释：<code>#</code>→ 单行注释；<code>&quot;&quot;&quot;</code>→ 多行注释</li>
<li>变量：可以发生改变的一个量，变量是用来区分不同数据的，可以指向一个内存空间，帮我们存储一些数据</li>
</ol>
<ul>
<li>变量的命名规范：<br />
①必须是数字或字母或下换线组成，<br />
②不能是数字开头，更不能是纯数字<br />
③不能用python的关键字<br />
④不要用中文<br />
⑤不要太长<br />
⑥要有意义<br />
⑦推荐使用下换线命名或者驼峰命名</li>
</ul>
<ol start="2">
<li>常量：</li>
</ol>
<ul>
<li>字面量：“abc” , 123 ,True ,False ,None</li>
<li><code> MAX_COUNTS = 5000</code> <code>PI = 3.1415926</code></li>
</ul>
<ol start="3">
<li>数据类型：区分不同的数据，不同的数据类型应该有不同的操作</li>
</ol>
<ul>
<li>数字：<code>+-*/</code></li>
<li>布尔：条件判断 <code>True</code> <code>False</code></li>
<li>字符串：<code>&quot;abc&quot; , 'abc'</code><br />
操作：<br />
<code>+</code> 左右两端必须是字符串，表示字符串连接操作<br />
<code>*</code> 表示字符串重复操作，一个字符串只能乘以一个数字，表示字符串重复的次数</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">name = <span class="string">&#x27;张三&#x27;</span></span><br><span class="line">looks = <span class="string">&quot;好帅!&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(name + looks)</span><br><span class="line"><span class="built_in">print</span>(name * <span class="number">3</span>)</span><br><span class="line"><span class="comment"># output</span></span><br><span class="line"><span class="comment"># 张三好帅!</span></span><br><span class="line"><span class="comment"># 张三张三张三</span></span><br></pre></td></tr></table></figure>
<ol start="4">
<li>语句</li>
</ol>
<ul>
<li>if</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1. if语句</span></span><br><span class="line"><span class="keyword">if</span> x &gt; <span class="number">0</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;x is positive&quot;</span>)</span><br><span class="line"><span class="comment"># 2. if-else语句</span></span><br><span class="line"><span class="keyword">if</span> x &gt; <span class="number">0</span>: </span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;x is positive&quot;</span>)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;x is non-positive&quot;</span>)</span><br><span class="line"><span class="comment"># 3. if-elif-else语句</span></span><br><span class="line"><span class="keyword">if</span> x &gt; <span class="number">10</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;x &gt; 10&quot;</span>)</span><br><span class="line"><span class="keyword">elif</span> x &gt; <span class="number">7</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;7 &lt; x &lt;= 10&quot;</span>)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;x &lt; 7&quot;</span>)</span><br></pre></td></tr></table></figure>
<ul>
<li>match-case</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># http_response_code()</span></span><br><span class="line"><span class="comment"># 我们要将响应状态码401、403和404归入一个分支，400和405归入到一个分支，其他保持不变，代码还可以这么写</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">http_response_code_v0</span>():</span><br><span class="line">    status_code = <span class="built_in">int</span>(<span class="built_in">input</span>(<span class="string">&quot;模拟http的响应码：&quot;</span>))</span><br><span class="line">    <span class="keyword">match</span> status_code:</span><br><span class="line">        <span class="keyword">case</span> <span class="number">400</span> | <span class="number">405</span>: description = <span class="string">&#x27;invalid request&#x27;</span></span><br><span class="line">        <span class="keyword">case</span> <span class="number">401</span> | <span class="number">403</span> | <span class="number">404</span>: description = <span class="string">&#x27;not allowed&#x27;</span></span><br><span class="line">        <span class="keyword">case</span> <span class="number">418</span>: description = <span class="string">&#x27;I am a teapot&#x27;</span></span><br><span class="line">        <span class="keyword">case</span> <span class="number">429</span>: description = <span class="string">&#x27;too many requests&#x27;</span></span><br><span class="line">        <span class="keyword">case</span> _: description = <span class="string">&#x27;unknown status code&#x27;</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;状态码描述：&#x27;</span>, description)</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<ul>
<li>while</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">i = <span class="number">0</span></span><br><span class="line"><span class="keyword">while</span> i &lt; <span class="number">100</span>:</span><br><span class="line">    <span class="built_in">print</span>(i)</span><br><span class="line">    i = i + <span class="number">1</span></span><br></pre></td></tr></table></figure>
<ul>
<li>for</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">name = <span class="string">&quot;zhangsan&quot;</span></span><br><span class="line"><span class="keyword">for</span> c <span class="keyword">in</span> name:</span><br><span class="line">    <span class="built_in">print</span>(c)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10</span>):</span><br><span class="line">    <span class="built_in">print</span>(j)</span><br><span class="line"><span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">3</span>, <span class="number">10</span>):</span><br><span class="line">    <span class="built_in">print</span>(k)</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<ul>
<li>pass<br />
pass 是一个特殊的占位符关键字，用于表示“什么都不做”。它的主要作用是满足语法要求，避免代码块为空时引发语法错误。</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">my_func</span>():</span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">MyClass</span>:</span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line">x = <span class="number">5</span></span><br><span class="line"><span class="keyword">if</span> x &gt; <span class="number">3</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;x &gt; 3&quot;</span>)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    <span class="keyword">pass</span></span><br></pre></td></tr></table></figure>
<ol start="5">
<li>字符串</li>
</ol>
<ul>
<li>格式化字符串</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">name = <span class="built_in">input</span>(<span class="string">&quot;请输入你的名字:&quot;</span>)</span><br><span class="line">address = <span class="built_in">input</span>(<span class="string">&quot;请输入你的住址:&quot;</span>)</span><br><span class="line">age = <span class="built_in">int</span>(<span class="built_in">input</span>(<span class="string">&quot;请输入你的年龄:&quot;</span>))</span><br><span class="line">hobby = <span class="built_in">input</span>(<span class="string">&quot;请输入你的爱好:&quot;</span>)</span><br><span class="line"></span><br><span class="line">s = <span class="string">&quot;我叫%s, 我住在%s, 我今年%d岁, 我喜欢做%s&quot;</span> % (name, address, age, hobby)</span><br><span class="line"><span class="built_in">print</span>(s)</span><br><span class="line">s1 = <span class="string">&quot;我叫&#123;&#125;, 我住在&#123;&#125;, 我今年&#123;&#125;岁, 我喜欢做&#123;&#125;&quot;</span>.<span class="built_in">format</span>(name, address, age, hobby)</span><br><span class="line"><span class="built_in">print</span>(s1)</span><br><span class="line"><span class="comment"># f-string</span></span><br><span class="line">s2 = <span class="string">f&quot;我叫<span class="subst">&#123;name&#125;</span>, 我住在<span class="subst">&#123;address&#125;</span>, 我今年<span class="subst">&#123;age&#125;</span>岁, 我喜欢做<span class="subst">&#123;hobby&#125;</span>&quot;</span></span><br><span class="line"><span class="built_in">print</span>(s2)</span><br></pre></td></tr></table></figure>
<ul>
<li>索引和切片</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 索引和切片</span></span><br><span class="line">s = <span class="string">&quot;我叫周杰伦&quot;</span></span><br><span class="line"><span class="built_in">print</span>(s[<span class="number">0</span>])</span><br><span class="line"><span class="built_in">print</span>(s[<span class="number">1</span>])</span><br><span class="line"><span class="built_in">print</span>(s[<span class="number">2</span>])</span><br><span class="line"><span class="built_in">print</span>(s[<span class="number">3</span>])</span><br><span class="line"><span class="built_in">print</span>(s[<span class="number">4</span>])</span><br><span class="line"><span class="built_in">print</span>(s[-<span class="number">1</span>])</span><br><span class="line"><span class="built_in">print</span>(s[-<span class="number">2</span>])</span><br><span class="line"><span class="built_in">print</span>(s[-<span class="number">3</span>])</span><br><span class="line"><span class="built_in">print</span>(s[-<span class="number">4</span>])</span><br><span class="line"><span class="built_in">print</span>(s[-<span class="number">5</span>])</span><br><span class="line"><span class="comment"># print(s[-6]) IndexError:</span></span><br><span class="line"><span class="comment"># 切片</span></span><br><span class="line"><span class="comment"># 语法：s[start：end]从start到end进行切片。但是取不到end[start，end)</span></span><br><span class="line"><span class="built_in">print</span>(s[<span class="number">2</span>:<span class="number">5</span>])           <span class="comment"># [2, 5)</span></span><br><span class="line"><span class="built_in">print</span>(s[:<span class="number">5</span>])            <span class="comment"># [0, 5)如果start是从开头进行切片，可以省略</span></span><br><span class="line"><span class="built_in">print</span>(s[<span class="number">3</span>:])            <span class="comment"># [3, end) 从start开始一直截取到未尾</span></span><br><span class="line"><span class="built_in">print</span>(s[:])             <span class="comment"># 如果左右两端有空白，表示开头或者结尾</span></span><br><span class="line"><span class="built_in">print</span>(s[-<span class="number">5</span>:-<span class="number">1</span>])         <span class="comment"># [-5, -1)</span></span><br><span class="line"><span class="comment"># print(s[-1:-5]) # []</span></span><br><span class="line">s = <span class="string">&quot;我爱你&quot;</span></span><br><span class="line"><span class="comment"># 语法：s[start:end:step]从start切到end, 每step个元素出来一个元素</span></span><br><span class="line"><span class="comment"># 可以给切片添加步长来控制切片的方向</span></span><br><span class="line"><span class="comment"># -表示从右往左</span></span><br><span class="line"><span class="built_in">print</span>(s[::-<span class="number">1</span>])</span><br><span class="line">s = <span class="string">&quot;abcdefghijklmnopqrstuvwxyz&quot;</span></span><br><span class="line"><span class="built_in">print</span>(s[<span class="number">1</span>:<span class="number">15</span>:<span class="number">2</span>])            <span class="comment"># 1, 3, 5, 7, 9, 11, 13</span></span><br><span class="line"><span class="built_in">print</span>(s[-<span class="number">1</span>:-<span class="number">10</span>:-<span class="number">2</span>])         <span class="comment"># -1, -3, -5, -7, -9</span></span><br></pre></td></tr></table></figure>
<ul>
<li>大小写转换</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">s = <span class="string">&quot;python&quot;</span></span><br><span class="line"><span class="comment"># 首字母大写</span></span><br><span class="line">s1 = s.capitalize()</span><br><span class="line"><span class="built_in">print</span>(s1)</span><br><span class="line">s = <span class="string">&quot;I have a dream!&quot;</span></span><br><span class="line"><span class="comment"># 字符串中每个单词首字母大写</span></span><br><span class="line">s1 = s.title()</span><br><span class="line"><span class="built_in">print</span>(s1)</span><br><span class="line">s = <span class="string">&quot;I HAVE A DREAM!&quot;</span></span><br><span class="line"><span class="comment"># 所有字符小写</span></span><br><span class="line">s1 = s.lower()</span><br><span class="line"><span class="built_in">print</span>(s1)</span><br><span class="line">s = <span class="string">&quot;i have a dream&quot;</span></span><br><span class="line"><span class="comment"># 所有字符大写</span></span><br><span class="line">s1 = s.upper()</span><br><span class="line"><span class="built_in">print</span>(s1)</span><br><span class="line"><span class="comment"># 忽略大小写进行判断</span></span><br><span class="line">varify_code = <span class="string">&quot;xAd1&quot;</span></span><br><span class="line">user_input = <span class="built_in">input</span>(<span class="string">f&quot;请输入验证码<span class="subst">&#123;varify_code&#125;</span>:&quot;</span>)</span><br><span class="line"><span class="keyword">if</span> user_input.upper() == varify_code.upper():</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;验证码正确&quot;</span>)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;验证码错误&quot;</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<ul>
<li>替换和切割</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">s = <span class="string">&quot;    我是周润发      &quot;</span></span><br><span class="line"><span class="comment"># 去除字符串首尾的空白字符(空格 制表符 换行符)</span></span><br><span class="line">s = s.strip()</span><br><span class="line"><span class="built_in">print</span>(s)</span><br><span class="line">username = <span class="built_in">input</span>(<span class="string">&quot;请输入用户名:&quot;</span>)</span><br><span class="line">password = <span class="built_in">input</span>(<span class="string">&quot;请输入密码:&quot;</span>)</span><br><span class="line"><span class="keyword">if</span> username.strip() == <span class="string">&quot;admin&quot;</span> <span class="keyword">and</span> password.strip() == <span class="string">&quot;123456&quot;</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;登录成功&quot;</span>)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;登陆失败&quot;</span>)</span><br><span class="line">s = <span class="string">&quot;i am a good man&quot;</span></span><br><span class="line">s = s.replace(<span class="string">&quot; &quot;</span>, <span class="string">&quot;&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(s)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 字符串切割,用什么切，就会损失掉谁</span></span><br><span class="line">s = <span class="string">&quot;c++_c_java_c#_javascript_python&quot;</span></span><br><span class="line">slist = s.split(<span class="string">&quot;_&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(slist)    <span class="comment"># [&#x27;c++&#x27;, &#x27;c&#x27;, &#x27;java&#x27;, &#x27;c#&#x27;, &#x27;javascript&#x27;, &#x27;python&#x27;]</span></span><br></pre></td></tr></table></figure>
<ul>
<li>查找和替换</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 字符串查找</span></span><br><span class="line">s = <span class="string">&quot;我是周润发，你是刘德华&quot;</span></span><br><span class="line"><span class="comment"># 查找成功返回所在的索引位置，否则返回-1</span></span><br><span class="line">ret = s.find(<span class="string">&quot;刘德华123&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(ret)</span><br><span class="line"><span class="comment"># ret = s.index(&quot;刘德华123&quot;)  # Exception: ValueError</span></span><br><span class="line"><span class="comment"># print(ret)</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;周润发&quot;</span> <span class="keyword">in</span> s)       <span class="comment"># in可以做条件上的判断</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;周润发134&quot;</span> <span class="keyword">not</span> <span class="keyword">in</span> s)    <span class="comment"># not in判断是否不存在</span></span><br><span class="line"><span class="comment"># 判断字符串是否以xxxxx开头，endswith（）</span></span><br><span class="line"><span class="comment"># s.startswith endswith</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line">s = <span class="string">&quot;1234e&quot;</span></span><br><span class="line"><span class="keyword">if</span> s.isdigit():</span><br><span class="line">    s = <span class="built_in">int</span>(s)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;可以花钱了&quot;</span>)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;不可以花钱&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># len() type() input()内置函数</span></span><br><span class="line"><span class="comment"># len() 字符个数</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">len</span>(s))</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">len</span>(<span class="string">&quot;我叫周润发&quot;</span>))</span><br><span class="line"><span class="comment"># join()</span></span><br><span class="line"><span class="built_in">list</span> = [<span class="string">&quot;刘德华&quot;</span>, <span class="string">&quot;周润发&quot;</span>, <span class="string">&quot;张三&quot;</span>, <span class="string">&quot;李四&quot;</span>]</span><br><span class="line">s = <span class="string">&quot;_&quot;</span>.join(<span class="built_in">list</span>)</span><br><span class="line"><span class="built_in">print</span>(s)        <span class="comment"># 刘德华_周润发_张三_李四</span></span><br></pre></td></tr></table></figure>
<ol start="6">
<li>列表<br />
在python中用门来表示一个列表，列表中的元素通过，隔开</li>
</ol>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 列表索引和切片：用法和字符串一样</span></span><br><span class="line"><span class="comment"># 列表的增删改查（*）</span></span><br><span class="line">lst = []</span><br><span class="line">lst.append(<span class="string">&quot;刘德华&quot;</span>)</span><br><span class="line">lst.append(<span class="string">&quot;周润发&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(lst)</span><br><span class="line">lst.insert(<span class="number">0</span>, <span class="string">&quot;赵本山&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(lst)</span><br><span class="line"><span class="comment"># 可以合并两个列表</span></span><br><span class="line">lst.extend([<span class="string">&quot;张三&quot;</span>, <span class="string">&quot;李四&quot;</span>])</span><br><span class="line"><span class="built_in">print</span>(lst)</span><br><span class="line"><span class="comment"># 弹出最后一个元素</span></span><br><span class="line">ret = lst.pop()</span><br><span class="line"><span class="built_in">print</span>(ret)</span><br><span class="line"></span><br><span class="line"><span class="comment"># remove</span></span><br><span class="line">lst.remove(<span class="string">&quot;张三&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(lst)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 修改</span></span><br><span class="line"><span class="comment"># 直接用索引就可以进行修改操作</span></span><br><span class="line">lst[<span class="number">0</span>] = <span class="string">&quot;赵敏&quot;</span></span><br><span class="line"><span class="comment"># 查询</span></span><br><span class="line"><span class="comment"># 直接用索引进行查询操作</span></span><br><span class="line"><span class="built_in">print</span>(lst[<span class="number">2</span>])</span><br><span class="line"></span><br><span class="line"><span class="comment"># 小练习：</span></span><br><span class="line"><span class="comment"># 把所有的姓张的人修改成姓王</span></span><br><span class="line">lst = [<span class="string">&quot;赵敏&quot;</span>, <span class="string">&quot;张绍刚&quot;</span>, <span class="string">&quot;赵本山&quot;</span>, <span class="string">&quot;张无忌&quot;</span>, <span class="string">&quot;武则天&quot;</span>, <span class="string">&quot;赢政&quot;</span>, <span class="string">&quot;马超&quot;</span>]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(lst)):</span><br><span class="line">    item = lst[i]</span><br><span class="line">    <span class="keyword">if</span> item.startswith(<span class="string">&quot;张&quot;</span>):</span><br><span class="line">        lst[i] = <span class="string">&quot;王&quot;</span> + item[<span class="number">1</span>:]</span><br><span class="line"><span class="built_in">print</span>(lst)</span><br><span class="line"></span><br><span class="line">lst = [<span class="number">22</span>, <span class="number">0</span>, <span class="number">9</span>, <span class="number">54</span>, <span class="number">100</span>, <span class="number">99</span>, <span class="number">5</span>, <span class="number">3</span>]</span><br><span class="line">lst.sort()</span><br><span class="line"><span class="built_in">print</span>(lst)</span><br><span class="line">lst.sort(reverse=<span class="literal">True</span>)</span><br><span class="line"><span class="built_in">print</span>(lst)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 列表的嵌套</span></span><br><span class="line">lst = [<span class="string">&quot;abc&quot;</span>, <span class="string">&quot;def&quot;</span>, [<span class="string">&quot;呵呵哒&quot;</span>, <span class="string">&quot;妈妈呀&quot;</span>, <span class="string">&quot;苦苦脊瓦&quot;</span>, [<span class="string">&quot;可乐&quot;</span>, <span class="string">&quot;scrapy&quot;</span>, <span class="number">123</span>]], <span class="string">&quot;aed&quot;</span>, <span class="string">&quot;qpr&quot;</span>]</span><br><span class="line">lst[<span class="number">2</span>][<span class="number">3</span>][<span class="number">1</span>] = lst[<span class="number">2</span>][<span class="number">3</span>][<span class="number">1</span>].upper()</span><br><span class="line"><span class="built_in">print</span>(lst)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 列表的循环删除(*)</span></span><br><span class="line">lst = [<span class="string">&quot;赵敏&quot;</span>, <span class="string">&quot;张绍刚&quot;</span>, <span class="string">&quot;赵本山&quot;</span>, <span class="string">&quot;张无忌&quot;</span>, <span class="string">&quot;武则天&quot;</span>, <span class="string">&quot;赢政&quot;</span>, <span class="string">&quot;马超&quot;</span>]</span><br><span class="line">tmplst = []</span><br><span class="line"><span class="keyword">for</span> item <span class="keyword">in</span> lst:</span><br><span class="line">    <span class="keyword">if</span> item.startswith(<span class="string">&quot;张&quot;</span>):</span><br><span class="line">        tmplst.append(item)</span><br><span class="line"><span class="keyword">for</span> item <span class="keyword">in</span> tmplst:</span><br><span class="line">    lst.remove(item)</span><br><span class="line"><span class="built_in">print</span>(lst)</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<ol start="7">
<li>元组<br />
tuple元组，特点：不可变的列表</li>
</ol>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># tuple元组，特点：不可变的列表</span></span><br><span class="line">t = (<span class="string">&quot;周芷若&quot;</span>, <span class="string">&quot;张三丰&quot;</span>, <span class="string">&quot;张无忌&quot;</span>, <span class="string">&quot;赵敏&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">type</span>(t))</span><br><span class="line"><span class="built_in">print</span>(t)</span><br><span class="line"><span class="built_in">print</span>(t[<span class="number">0</span>])</span><br><span class="line"><span class="built_in">print</span>(t[<span class="number">1</span>:<span class="number">3</span>])</span><br><span class="line"><span class="comment"># t[0] = &quot;樵夫&quot; # TypeError: &#x27;tuple&#x27; object does not support item assignment</span></span><br><span class="line"><span class="built_in">print</span>(t)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 你固定了某些数据。不允许外界修改</span></span><br><span class="line"><span class="comment"># 元组如果只有1个元素（*），需要在元素的末尾添加一个逗号</span></span><br><span class="line">t = (<span class="string">&quot;哈哈哈哈&quot;</span>,)</span><br><span class="line"><span class="built_in">print</span>(t)</span><br><span class="line"><span class="comment"># 关于元组的不可变（坑），内存地址不能变</span></span><br><span class="line">t = (<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, [<span class="string">&quot;zhang&quot;</span>, <span class="string">&quot;wang&quot;</span>, <span class="string">&quot;zhao&quot;</span>, <span class="string">&quot;li&quot;</span>])</span><br><span class="line">t[<span class="number">4</span>].append(<span class="string">&quot;tang&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(t)</span><br></pre></td></tr></table></figure>
<ol start="8">
<li>set集合</li>
</ol>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line">s = &#123;<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="string">&quot;zhan&quot;</span>&#125;</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">type</span>(s))</span><br><span class="line"><span class="built_in">print</span>(s)</span><br><span class="line"></span><br><span class="line"><span class="comment"># s = &#123;1, 2, 3, &quot;zhan&quot;, [&quot;zhao&quot;]&#125; # TypeError:unhashable type &#x27;list&#x27;</span></span><br><span class="line"><span class="comment"># 不可哈希：python中的set集合进行数据存储的时候，需要对数据进行哈希计算，根据计算出来的哈希值进行存储数据</span></span><br><span class="line"><span class="comment"># set集合要求存储的数据必须是可以进行哈希计算的.</span></span><br><span class="line"><span class="comment"># 可变的数据类型，list，dict，set</span></span><br><span class="line"><span class="comment"># 可哈希：不可变的数据类型，int，str，tuple，bool.</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 创建空数据</span></span><br><span class="line">s = <span class="built_in">set</span>()</span><br><span class="line">lst = <span class="built_in">list</span>()</span><br><span class="line">t = <span class="built_in">tuple</span>()</span><br><span class="line">ss = <span class="built_in">str</span>()</span><br><span class="line">s.add(<span class="string">&quot;zhan&quot;</span>)</span><br><span class="line">s.add(<span class="string">&quot;li&quot;</span>)</span><br><span class="line">s.add(<span class="string">&quot;wang&quot;</span>)</span><br><span class="line">s.add(<span class="string">&quot;tang&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(s)</span><br><span class="line"><span class="comment"># 经过多次测试，验证弹出的是集合中的第一个元素，但是第一个元素也是不确定的，即每次打出来的第一个元素可能都不一样</span></span><br><span class="line"><span class="comment"># print(s.pop())</span></span><br><span class="line"><span class="comment"># print(s)</span></span><br><span class="line">s.remove(<span class="string">&quot;tang&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(s)</span><br><span class="line"><span class="comment"># 想要修改，先删除，再新增</span></span><br><span class="line">s.remove(<span class="string">&quot;zhan&quot;</span>)</span><br><span class="line">s.add(<span class="string">&quot;zhan-san&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(s)</span><br><span class="line"><span class="keyword">for</span> item <span class="keyword">in</span> s:</span><br><span class="line">    <span class="built_in">print</span>(item)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 交集，并集，差集</span></span><br><span class="line">s1 = &#123;<span class="string">&#x27;刘能&#x27;</span>, <span class="string">&#x27;赵四&#x27;</span>, <span class="string">&#x27;皮常山&#x27;</span>&#125;</span><br><span class="line">s2 = &#123;<span class="string">&#x27;皮常山&#x27;</span>, <span class="string">&#x27;冯乡长&#x27;</span>, <span class="string">&#x27;刘科长&#x27;</span>&#125;</span><br><span class="line"><span class="built_in">print</span>(s1 &amp; s2)</span><br><span class="line"><span class="built_in">print</span>(s1.intersection(s2))</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(s1 | s2)</span><br><span class="line"><span class="built_in">print</span>(s1.union(s2))</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(s1 - s2)</span><br><span class="line"><span class="built_in">print</span>(s1.difference(s2))</span><br><span class="line"></span><br><span class="line"><span class="comment"># 重要的作用：可以去除重复</span></span><br><span class="line">lst = [<span class="string">&quot;zhan&quot;</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="string">&quot;wang&quot;</span>, <span class="string">&quot;zhao&quot;</span>, <span class="string">&quot;zhan&quot;</span>]</span><br><span class="line"><span class="built_in">print</span>(lst)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">set</span>(lst))</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">list</span>(<span class="built_in">set</span>(lst)))</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<ol start="9">
<li>字典<br />
首先，字典是以键值对的形式进行存储数据的<br />
字典的表示方式：{key:value，key2:value，key3:value}</li>
</ol>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># dict</span></span><br><span class="line">dic = &#123;<span class="string">&#x27;zhan&#x27;</span>: <span class="string">&#x27;张三&#x27;</span>, <span class="string">&#x27;zhao&#x27;</span>: <span class="string">&#x27;赵四&#x27;</span>&#125;</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">type</span>(dic))</span><br><span class="line"><span class="built_in">print</span>(dic)</span><br><span class="line"></span><br><span class="line">val = dic[<span class="string">&#x27;zhan&#x27;</span>]</span><br><span class="line"><span class="built_in">print</span>(val)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 字典的key必须是可哈希的数据类型</span></span><br><span class="line"><span class="comment"># 字典的value可以是任何数据类型</span></span><br><span class="line">dic = &#123;<span class="string">&#x27;wang&#x27;</span>: [<span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;2&#x27;</span>, <span class="string">&#x27;3&#x27;</span>, <span class="string">&#x27;4&#x27;</span>]&#125;</span><br><span class="line"><span class="built_in">print</span>(dic)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 字典的增删改查</span></span><br><span class="line">dic = <span class="built_in">dict</span>()</span><br><span class="line">dic[<span class="string">&#x27;zhan&#x27;</span>] = <span class="string">&#x27;周杰伦&#x27;</span></span><br><span class="line">dic[<span class="number">1</span>] = <span class="number">13</span></span><br><span class="line"><span class="built_in">print</span>(dic)</span><br><span class="line">dic[<span class="string">&#x27;zhan&#x27;</span>] = <span class="string">&#x27;刘德华&#x27;</span></span><br><span class="line"><span class="built_in">print</span>(dic)</span><br><span class="line"></span><br><span class="line">dic.setdefault(<span class="string">&#x27;zhao&#x27;</span>, <span class="string">&#x27;赵华&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(dic)</span><br><span class="line"><span class="comment"># 设置默认值，如果以前已经有了tom了，setdefault就不起作用了</span></span><br><span class="line">dic.setdefault(<span class="string">&#x27;zhan&#x27;</span>, <span class="string">&#x27;ABC&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(dic)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 删除</span></span><br><span class="line">dic.pop(<span class="string">&#x27;zhan&#x27;</span>)</span><br><span class="line">dic.pop(<span class="number">1</span>)</span><br><span class="line"><span class="built_in">print</span>(dic)</span><br><span class="line"><span class="comment"># 查询</span></span><br><span class="line"><span class="built_in">print</span>(dic[<span class="string">&#x27;zhao&#x27;</span>])</span><br><span class="line"><span class="built_in">print</span>(dic.get(<span class="string">&#x27;zhao&#x27;</span>))</span><br><span class="line"><span class="comment"># 如果key不存在，程序会报错</span></span><br><span class="line"><span class="comment"># print(dic[&#x27;zhao123&#x27;])</span></span><br><span class="line"><span class="built_in">print</span>(dic.get(<span class="string">&#x27;zhao10010&#x27;</span>))     <span class="comment"># if key is not exist, the result is &#x27;None&#x27;</span></span><br><span class="line"><span class="comment"># None</span></span><br><span class="line">a = <span class="literal">None</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">type</span>(a))      <span class="comment"># &lt;class &#x27;NoneType&#x27;&gt;</span></span><br><span class="line"><span class="built_in">print</span>(a)            <span class="comment"># None</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># simple example:</span></span><br><span class="line">dic = &#123;</span><br><span class="line">    <span class="string">&#x27;赵四&#x27;</span>: <span class="string">&#x27;特别能歪嘴&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;刘能&#x27;</span>: <span class="string">&#x27;老，老四啊。。。&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;大脚&#x27;</span>: <span class="string">&#x27;跟这个跟哪个搞对象&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;大脑袋&#x27;</span>: <span class="string">&#x27;瞎折腾.....&#x27;</span>,</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment"># name = input(&#x27;请输入我们村的人:&#x27;)</span></span><br><span class="line">name = <span class="string">&#x27;hh&#x27;</span></span><br><span class="line">val = dic.get(name)</span><br><span class="line"><span class="keyword">if</span> val <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;我们村没有这个人！&#x27;</span>)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    <span class="built_in">print</span>(val)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 字典进阶操作</span></span><br><span class="line"><span class="comment"># 循环和嵌套</span></span><br><span class="line"><span class="comment"># 可以用for循环，直接拿到key</span></span><br><span class="line"><span class="keyword">for</span> key <span class="keyword">in</span> dic:</span><br><span class="line">    <span class="built_in">print</span>(key, dic[key])</span><br><span class="line"><span class="comment"># 希望把所有的key全都保存在一个列表中</span></span><br><span class="line"><span class="comment"># dict_keys([&#x27;赵四&#x27;, &#x27;刘能&#x27;, &#x27;大脚&#x27;, &#x27;大脑袋&#x27;])</span></span><br><span class="line"><span class="built_in">print</span>(dic.keys())</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">type</span>(dic.keys()))</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">list</span>(dic.keys()))</span><br><span class="line"><span class="comment"># 希望吧所有的value都放在一个列表中</span></span><br><span class="line"><span class="built_in">print</span>(dic.values())</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">type</span>(dic.values()))</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">list</span>(dic.values()))</span><br><span class="line"><span class="comment"># 直接拿到字典中的key和value</span></span><br><span class="line"><span class="comment"># ict_items([(&#x27;赵四&#x27;, &#x27;特别能歪嘴&#x27;), (&#x27;刘能&#x27;, &#x27;老，老四啊。。。&#x27;), (&#x27;大脚&#x27;, &#x27;跟这个跟哪个搞对象&#x27;), (&#x27;大脑袋&#x27;, &#x27;瞎折腾.....&#x27;)])</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">type</span>(dic.items()))</span><br><span class="line"><span class="comment"># &lt;class &#x27;dict_items&#x27;&gt;</span></span><br><span class="line"><span class="built_in">print</span>(dic.items())</span><br><span class="line"><span class="keyword">for</span> item <span class="keyword">in</span> dic.items():</span><br><span class="line">    <span class="comment"># key = item[0]</span></span><br><span class="line">    <span class="comment"># val = item[1]</span></span><br><span class="line">    key, val = item</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;&#123;&#x27;</span> + <span class="string">f&quot;<span class="subst">&#123;key&#125;</span>: <span class="subst">&#123;val&#125;</span>&quot;</span> + <span class="string">&#x27;&#125;&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 元组或者列表都可以执行该操作，该操作被称为解构（解包）</span></span><br><span class="line">a, b = (<span class="number">1</span>, <span class="number">2</span>)</span><br><span class="line"><span class="built_in">print</span>(a, b)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> k, v <span class="keyword">in</span> dic.items():</span><br><span class="line">    <span class="built_in">print</span>(k, v)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 字典的嵌套</span></span><br><span class="line"><span class="comment"># 类似json字符串</span></span><br><span class="line">wangfeng = &#123;</span><br><span class="line">    <span class="string">&#x27;name&#x27;</span>: <span class="string">&#x27;汪峰&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;age&#x27;</span>: <span class="number">18</span>,</span><br><span class="line">    <span class="string">&#x27;wife&#x27;</span>: &#123;</span><br><span class="line">        <span class="string">&#x27;name&#x27;</span>: <span class="string">&#x27;章子怡&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;hobby&#x27;</span>: <span class="string">&#x27;演戏&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;assistant&#x27;</span>: &#123;</span><br><span class="line">            <span class="string">&#x27;name&#x27;</span>: <span class="string">&#x27;樵夫&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;age&#x27;</span>: <span class="number">19</span>,</span><br><span class="line">            <span class="string">&#x27;hobby&#x27;</span>: <span class="string">&#x27;打游戏&#x27;</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="string">&#x27;children&#x27;</span>: [</span><br><span class="line">        &#123;<span class="string">&#x27;name&#x27;</span>: <span class="string">&#x27;孩子1&#x27;</span>, <span class="string">&#x27;age&#x27;</span>: <span class="number">10</span>&#125;,</span><br><span class="line">        &#123;<span class="string">&#x27;name&#x27;</span>: <span class="string">&#x27;孩子2&#x27;</span>, <span class="string">&#x27;age&#x27;</span>: <span class="number">8</span>&#125;,</span><br><span class="line">        &#123;<span class="string">&#x27;name&#x27;</span>: <span class="string">&#x27;孩子3&#x27;</span>, <span class="string">&#x27;age&#x27;</span>: <span class="number">11</span>&#125;,</span><br><span class="line">    ]</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># 汪峰子的助手的名字</span></span><br><span class="line">name = wangfeng[<span class="string">&#x27;wife&#x27;</span>][<span class="string">&#x27;assistant&#x27;</span>][<span class="string">&#x27;name&#x27;</span>]</span><br><span class="line"><span class="built_in">print</span>(name)</span><br><span class="line"><span class="comment"># 给汪峰的第二个孩子加1岁</span></span><br><span class="line">wangfeng[<span class="string">&#x27;children&#x27;</span>][<span class="number">1</span>][<span class="string">&#x27;age&#x27;</span>] += <span class="number">1</span></span><br><span class="line"><span class="built_in">print</span>(wangfeng)</span><br><span class="line"><span class="comment"># 补充。关于字典的循环删除</span></span><br><span class="line">dic = &#123;</span><br><span class="line">    <span class="string">&#x27;赵四&#x27;</span>: <span class="string">&#x27;特别能歪嘴&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;刘能&#x27;</span>: <span class="string">&#x27;老，老四啊。。。&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;大脚&#x27;</span>: <span class="string">&#x27;跟这个跟哪个搞对象&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;大脑袋&#x27;</span>: <span class="string">&#x27;瞎折腾.....&#x27;</span>,</span><br><span class="line">&#125;</span><br><span class="line">tmp = []</span><br><span class="line"><span class="keyword">for</span> key <span class="keyword">in</span> dic.keys():</span><br><span class="line">    <span class="keyword">if</span> key.startswith(<span class="string">&#x27;大&#x27;</span>):</span><br><span class="line">        tmp.append(key)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> k <span class="keyword">in</span> tmp:</span><br><span class="line">    dic.pop(k)</span><br><span class="line"><span class="built_in">print</span>(dic)</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<ol start="10">
<li>bytes</li>
</ol>
<ul>
<li>字符集和编码<br />
①<code>ascii</code>: 8bit, 1byte<br />
②<code>gbk</code>: 16bit，2byte windows默认<br />
③<code>unicode</code>：32bit，4byte（没法用，只是一个标准）<br />
④<code>utf-8</code>: mac默认<br />
英文：8bit，1byte<br />
欧洲：16bit，2byte<br />
中文：24bit，3byte</li>
<li>示例</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># bytes</span></span><br><span class="line">s = <span class="string">&#x27;周杰伦&#x27;</span></span><br><span class="line">s1 = s.encode(<span class="string">&#x27;gbk&#x27;</span>)</span><br><span class="line"><span class="comment"># &lt;class &#x27;bytes&#x27;&gt;</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">type</span>(s1))</span><br><span class="line"><span class="comment"># b&#x27;\xd6\xdc\xbd\xdc\xc2\xd7&#x27;</span></span><br><span class="line"><span class="built_in">print</span>(s1)</span><br><span class="line">s2 = s.encode(<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(s2)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 怎么把一个gbk的字节转化成utf-8的字节</span></span><br><span class="line">b1 = <span class="string">b&#x27;\xd6\xdc\xbd\xdc\xc2\xd7&#x27;</span></span><br><span class="line">s = b1.decode(<span class="string">&#x27;gbk&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(s)</span><br><span class="line">b2 = s.encode(<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(b2)</span><br><span class="line">s = <span class="string">&quot;你好abc呵呵哒&quot;</span></span><br><span class="line"><span class="built_in">print</span>(s.encode(<span class="string">&#x27;utf-8&#x27;</span>))</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(s)):</span><br><span class="line">    <span class="built_in">print</span>(s[i])</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<ol start="11">
<li>运算符<br />
①算数运算<br />
<code>+ - * / % //(地板除)</code><br />
②比较运算<br />
<code>&gt; &lt; &gt;= &lt;= == !=</code><br />
③赋值运算<br />
<code>= += -= *= /= %= //=</code><br />
④逻辑运算<br />
<code>and or not</code><br />
记住运算顺序：先算括号&gt;算not&gt;and&gt;or<br />
⑤成员运算<br />
<code>in</code>： 判断xxx是否在xxxx中出现了<br />
<code>not in</code>：判断xxx是否环在xxxx中出现了</li>
</ol>
<h2 id="文件操作"><a class="markdownIt-Anchor" href="#文件操作"></a> 文件操作</h2>
<ol>
<li>api</li>
</ol>
<ul>
<li><code>open</code>(文件路径，mode=“”，encoding=“”)<br />
文件路径：<br />
①绝对路径 d:/test/xxxx.txt<br />
②相对路径 相对于当前你的程序所在的文件夹<br />
<code>mode</code>:<br />
①r：只读(read)<br />
②w：写(write)<br />
③a：追加(append)<br />
④b:读写的是非文本文件，此时encoding无需写</li>
</ul>
<ol start="2">
<li><code>with</code>：上下文，不需要手动去关闭一个文件</li>
<li>示例</li>
</ol>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="comment"># 文件操作</span></span><br><span class="line">f = <span class="built_in">open</span>(<span class="string">&quot;./file.py&quot;</span>, mode=<span class="string">&quot;r&quot;</span>, encoding=<span class="string">&quot;utf-8&quot;</span>)</span><br><span class="line"><span class="comment"># content = f.read().strip()          # 全部读完</span></span><br><span class="line"><span class="comment"># print(content)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 读完一行</span></span><br><span class="line"><span class="comment"># line = f.readline()</span></span><br><span class="line"><span class="comment"># print(line)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 最重要的一种文本读取方式（必须掌握</span></span><br><span class="line"><span class="keyword">for</span> line <span class="keyword">in</span> f:</span><br><span class="line">    <span class="built_in">print</span>(line.strip())</span><br><span class="line"></span><br><span class="line"><span class="comment">#     写入文件</span></span><br><span class="line"><span class="comment"># w模式下，如果文件不存在，自动的创建一个文件</span></span><br><span class="line"><span class="comment"># w模式下，每一次open都会清空掉文件中的内容</span></span><br><span class="line">f = <span class="built_in">open</span>(<span class="string">&quot;嫩模.md&quot;</span>, mode=<span class="string">&quot;w&quot;</span>, encoding=<span class="string">&quot;utf-8&quot;</span>)</span><br><span class="line">f.write(<span class="string">&quot;胡辣汤&quot;</span>)</span><br><span class="line">f.close()</span><br><span class="line"></span><br><span class="line"><span class="comment"># 准备一个列表·要求把列表中的每一项内容。写入到文件中</span></span><br><span class="line">f = <span class="built_in">open</span>(<span class="string">&quot;嫩模.md&quot;</span>, mode=<span class="string">&quot;w&quot;</span>, encoding=<span class="string">&quot;utf-8&quot;</span>)</span><br><span class="line">lst = [<span class="string">&quot;汪峰&quot;</span>, <span class="string">&quot;汪峰&quot;</span>, <span class="string">&quot;汪峰&quot;</span>, <span class="string">&quot;汪峰&quot;</span>, <span class="string">&quot;汪峰&quot;</span>]</span><br><span class="line"><span class="keyword">for</span> item <span class="keyword">in</span> lst:</span><br><span class="line">    f.write(item)</span><br><span class="line">    f.write(<span class="string">&quot;\n&quot;</span>)</span><br><span class="line">f.close()</span><br><span class="line"></span><br><span class="line">f = <span class="built_in">open</span>(<span class="string">&quot;嫩模.md&quot;</span>, mode=<span class="string">&quot;a&quot;</span>, encoding=<span class="string">&quot;utf-8&quot;</span>)</span><br><span class="line">f.write(<span class="string">&quot;这是一个追加的内容&quot;</span>)</span><br><span class="line">f.close()</span><br><span class="line"></span><br><span class="line"><span class="comment"># with (用的比较多）</span></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;嫩模.md&quot;</span>, mode=<span class="string">&quot;r&quot;</span>, encoding=<span class="string">&quot;utf-8&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    <span class="keyword">for</span> line <span class="keyword">in</span> f:</span><br><span class="line">        <span class="built_in">print</span>(line.strip())</span><br><span class="line"></span><br><span class="line"><span class="comment"># 文件的复制：</span></span><br><span class="line"><span class="comment"># 从源文件中读取内容。写入到新路径去</span></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;beauty.jpg&quot;</span>, mode=<span class="string">&quot;rb&quot;</span>) <span class="keyword">as</span> f1,\</span><br><span class="line">     <span class="built_in">open</span>(<span class="string">&quot;beauty_bak.jpg&quot;</span>, mode=<span class="string">&quot;wb&quot;</span>) <span class="keyword">as</span> f2:</span><br><span class="line">    <span class="keyword">for</span> line <span class="keyword">in</span> f1:</span><br><span class="line">        f2.write(line)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 文件修改</span></span><br><span class="line"><span class="comment"># 把文件中的周一&gt;张</span></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;username.txt&quot;</span>, mode=<span class="string">&quot;r&quot;</span>, encoding=<span class="string">&quot;utf-8&quot;</span>) <span class="keyword">as</span> f1, \</span><br><span class="line">    <span class="built_in">open</span>(<span class="string">&quot;username_bak.txt&quot;</span>, mode=<span class="string">&quot;w&quot;</span>, encoding=<span class="string">&quot;utf-8&quot;</span>) <span class="keyword">as</span> f2:</span><br><span class="line">    <span class="keyword">for</span> line <span class="keyword">in</span> f1:</span><br><span class="line">        line = line.strip()</span><br><span class="line">        <span class="keyword">if</span> line.startswith(<span class="string">&quot;周&quot;</span>):</span><br><span class="line">            line = line.replace(<span class="string">&quot;周&quot;</span>, <span class="string">&quot;张&quot;</span>)</span><br><span class="line">            f2.write(line)</span><br><span class="line">            f2.write(<span class="string">&quot;\n&quot;</span>)</span><br><span class="line"><span class="comment"># 删除源文件</span></span><br><span class="line">os.remove(<span class="string">&quot;username.txt&quot;</span>)</span><br><span class="line"><span class="comment"># 把副本文件重命名成源文件</span></span><br><span class="line">os.renames(<span class="string">&quot;username_bak.txt&quot;</span>, <span class="string">&quot;username.txt&quot;</span>)</span><br></pre></td></tr></table></figure>
<h2 id="函数"><a class="markdownIt-Anchor" href="#函数"></a> 函数</h2>
<h3 id="基础部分"><a class="markdownIt-Anchor" href="#基础部分"></a> 基础部分</h3>
<ol>
<li>函数：对某一个特定的功能或者代码块进行封装，在需要使用该功能的时候直接调用即可</li>
<li>定义：<br />
def 函数的名字（）：<br />
被封装的功能或者代码块-&gt;函数体</li>
<li>调用：<br />
函数的名字（）</li>
<li>参数：可以在函数调用的时候，给函数传递一些信息分类：</li>
</ol>
<ul>
<li>形参，在函数定义的时候，需要准备一些变量来接收信息<br />
①位置参数，按照位置一个一个的去声明变量<br />
②默认值参数，在函数声明的时候给变量一个默认值，如果实参不传递信息。此时默认值生效，否则就不生效<br />
③动态传参<br />
a：*args，表示接收所有的位置参数的动态传参<br />
b：**kwargs，表示接收所有的关键字的动态传参<br />
顺序：位置&gt;*args&gt;默认值&gt;**kwargs</li>
<li>实参，实际在调用的时候传递的信息<br />
①位置参数：按照位置进行传递参数<br />
②关键字参数：按照参数的名字进行传递参数<br />
③混合参数<br />
顺序：位置参数放前面，关键字参数放后面一&gt;否则报错！官方不让这么干<br />
实参在执行的时候，必须要保障形参有数据</li>
</ul>
<ol start="5">
<li>返回值：函数执行之后，会给调用方一个结果，这个结果就是返回值<br />
关于<code>return</code>：<br />
函数只要执行到了<code>return</code>，函数就会立即停止并返回内容，函数内的return的后续的代码不会执行<br />
①如果函数内没有<code>return</code>，此时外界收到的是<code>None</code><br />
②如果写了<code>return</code>：<br />
a.只写了<code>return</code>，后面不跟数据，此时接收到的依然是<code>None</code><br />
b.<code>return</code>值，此时表示函数有一个返回值，外界能够收到一个数据<br />
c.<code>return</code>值1，值2，值3…  此时函数有多个返回值，外界收到的是元组，并且该元组内存放所有的返回值</li>
</ol>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 函数</span></span><br><span class="line"><span class="comment"># #请用函数编写一个计算器，能计算+－*／四则运算</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">simple_calc</span>(<span class="params">a, b, opt</span>):</span><br><span class="line">    <span class="keyword">if</span> opt == <span class="string">&#x27;+&#x27;</span>:</span><br><span class="line">        <span class="built_in">print</span>(a + b)</span><br><span class="line">    <span class="keyword">elif</span> opt == <span class="string">&#x27;-&#x27;</span>:</span><br><span class="line">        <span class="built_in">print</span>(a - b)</span><br><span class="line">    <span class="keyword">elif</span> opt == <span class="string">&#x27;*&#x27;</span>:</span><br><span class="line">        <span class="built_in">print</span>(a * b)</span><br><span class="line">    <span class="keyword">elif</span> opt == <span class="string">&#x27;/&#x27;</span>:</span><br><span class="line">        <span class="built_in">print</span>(a / b)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;OpError: opt is not a valid op.&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">simple_calc(<span class="number">2</span>, <span class="number">3</span>, <span class="string">&quot;+&quot;</span>)</span><br><span class="line">simple_calc(<span class="number">2</span>, <span class="number">3</span>, <span class="string">&quot;abc&quot;</span>)</span><br><span class="line">simple_calc(<span class="number">2</span>, <span class="number">3</span>, <span class="string">&quot;/&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">eat</span>(<span class="params">*food</span>):</span><br><span class="line">    <span class="built_in">print</span>(food)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># *表示位置参数的动态传参,*接收到的值会被统一放在一个元组里面</span></span><br><span class="line">eat(<span class="string">&quot;主食&quot;</span>, <span class="string">&quot;西红柿&quot;</span>, <span class="string">&quot;水果&quot;</span>, <span class="string">&quot;甜品&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">hobby</span>(<span class="params">**hobbies</span>):</span><br><span class="line">    <span class="built_in">print</span>(hobbies)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># **表示接收关键字的动态传参，接收到的所有参数都会被处理成字典</span></span><br><span class="line">hobby(animal=<span class="string">&quot;cat&quot;</span>, sport=<span class="string">&quot;basketball&quot;</span>)</span><br><span class="line"></span><br><span class="line">stu_lst = [<span class="string">&quot;张三&quot;</span>, <span class="string">&quot;李四&quot;</span>, <span class="string">&quot;王五&quot;</span>, <span class="string">&quot;赵六&quot;</span>, <span class="string">&quot;刘七&quot;</span>]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">func</span>(<span class="params">*args</span>):</span><br><span class="line">    <span class="built_in">print</span>(args)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># *在实参位置，是把列表打散成位置参数进行传递</span></span><br><span class="line"><span class="comment"># **在实参位置，可以把字典自动转化成关银字参数进行传递</span></span><br><span class="line">func(*stu_lst)</span><br></pre></td></tr></table></figure>
<ol start="6">
<li>内置函数</li>
</ol>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 函数</span></span><br><span class="line"><span class="comment"># #请用函数编写一个计算器，能计算+－*／四则运算</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">simple_calc</span>(<span class="params">a, b, opt</span>):</span><br><span class="line">    <span class="keyword">if</span> opt == <span class="string">&#x27;+&#x27;</span>:</span><br><span class="line">        <span class="built_in">print</span>(a + b)</span><br><span class="line">    <span class="keyword">elif</span> opt == <span class="string">&#x27;-&#x27;</span>:</span><br><span class="line">        <span class="built_in">print</span>(a - b)</span><br><span class="line">    <span class="keyword">elif</span> opt == <span class="string">&#x27;*&#x27;</span>:</span><br><span class="line">        <span class="built_in">print</span>(a * b)</span><br><span class="line">    <span class="keyword">elif</span> opt == <span class="string">&#x27;/&#x27;</span>:</span><br><span class="line">        <span class="built_in">print</span>(a / b)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;OpError: opt is not a valid op.&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">simple_calc(<span class="number">2</span>, <span class="number">3</span>, <span class="string">&quot;+&quot;</span>)</span><br><span class="line">simple_calc(<span class="number">2</span>, <span class="number">3</span>, <span class="string">&quot;abc&quot;</span>)</span><br><span class="line">simple_calc(<span class="number">2</span>, <span class="number">3</span>, <span class="string">&quot;/&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">eat</span>(<span class="params">*food</span>):</span><br><span class="line">    <span class="built_in">print</span>(food)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># *表示位置参数的动态传参,*接收到的值会被统一放在一个元组里面</span></span><br><span class="line">eat(<span class="string">&quot;主食&quot;</span>, <span class="string">&quot;西红柿&quot;</span>, <span class="string">&quot;水果&quot;</span>, <span class="string">&quot;甜品&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">hobby</span>(<span class="params">**hobbies</span>):</span><br><span class="line">    <span class="built_in">print</span>(hobbies)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># **表示接收关键字的动态传参，接收到的所有参数都会被处理成字典</span></span><br><span class="line">hobby(animal=<span class="string">&quot;cat&quot;</span>, sport=<span class="string">&quot;basketball&quot;</span>)</span><br><span class="line"></span><br><span class="line">stu_lst = [<span class="string">&quot;张三&quot;</span>, <span class="string">&quot;李四&quot;</span>, <span class="string">&quot;王五&quot;</span>, <span class="string">&quot;赵六&quot;</span>, <span class="string">&quot;刘七&quot;</span>]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">func</span>(<span class="params">*args</span>):</span><br><span class="line">    <span class="built_in">print</span>(args)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># *在实参位置，是把列表打散成位置参数进行传递</span></span><br><span class="line"><span class="comment"># **在实参位置，可以把字典自动转化成关银字参数进行传递</span></span><br><span class="line">func(*stu_lst)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 内置函数</span></span><br><span class="line"><span class="comment"># 类型转换</span></span><br><span class="line">i = <span class="number">3</span></span><br><span class="line">is_true = <span class="built_in">bool</span>(i)</span><br><span class="line">f = <span class="built_in">float</span>(i)</span><br><span class="line">s = <span class="built_in">str</span>(i)</span><br><span class="line">comp = <span class="built_in">complex</span>(i)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">type</span>(comp))</span><br><span class="line"><span class="built_in">print</span>(comp)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 进制转换 bin oct hex</span></span><br><span class="line">a = <span class="number">18</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">bin</span>(a))</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">oct</span>(a))</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">hex</span>(a))</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">int</span>(<span class="number">0b00100010001</span>))</span><br><span class="line"><span class="comment"># sum, min, max, pow</span></span><br><span class="line">a = <span class="number">3</span></span><br><span class="line">b = <span class="number">10</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">pow</span>(<span class="number">10</span>, <span class="number">3</span>))</span><br><span class="line"><span class="built_in">print</span>(b ** a)</span><br><span class="line">lst = [<span class="number">1</span>, <span class="number">4</span>, <span class="number">7</span>, <span class="number">10</span>, <span class="number">100</span>, <span class="number">99</span>, <span class="number">23</span>]</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">min</span>(lst))</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">max</span>(lst))</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">sum</span>(lst))</span><br><span class="line"></span><br><span class="line">sl = <span class="built_in">slice</span>(<span class="number">1</span>, <span class="number">5</span>, <span class="number">2</span>)      <span class="comment"># [1:5:2]</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;哈哈哈哈哈哈哈哈哈哈哈哈&quot;</span>[sl])</span><br><span class="line"></span><br><span class="line"><span class="comment"># format, ord, chr</span></span><br><span class="line"><span class="comment"># b：二进制，o：八进制，x：十六进制</span></span><br><span class="line">a = <span class="number">18</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">format</span>(a, <span class="string">&quot;08b&quot;</span>))</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">format</span>(a, <span class="string">&quot;o&quot;</span>))</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">format</span>(a, <span class="string">&quot;x&quot;</span>))</span><br><span class="line"><span class="comment"># python的内存中使用的是unicode</span></span><br><span class="line">a = <span class="string">&quot;中&quot;</span></span><br><span class="line"><span class="comment"># 中国的中字在unicode中码位是20013</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">ord</span>(a))</span><br><span class="line"><span class="comment"># 给出编码位置，展示出文字</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">chr</span>(<span class="number">20013</span>))</span><br><span class="line"><span class="comment"># for i in range(65536):</span></span><br><span class="line"><span class="comment">#     print(chr(i) + &quot; &quot;, end=&quot;&quot;)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># enumerate all any</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">all</span>([<span class="string">&quot;1&quot;</span>, <span class="number">0</span>, <span class="string">&quot;豆沙包&quot;</span>]))</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">any</span>([<span class="number">0</span>, <span class="string">&quot;1&quot;</span>, <span class="string">&quot;呵呵哒&quot;</span>]))</span><br><span class="line">lst = [<span class="string">&quot;张翠山&quot;</span>, <span class="string">&quot;张无忌&quot;</span>, <span class="string">&quot;张三丰&quot;</span>, <span class="string">&quot;张大大&quot;</span>]</span><br><span class="line"><span class="keyword">for</span> item <span class="keyword">in</span> <span class="built_in">enumerate</span>(lst):</span><br><span class="line">    <span class="built_in">print</span>(item)</span><br><span class="line"><span class="keyword">for</span> index, item <span class="keyword">in</span> <span class="built_in">enumerate</span>(lst):</span><br><span class="line">    <span class="built_in">print</span>(index, item)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 定是一个数字一&gt;想办法转化成内存地址，然后进行数据的存储-&gt;哈希表</span></span><br><span class="line">s = <span class="string">&quot;呵呵哒&quot;</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">hash</span>(s))</span><br><span class="line"><span class="comment"># 当前这个数据能执行哪些操作</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">dir</span>(s))</span><br></pre></td></tr></table></figure>
<h3 id="函数的嵌套"><a class="markdownIt-Anchor" href="#函数的嵌套"></a> 函数的嵌套</h3>
<ul>
<li><code>gobal</code>：在局部，引入全局变量</li>
<li><code>nonlocal</code>：在局部，引入外层的局部变量，向外找一层，看看有没有该变量，如果有就引入，如果没有，继续向外一层，直到全局（不包括）</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">outer</span>():</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">inner</span>():</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;这是一个内部函数的打印&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(inner)</span><br><span class="line">    <span class="keyword">return</span> inner</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">caller = outer()</span><br><span class="line"><span class="built_in">print</span>(caller)</span><br><span class="line">caller()</span><br><span class="line"></span><br><span class="line"><span class="comment"># 代理模式</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">myexec</span>(<span class="params">call</span>):</span><br><span class="line">    call()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">target_fun</span>():</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;target is running...&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 实参可以是函数</span></span><br><span class="line">myexec(target_fun)</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h3 id="闭包"><a class="markdownIt-Anchor" href="#闭包"></a> 闭包</h3>
<ol>
<li>闭包：本质，内层函数对外层函数的局部变量的使用，此时内层函数被称为闭包函数</li>
</ol>
<ul>
<li>可以让一个变量常驻与内存</li>
<li>可以避免全局变量被修改</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">outer</span>():</span><br><span class="line">    a = <span class="number">10</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">inner</span>():</span><br><span class="line">        <span class="keyword">nonlocal</span> a</span><br><span class="line">        a += <span class="number">1</span></span><br><span class="line">        <span class="keyword">return</span> a</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> inner</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">call = outer()</span><br><span class="line">ret = call()</span><br><span class="line"><span class="built_in">print</span>(ret)</span><br><span class="line">ret = call()</span><br><span class="line"><span class="built_in">print</span>(ret)</span><br></pre></td></tr></table></figure>
<h3 id="装饰器"><a class="markdownIt-Anchor" href="#装饰器"></a> 装饰器</h3>
<ol>
<li>回顾相关认识</li>
</ol>
<ul>
<li>函数可以做为参数进行传递</li>
<li>函数可以作为返回值进行返回</li>
<li>函数名称可以当成变量一样进行赋值操作</li>
</ul>
<ol start="2">
<li>装饰器：</li>
</ol>
<ul>
<li>装饰器本质上是一个闭包</li>
<li>作用：<br />
在不改变原有函数调用的情况下，给函数增加新的功能<br />
直白：可以在函数前后添加新功能，但是不改原来的代码</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 装饰器(decorator)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">play_dnf</span>():</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;我正在玩dnf这款游戏...&quot;</span>)</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">play_lol</span>():</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;我正在玩lol这款游戏...&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;方式1：没法玩外挂&quot;</span>)</span><br><span class="line">play_dnf()</span><br><span class="line">play_lol()</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">game_decorator</span>(<span class="params">play_game</span>):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">inner</span>():</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;开启外挂&quot;</span>)</span><br><span class="line">        play_game()</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;关闭外挂&quot;</span>)</span><br><span class="line">    <span class="keyword">return</span> inner</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;新模式开启==============&quot;</span>)</span><br><span class="line">play_lol = game_decorator(play_lol)</span><br><span class="line">play_lol()</span><br><span class="line">play_dnf = game_decorator(play_dnf)</span><br><span class="line">play_dnf()</span><br><span class="line"></span><br><span class="line"><span class="comment"># 开启新游戏</span></span><br><span class="line"><span class="meta">@game_decorator</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">play_wukong</span>():</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;我正在玩黑猴，黑风山杀的正起....&quot;</span>)</span><br><span class="line"></span><br><span class="line">play_wukong()</span><br><span class="line"><span class="comment"># 关于参数问题和返回值</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">game_wrapper</span>(<span class="params">game</span>):</span><br><span class="line">    <span class="comment"># *，**表示接收所有参数，打包成元组和字典</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">inner</span>(<span class="params">*args, **kwargs</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;开启游戏外挂...&quot;</span>)</span><br><span class="line">        <span class="comment"># *, **表示把args元组和kwargs字典打散成位置参数以及关键字参数传递进去</span></span><br><span class="line">        ret = game(*args, **kwargs)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;关闭游戏外挂...&quot;</span>)</span><br><span class="line">        <span class="keyword">return</span> ret</span><br><span class="line">    <span class="keyword">return</span> inner</span><br><span class="line"></span><br><span class="line"><span class="meta">@game_wrapper</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">play_dnf</span>(<span class="params">username, password</span>):</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;用户名：<span class="subst">&#123;username&#125;</span>,密码：<span class="subst">&#123;password&#125;</span>，登录中...&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;我要开始玩dnf....&quot;</span>)</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;一把绝世好剑&quot;</span></span><br><span class="line"><span class="meta">@game_wrapper</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">play_lol</span>(<span class="params">username, password, role</span>):</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;用户名:<span class="subst">&#123;username&#125;</span>, 密码:<span class="subst">&#123;password&#125;</span>, 英雄角色:<span class="subst">&#123;role&#125;</span>, 登录中...&quot;</span>)</span><br><span class="line">play_lol(<span class="string">&quot;张三&quot;</span>, <span class="string">&quot;1234&quot;</span>, <span class="string">&quot;daju&quot;</span>)</span><br><span class="line">ret = play_dnf(<span class="string">&quot;李四&quot;</span>, <span class="string">&quot;1234&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(ret)</span><br><span class="line"></span><br><span class="line"><span class="comment"># wrapper应用的小例子</span></span><br><span class="line">login_flag = <span class="literal">False</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">login</span>():</span><br><span class="line">    <span class="keyword">global</span> login_flag</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;请你先登录&quot;</span>)</span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        username = <span class="built_in">input</span>(<span class="string">&quot;用户名&gt;&gt;&gt;&quot;</span>)</span><br><span class="line">        password = <span class="built_in">input</span>(<span class="string">&quot;密㊙码&gt;&gt;&gt;&quot;</span>)</span><br><span class="line">        <span class="keyword">if</span> username == <span class="string">&quot;admin&quot;</span> <span class="keyword">and</span> password == <span class="string">&quot;123&quot;</span>:</span><br><span class="line">            login_flag = <span class="literal">True</span></span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;登录成功！&quot;</span>)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;登录失败！&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">login_verify</span>(<span class="params">fn</span>):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">inner</span>(<span class="params">*args, **kwargs</span>):</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> login_flag:</span><br><span class="line">            login()</span><br><span class="line">        ret = fn(*args, **kwargs)</span><br><span class="line">        <span class="keyword">return</span> ret</span><br><span class="line">    <span class="keyword">return</span> inner</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@login_verify</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">add</span>():</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;添加信息&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="meta">@login_verify</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">update</span>():</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;更新信息&quot;</span>)</span><br><span class="line"><span class="meta">@login_verify</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">delete</span>():</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;删除信息&quot;</span>)</span><br><span class="line"><span class="meta">@login_verify</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">search</span>():</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;查询信息&quot;</span>)</span><br><span class="line"></span><br><span class="line">add()</span><br><span class="line">update()</span><br><span class="line">delete()</span><br><span class="line">search()</span><br></pre></td></tr></table></figure>
<h3 id="迭代器"><a class="markdownIt-Anchor" href="#迭代器"></a> 迭代器</h3>
<ol>
<li>可送代的数据类型都会提供一个叫送代器的东西，这个送代器可以帮我们把数据类型中的所有数据逐一的拿到
<ul>
<li>只能向前不能反复</li>
<li>特别节省内存</li>
<li>惰性机制</li>
</ul>
</li>
<li>获取送代器的两种方案：
<ul>
<li><code>iter</code>（）内置函数可以直接拿到选代器</li>
<li><code>__iter__</code>() 特殊方法</li>
</ul>
</li>
<li>从送代器中拿到数据：
<ul>
<li><code>next</code>（）内置函数</li>
<li><code>__next__</code>（）特殊方法</li>
</ul>
</li>
<li><code>for</code>里面一定是要拿送代器的，所以所有不可迭代的东西不能用<code>for</code>循环</li>
</ol>
<p><strong>总结：送代器统一了不同数据类型的遍历工作</strong></p>
<h3 id="生成器"><a class="markdownIt-Anchor" href="#生成器"></a> 生成器</h3>
<ol>
<li>生成器的本质就是迭代器</li>
<li>创建生成器的两种方案：</li>
</ol>
<ul>
<li>生成器函数</li>
<li>生成器表达式</li>
<li>推导式</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 列表推导式：[数据for循环if判断】</span></span><br><span class="line">lst = [i <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10</span>)]</span><br><span class="line"><span class="built_in">print</span>(lst)</span><br><span class="line"><span class="comment"># 请创建一个列表[1，3，5，7，9]</span></span><br><span class="line">lst = [i <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10</span>) <span class="keyword">if</span> i % <span class="number">2</span> == <span class="number">1</span>]</span><br><span class="line"><span class="built_in">print</span>(lst)</span><br><span class="line"><span class="comment"># 2.生成50件衣服</span></span><br><span class="line">lst = [<span class="string">f&quot;cloth<span class="subst">&#123;i&#125;</span>&quot;</span> <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">50</span>)]</span><br><span class="line"><span class="built_in">print</span>(lst)</span><br><span class="line"><span class="comment"># 将如下列表中所有的英文字母修改成大写</span></span><br><span class="line">lst1 = [<span class="string">&#x27;allen&#x27;</span>, <span class="string">&#x27;joy&#x27;</span>, <span class="string">&#x27;marin&#x27;</span>, <span class="string">&#x27;joe&#x27;</span>, <span class="string">&#x27;kevin&#x27;</span>]</span><br><span class="line">lst2 = [item.upper() <span class="keyword">for</span> item <span class="keyword">in</span> lst1]</span><br><span class="line"><span class="built_in">print</span>(lst2)</span><br><span class="line"><span class="comment"># 集合推导式：【数据for循环if判断&#125;</span></span><br><span class="line">st = &#123;i <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10</span>)&#125;</span><br><span class="line"><span class="built_in">print</span>(st)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 字典推导式：&#123;k:v for循环 if判断&#125;</span></span><br><span class="line"><span class="comment"># 请将下列的列表修改成字典，要求索引做为key，数据作为value</span></span><br><span class="line">lst = [<span class="string">&#x27;赵本山&#x27;</span>,<span class="string">&#x27;潘长江&#x27;</span>,<span class="string">&#x27;高达&#x27;</span>,<span class="string">&#x27;赵敏&#x27;</span>]</span><br><span class="line">dic = &#123;i:lst[i] <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(lst))&#125;</span><br><span class="line"><span class="built_in">print</span>(dic)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 生成器表达式</span></span><br><span class="line"><span class="comment"># 语法：（数据for循环if）</span></span><br><span class="line">gen = (i**<span class="number">2</span> <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10</span>))</span><br><span class="line">lst = <span class="built_in">list</span>(gen)</span><br><span class="line"><span class="built_in">print</span>(lst)</span><br><span class="line"><span class="comment"># generator has used,so it is empty.</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> gen:</span><br><span class="line">    <span class="built_in">print</span>(i)</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<ol start="3">
<li><code>yield</code>：<br />
只要函数中出现了<code>yield</code>,它就是一个生成器函数<br />
作用：<br />
①可以返回数据<br />
②可以分段的执行函数中的内容，通过<code>__next__</code>（）可以执行到下一个<code>yield</code>位置</li>
</ol>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 去工厂定制10000件衣服</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">order</span>():</span><br><span class="line">    lst = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1000</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;衣服<span class="subst">&#123;i&#125;</span>&quot;</span>)</span><br><span class="line">        lst.append(<span class="string">f&quot;衣服<span class="subst">&#123;i&#125;</span>&quot;</span>)</span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">len</span>(lst) == <span class="number">50</span>):</span><br><span class="line">            <span class="keyword">yield</span> lst</span><br><span class="line">            lst = []</span><br><span class="line"></span><br><span class="line">gen = order()</span><br><span class="line"><span class="built_in">print</span>(gen.__next__())</span><br><span class="line"><span class="built_in">print</span>(gen.__next__())</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h3 id="lambda匿名函数"><a class="markdownIt-Anchor" href="#lambda匿名函数"></a> <code>lambda</code>匿名函数</h3>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># lambda</span></span><br><span class="line">fn = <span class="keyword">lambda</span> a, b: a + b</span><br><span class="line">ret = fn(<span class="number">3</span>, <span class="number">5</span>)</span><br><span class="line"><span class="built_in">print</span>(ret)</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h3 id="python内置函数_下"><a class="markdownIt-Anchor" href="#python内置函数_下"></a> <code>python</code>内置函数_下</h3>
<ul>
<li>sorted: 排序</li>
<li>filter: 过滤</li>
<li>map: 映射</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># built-in functions</span></span><br><span class="line"><span class="comment"># zip</span></span><br><span class="line">lst1 = [<span class="string">&#x27;赵本山&#x27;</span>, <span class="string">&#x27;范伟&#x27;</span>, <span class="string">&#x27;苏有朋&#x27;</span>]</span><br><span class="line">lst2 = [<span class="number">30</span>, <span class="number">23</span>, <span class="number">18</span>]</span><br><span class="line">lst3 = [<span class="string">&#x27;卖拐&#x27;</span>, <span class="string">&#x27;耳朵大有福&#x27;</span>, <span class="string">&#x27;情深深雨蒙蒙&#x27;</span>]</span><br><span class="line">result = <span class="built_in">zip</span>(lst1, lst2, lst3)</span><br><span class="line">lst = <span class="built_in">list</span>(result)</span><br><span class="line"><span class="built_in">print</span>(lst)</span><br><span class="line"></span><br><span class="line"><span class="comment"># locals</span></span><br><span class="line">a = <span class="number">388</span></span><br><span class="line"><span class="comment"># 此时locals被写在了全局作用域范围内，此时看到的就是全局作用域中的内容</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">locals</span>())</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">fun_local</span>():</span><br><span class="line">    b = <span class="number">53</span></span><br><span class="line">    <span class="comment"># 此时locals放在局部作用域范内</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">locals</span>())</span><br><span class="line"></span><br><span class="line">fun_local()</span><br><span class="line"><span class="comment"># globals无论写在哪看到的是全局作用域中的内容</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">globals</span>())</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">fun_global</span>():</span><br><span class="line">    c = <span class="number">15</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">globals</span>())</span><br><span class="line">fun_global()</span><br><span class="line"></span><br><span class="line"><span class="comment"># sorted</span></span><br><span class="line">lst = [<span class="number">16</span>, <span class="number">22</span>, <span class="number">68</span>, <span class="number">1</span>, <span class="number">147</span>, <span class="number">256</span>, <span class="number">49</span>]</span><br><span class="line">s = <span class="built_in">sorted</span>(lst, reverse=<span class="literal">True</span>)</span><br><span class="line"><span class="built_in">print</span>(s)</span><br><span class="line"><span class="built_in">print</span>(lst)</span><br><span class="line"></span><br><span class="line">lst = [<span class="string">&#x27;春&#x27;</span>, <span class="string">&#x27;秋&#x27;</span>, <span class="string">&#x27;张二嘎&#x27;</span>, <span class="string">&#x27;比克&#x27;</span>, <span class="string">&#x27;卡卡洛特&#x27;</span>, <span class="string">&#x27;超级宇宙无敌大帅B&#x27;</span>]</span><br><span class="line">s = <span class="built_in">sorted</span>(lst, key=<span class="keyword">lambda</span> x: <span class="built_in">len</span>(x))</span><br><span class="line"><span class="built_in">print</span>(s)</span><br><span class="line"></span><br><span class="line">lst = [</span><br><span class="line">    &#123;<span class="string">&#x27;id&#x27;</span>: <span class="number">1</span>, <span class="string">&#x27;name&#x27;</span>: <span class="string">&#x27;周润发&#x27;</span>, <span class="string">&#x27;age&#x27;</span>: <span class="number">18</span>, <span class="string">&#x27;salary&#x27;</span>: <span class="number">5200</span>&#125;,</span><br><span class="line">    &#123;<span class="string">&#x27;id&#x27;</span>: <span class="number">2</span>, <span class="string">&#x27;name&#x27;</span>: <span class="string">&#x27;周星驰&#x27;</span>, <span class="string">&#x27;age&#x27;</span>: <span class="number">28</span>, <span class="string">&#x27;salary&#x27;</span>: <span class="number">511100</span>&#125;,</span><br><span class="line">    &#123;<span class="string">&#x27;id&#x27;</span>: <span class="number">3</span>, <span class="string">&#x27;name&#x27;</span>: <span class="string">&#x27;周海媚&#x27;</span>, <span class="string">&#x27;age&#x27;</span>: <span class="number">48</span>, <span class="string">&#x27;salary&#x27;</span>: <span class="number">451230</span>&#125;,</span><br><span class="line">    &#123;<span class="string">&#x27;id&#x27;</span>: <span class="number">4</span>, <span class="string">&#x27;name&#x27;</span>: <span class="string">&#x27;周伯通&#x27;</span>, <span class="string">&#x27;age&#x27;</span>: <span class="number">12</span>, <span class="string">&#x27;salary&#x27;</span>: <span class="number">54311</span>&#125;,</span><br><span class="line">    &#123;<span class="string">&#x27;id&#x27;</span>: <span class="number">5</span>, <span class="string">&#x27;name&#x27;</span>: <span class="string">&#x27;周大兴&#x27;</span>, <span class="string">&#x27;age&#x27;</span>: <span class="number">58</span>, <span class="string">&#x27;salary&#x27;</span>: <span class="number">54211</span>&#125;,</span><br><span class="line">    &#123;<span class="string">&#x27;id&#x27;</span>: <span class="number">6</span>, <span class="string">&#x27;name&#x27;</span>: <span class="string">&#x27;周有辣&#x27;</span>, <span class="string">&#x27;age&#x27;</span>: <span class="number">35</span>, <span class="string">&#x27;salary&#x27;</span>: <span class="number">53210</span>&#125;,</span><br><span class="line">    &#123;<span class="string">&#x27;id&#x27;</span>: <span class="number">7</span>, <span class="string">&#x27;name&#x27;</span>: <span class="string">&#x27;周扒皮&#x27;</span>, <span class="string">&#x27;age&#x27;</span>: <span class="number">47</span>, <span class="string">&#x27;salary&#x27;</span>: <span class="number">520</span>&#125;,</span><br><span class="line">]</span><br><span class="line"><span class="comment"># 1. 根据每个人的年龄排序</span></span><br><span class="line">s = <span class="built_in">sorted</span>(lst, key=<span class="keyword">lambda</span> dic: dic[<span class="string">&#x27;age&#x27;</span>])</span><br><span class="line"><span class="built_in">print</span>(s)</span><br><span class="line"><span class="comment"># 2. 根据工资进行排序：从大到小</span></span><br><span class="line">s = <span class="built_in">sorted</span>(lst, key=<span class="keyword">lambda</span> dic: dic[<span class="string">&#x27;salary&#x27;</span>], reverse=<span class="literal">True</span>)</span><br><span class="line"><span class="built_in">print</span>(s)</span><br><span class="line"></span><br><span class="line"><span class="comment"># filter</span></span><br><span class="line">lst = [<span class="string">&#x27;小狐仙&#x27;</span>, <span class="string">&#x27;灭绝小师太&#x27;</span>, <span class="string">&#x27;张翠山&#x27;</span>, <span class="string">&#x27;张无忌&#x27;</span>, <span class="string">&#x27;张三丰&#x27;</span>]</span><br><span class="line">f = <span class="built_in">filter</span>(<span class="keyword">lambda</span> item: item.startswith(<span class="string">&#x27;张&#x27;</span>), lst)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">list</span>( f ))</span><br><span class="line"></span><br><span class="line"><span class="comment"># map</span></span><br><span class="line">lst = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>]</span><br><span class="line">m = <span class="built_in">map</span>(<span class="keyword">lambda</span> x: x * x, lst)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">list</span>( m ))</span><br></pre></td></tr></table></figure>
<h2 id="面向对象编程"><a class="markdownIt-Anchor" href="#面向对象编程"></a> <a target="_blank" rel="noopener" href="https://github.com/jackfrued/Python-100-Days/blob/master/Day01-20/18.%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1%E7%BC%96%E7%A8%8B%E5%85%A5%E9%97%A8.md">面向对象编程</a></h2>
<h2 id="python-进阶"><a class="markdownIt-Anchor" href="#python-进阶"></a> <a target="_blank" rel="noopener" href="https://github.com/jackfrued/Python-100-Days/blob/master/Day31-35/31.Python%E8%AF%AD%E8%A8%80%E8%BF%9B%E9%98%B6.md">Python 进阶</a></h2>
<h2 id="python中的并发编程"><a class="markdownIt-Anchor" href="#python中的并发编程"></a> <a target="_blank" rel="noopener" href="https://github.com/jackfrued/Python-100-Days/blob/master/Day61-65/63.Python%E4%B8%AD%E7%9A%84%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B-1.md">Python中的并发编程</a></h2>
<p>引入：现如今，我们使用的计算机早已是多 CPU 或多核的计算机，而我们使用的操作系统基本都支持“多任务”，这使得我们可以同时运行多个程序，也可以将一个程序分解为若干个相对独立的子任务，让多个子任务“并行”或“并发”的执行，从而缩短程序的执行时间，同时也让用户获得更好的体验。因此当下，不管用什么编程语言进行开发，实现“并行”或“并发”编程已经成为了程序员的标配技能。为了讲述如何在 Python 程序中实现“并行”或“并发”，我们需要先了解两个重要的概念：进程和线程。</p>
<h3 id="进程和线程"><a class="markdownIt-Anchor" href="#进程和线程"></a> 进程和线程</h3>
<ol>
<li>进程<br />
简单的说，进程是操作系统分配存储空间的基本单位，每个进程都有自己的地址空间、数据栈以及其他用于跟踪进程执行的辅助数据；操作系统管理所有进程的执行，为它们合理的分配资源。一个进程可以通过 fork 或 spawn 的方式创建新的进程来执行其他的任务，不过新的进程也有自己独立的内存空间，因此两个进程如果要共享数据，必须通过进程间通信机制来实现，具体的方式包括管道、信号、套接字等。</li>
<li>线程<br />
一个进程还可以拥有多个执行线索，简单的说就是拥有多个可以获得 CPU 调度的执行单元，这就是所谓的线程。由于线程在同一个进程下，它们可以共享相同的上下文，因此相对于进程而言，线程间的信息共享和通信更加容易。当然在单核 CPU 系统中，多个线程不可能同时执行，因为在某个时刻只有一个线程能够获得 CPU，多个线程通过共享 CPU 执行时间的方式来达到并发的效果。</li>
<li>两个核心概念</li>
</ol>
<ul>
<li><strong>并发</strong><br />
并发通常是指同一时刻只能有一条指令执行，但是多个线程对应的指令被快速轮换地执行。比如一个处理器，它先执行线程 A 的指令一段时间，再执行线程 B 的指令一段时间，再切回到线程 A 执行一段时间。由于处理器执行指令的速度和切换的速度极快，人们完全感知不到计算机在这个过程中有多个线程切换上下文执行的操作，这就使得宏观上看起来多个线程在同时运行，但微观上其实只有一个线程在执行。</li>
<li><strong>并行</strong><br />
并行是指同一时刻，有多条指令在多个处理器上同时执行，并行必须要依赖于多个处理器，不论是从宏观上还是微观上，多个线程可以在同一时刻一起执行的。很多时候，我们并不用严格区分并发和并行两个词，所以我们有时候也把 Python 中的多线程、多进程以及异步 I/O 都视为实现并发编程的手段，但实际上前面两者也可以实现并行编程，当然这里还有一个全局解释器锁（GIL）的问题，我们稍后讨论。</li>
</ul>
<h3 id="多线程编程"><a class="markdownIt-Anchor" href="#多线程编程"></a> 多线程编程</h3>
<p>Python 标准库中threading模块的Thread类可以帮助我们非常轻松的实现多线程编程。我们用一个联网下载文件的例子来对比使用多线程和不使用多线程到底有什么区别，代码如下所示</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">import</span> threading</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">download</span>(<span class="params">*, filename</span>):</span><br><span class="line">    start = time.time()</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&#x27;开始下载 <span class="subst">&#123;filename&#125;</span>....&#x27;</span>)</span><br><span class="line">    time.sleep(random.randint(<span class="number">1</span>, <span class="number">3</span>))</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&#x27;<span class="subst">&#123;filename&#125;</span> 下载完成.&#x27;</span>)</span><br><span class="line">    end = time.time()</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&#x27;下载耗时：<span class="subst">&#123;end - start:<span class="number">.3</span>f&#125;</span> 秒.&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">calc_download_using_single_thread</span>():</span><br><span class="line">    start = time.time()</span><br><span class="line">    download(filename=<span class="string">&#x27;Python从入门到住院.pdf&#x27;</span>)</span><br><span class="line">    download(filename=<span class="string">&#x27;MySQL从删库到跑路.avi&#x27;</span>)</span><br><span class="line">    download(filename=<span class="string">&#x27;Linux从精通到放弃.mp4&#x27;</span>)</span><br><span class="line">    end = time.time()</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&#x27;总耗时：<span class="subst">&#123;end - start:<span class="number">.3</span>f&#125;</span> 秒.&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">calc_download_using_multi_threads</span>():</span><br><span class="line">    threads = [</span><br><span class="line">        threading.Thread(target=download, kwargs=&#123;<span class="string">&#x27;filename&#x27;</span>: <span class="string">&#x27;Python从入门到住院.pdf&#x27;</span>&#125;),</span><br><span class="line">        threading.Thread(target=download, kwargs=&#123;<span class="string">&#x27;filename&#x27;</span>: <span class="string">&#x27;MySQL从删库到跑路.avi&#x27;</span>&#125;),</span><br><span class="line">        threading.Thread(target=download, kwargs=&#123;<span class="string">&#x27;filename&#x27;</span>: <span class="string">&#x27;Linux从精通到放弃.mp4&#x27;</span>&#125;)</span><br><span class="line">    ]</span><br><span class="line">    start = time.time()</span><br><span class="line">    <span class="comment"># 启动三个线程</span></span><br><span class="line">    <span class="keyword">for</span> thread <span class="keyword">in</span> threads:</span><br><span class="line">        thread.start()</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 等待线程结束</span></span><br><span class="line">    <span class="keyword">for</span> thread <span class="keyword">in</span> threads:</span><br><span class="line">        thread.join()</span><br><span class="line">    end = time.time()</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&#x27;总耗时：<span class="subst">&#123;end - start:<span class="number">.3</span>f&#125;</span> 秒.&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    calc_download_using_single_thread()</span><br><span class="line">    calc_download_using_multi_threads()</span><br></pre></td></tr></table></figure>
<h3 id="使用-thread-类创建线程对象"><a class="markdownIt-Anchor" href="#使用-thread-类创建线程对象"></a> 使用 Thread 类创建线程对象</h3>
<ol>
<li>相关参数的使用<br />
线程启动后会执行target参数指定的函数，当然前提是获得 CPU 的调度；如果target指定的线程要执行的目标函数有参数，需要通过args参数为其进行指定，对于关键字参数，可以通过kwargs参数进行传入。Thread类的构造器还有很多其他的参数，我们遇到的时候再为大家进行讲解，目前需要大家掌握的，就是target、args和kwargs。</li>
</ol>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> threading</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">simple_task</span>():</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;这是一个简单的线程任务&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 创建线程对象，只指定target</span></span><br><span class="line">thread = threading.Thread(target=simple_task)</span><br><span class="line">thread.start()</span><br><span class="line">thread.join()  <span class="comment"># 等待线程结束</span></span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> threading</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">task_with_args</span>(<span class="params">name, age</span>):</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;线程收到参数: 姓名=<span class="subst">&#123;name&#125;</span>, 年龄=<span class="subst">&#123;age&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 创建线程对象，使用args传递位置参数</span></span><br><span class="line">thread = threading.Thread(</span><br><span class="line">    target=task_with_args,</span><br><span class="line">    args=(<span class="string">&quot;张三&quot;</span>, <span class="number">25</span>)  <span class="comment"># 注意这是一个元组，单个参数后面要加逗号</span></span><br><span class="line">)</span><br><span class="line">thread.start()</span><br><span class="line">thread.join()</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> threading</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">task_with_kwargs</span>(<span class="params">name, age, city</span>):</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;线程收到参数: 姓名=<span class="subst">&#123;name&#125;</span>, 年龄=<span class="subst">&#123;age&#125;</span>, 城市=<span class="subst">&#123;city&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 创建线程对象，使用kwargs传递关键字参数</span></span><br><span class="line">thread = threading.Thread(</span><br><span class="line">    target=task_with_kwargs,</span><br><span class="line">    kwargs=&#123;<span class="string">&#x27;name&#x27;</span>: <span class="string">&#x27;李四&#x27;</span>, <span class="string">&#x27;age&#x27;</span>: <span class="number">30</span>, <span class="string">&#x27;city&#x27;</span>: <span class="string">&#x27;北京&#x27;</span>&#125;</span><br><span class="line">)</span><br><span class="line">thread.start()</span><br><span class="line">thread.join()</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> threading</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">mixed_args_task</span>(<span class="params">name, age, city, country</span>):</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;线程收到参数: 姓名=<span class="subst">&#123;name&#125;</span>, 年龄=<span class="subst">&#123;age&#125;</span>, 城市=<span class="subst">&#123;city&#125;</span>, 国家=<span class="subst">&#123;country&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 创建线程对象，同时使用args和kwargs</span></span><br><span class="line">thread = threading.Thread(</span><br><span class="line">    target=mixed_args_task,</span><br><span class="line">    args=(<span class="string">&#x27;王五&#x27;</span>, <span class="number">40</span>),  <span class="comment"># 位置参数</span></span><br><span class="line">    kwargs=&#123;<span class="string">&#x27;city&#x27;</span>: <span class="string">&#x27;上海&#x27;</span>, <span class="string">&#x27;country&#x27;</span>: <span class="string">&#x27;中国&#x27;</span>&#125;  <span class="comment"># 关键字参数</span></span><br><span class="line">)</span><br><span class="line">thread.start()</span><br><span class="line">thread.join()</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> threading</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">task_with_return</span>(<span class="params">a, b</span>):</span><br><span class="line">    <span class="keyword">return</span> a + b</span><br><span class="line"></span><br><span class="line"><span class="comment"># 由于线程函数不能直接返回值，我们可以通过可变对象来获取结果</span></span><br><span class="line">result_container = []</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">wrapper_func</span>(<span class="params">a, b, container</span>):</span><br><span class="line">    container.append(a + b)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 创建线程</span></span><br><span class="line">thread = threading.Thread(</span><br><span class="line">    target=wrapper_func,</span><br><span class="line">    args=(<span class="number">10</span>, <span class="number">20</span>, result_container)</span><br><span class="line">)</span><br><span class="line">thread.start()</span><br><span class="line">thread.join()</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;线程计算结果: <span class="subst">&#123;result_container[<span class="number">0</span>]&#125;</span>&quot;</span>)</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> threading</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">task_with_return</span>(<span class="params">a, b</span>):</span><br><span class="line">    <span class="keyword">return</span> a + b</span><br><span class="line"></span><br><span class="line"><span class="comment"># 由于线程函数不能直接返回值，我们可以通过可变对象来获取结果</span></span><br><span class="line">result_container = []</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">wrapper_func</span>(<span class="params">a, b, container</span>):</span><br><span class="line">    container.append(a + b)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 创建线程</span></span><br><span class="line">thread = threading.Thread(</span><br><span class="line">    target=wrapper_func,</span><br><span class="line">    args=(<span class="number">10</span>, <span class="number">20</span>, result_container)</span><br><span class="line">)</span><br><span class="line">thread.start()</span><br><span class="line">thread.join()</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;线程计算结果: <span class="subst">&#123;result_container[<span class="number">0</span>]&#125;</span>&quot;</span>)</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> threading</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">named_task</span>():</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;线程 &#x27;<span class="subst">&#123;threading.current_thread().name&#125;</span>&#x27; 正在运行&quot;</span>)</span><br><span class="line">    time.sleep(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 创建线程并指定名称</span></span><br><span class="line">thread = threading.Thread(</span><br><span class="line">    target=named_task,</span><br><span class="line">    name=<span class="string">&quot;我的自定义线程&quot;</span></span><br><span class="line">)</span><br><span class="line">thread.start()</span><br><span class="line">thread.join()</span><br></pre></td></tr></table></figure>
<h3 id="继承-thread-类自定义线程"><a class="markdownIt-Anchor" href="#继承-thread-类自定义线程"></a> 继承 Thread 类自定义线程</h3>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">继承 Thread 类自定义线程</span></span><br><span class="line"><span class="string">除了上面的代码展示的创建线程的方式外，还可以通过继承Thread类并重写run()方法的方式来自定义线程，具体的代码如下所示。</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">DownloadThread</span>(threading.Thread):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;下载类线程&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, filename</span>):</span><br><span class="line">        <span class="variable language_">self</span>.filename = filename</span><br><span class="line">        <span class="built_in">super</span>().__init__()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">run</span>(<span class="params">self</span>) -&gt; <span class="literal">None</span>:</span><br><span class="line">        start = time.time()</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&#x27;开始下载 <span class="subst">&#123;self.filename&#125;</span>....&#x27;</span>)</span><br><span class="line">        time.sleep(random.randint(<span class="number">1</span>, <span class="number">3</span>))</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&#x27;<span class="subst">&#123;self.filename&#125;</span> 下载完成.&#x27;</span>)</span><br><span class="line">        end = time.time()</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&#x27;下载耗时：<span class="subst">&#123;end - start:<span class="number">.3</span>f&#125;</span> 秒.&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">test_download_thread</span>():</span><br><span class="line">    threads = [</span><br><span class="line">        DownloadThread(<span class="string">&#x27;Python从入门到住院.pdf&#x27;</span>),</span><br><span class="line">        DownloadThread(<span class="string">&#x27;MySQL从删库到跑路.avi&#x27;</span>),</span><br><span class="line">        DownloadThread(<span class="string">&#x27;Linux从精通到放弃.mp4&#x27;</span>),</span><br><span class="line">    ]</span><br><span class="line">    start = time.time()</span><br><span class="line">    <span class="comment"># 启动三个线程</span></span><br><span class="line">    <span class="keyword">for</span> thread <span class="keyword">in</span> threads:</span><br><span class="line">        thread.start()</span><br><span class="line">    <span class="comment"># 等待线程结束</span></span><br><span class="line">    <span class="keyword">for</span> thread <span class="keyword">in</span> threads:</span><br><span class="line">        thread.join()</span><br><span class="line">    end = time.time()</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&#x27;总耗时: <span class="subst">&#123;end - start:<span class="number">.3</span>f&#125;</span>秒.&#x27;</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h3 id="使用线程池"><a class="markdownIt-Anchor" href="#使用线程池"></a> 使用线程池</h3>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> concurrent.futures <span class="keyword">import</span> ThreadPoolExecutor</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">test_thread_pool</span>():</span><br><span class="line">    <span class="keyword">with</span> ThreadPoolExecutor(max_workers=<span class="number">8</span>) <span class="keyword">as</span> pool:</span><br><span class="line">        filenames = [</span><br><span class="line">            <span class="string">&#x27;Python从入门到住院.pdf&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;MySQL从删库到跑路.avi&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;Linux从精通到放弃.mp4&#x27;</span></span><br><span class="line">        ]</span><br><span class="line">        start = time.time()</span><br><span class="line">        <span class="keyword">for</span> filename <span class="keyword">in</span> filenames:</span><br><span class="line">            pool.submit(download, filename=filename)</span><br><span class="line">    end = time.time()</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&#x27;总耗时: <span class="subst">&#123;end - start:<span class="number">.3</span>f&#125;</span>秒.&#x27;</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h3 id="守护线程"><a class="markdownIt-Anchor" href="#守护线程"></a> 守护线程</h3>
<p>所谓“守护线程”就是在主线程结束的时候，不值得再保留的执行线程。这里的不值得保留指的是守护线程会在其他非守护线程全部运行结束之后被销毁，它守护的是当前进程内所有的非守护线程。简单的说，守护线程会跟随主线程一起挂掉，而主线程的生命周期就是一个进程的生命周期。如果不理解，我们可以看一段简单的代码。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">daemon_display</span>(<span class="params">content</span>):</span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        <span class="built_in">print</span>(content, end=<span class="string">&#x27;\n&#x27;</span>, flush=<span class="literal">True</span>)</span><br><span class="line">        time.sleep(<span class="number">0.1</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">test_daemon_thread</span>():</span><br><span class="line">    threading.Thread(target=daemon_display, args=(<span class="string">&#x27;Ping&#x27;</span>, ), daemon=<span class="literal">True</span>).start()</span><br><span class="line">    threading.Thread(target=daemon_display, args=(<span class="string">&#x27;Pong&#x27;</span>, ), daemon=<span class="literal">True</span>).start()</span><br><span class="line">    time.sleep(<span class="number">2</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h3 id="资源竞争"><a class="markdownIt-Anchor" href="#资源竞争"></a> 资源竞争</h3>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Account</span>:</span><br><span class="line">    <span class="string">&quot;&quot;&quot;银行账户&quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="variable language_">self</span>.balance = <span class="number">0.0</span></span><br><span class="line">        <span class="variable language_">self</span>.lock = threading.RLock()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">deposit</span>(<span class="params">self, money</span>):</span><br><span class="line">        <span class="comment"># 通过上下文语法获得锁和释放锁</span></span><br><span class="line">        <span class="keyword">with</span> <span class="variable language_">self</span>.lock:</span><br><span class="line">            new_balance = <span class="variable language_">self</span>.balance + money</span><br><span class="line">            time.sleep(<span class="number">0.01</span>)</span><br><span class="line">            <span class="variable language_">self</span>.balance = new_balance</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">test_multithreads_account</span>():</span><br><span class="line">    account = Account()</span><br><span class="line">    <span class="keyword">with</span> ThreadPoolExecutor(max_workers=<span class="number">8</span>) <span class="keyword">as</span> pool:</span><br><span class="line">        <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">100</span>):</span><br><span class="line">            pool.submit(account.deposit, <span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(account.balance)</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h3 id="gil问题"><a class="markdownIt-Anchor" href="#gil问题"></a> GIL问题</h3>
<p>如果使用官方的 Python 解释器（通常称之为 CPython）运行 Python 程序，我们并不能通过使用多线程的方式将 CPU 的利用率提升到逼近400%（对于4核 CPU）或逼近800%（对于8核 CPU）这样的水平，因为 CPython 在执行代码时，会受到 GIL（全局解释器锁）的限制。具体的说，CPython 在执行任何代码时，都需要对应的线程先获得 GIL，然后每执行100条（字节码）指令，CPython 就会让获得 GIL 的线程主动释放 GIL，这样别的线程才有机会执行。因为 GIL 的存在，无论你的 CPU 有多少个核，我们编写的 Python 代码也没有机会真正并行的执行。</p>
<p>GIL 是官方 Python 解释器在设计上的历史遗留问题，要解决这个问题，让多线程能够发挥 CPU 的多核优势，需要重新实现一个不带 GIL 的 Python 解释器。这个问题按照官方的说法，在 Python 发布4.0版本时会得到解决，就让我们拭目以待吧。当下，对于 CPython 而言，如果希望充分发挥 CPU 的多核优势，可以考虑使用多进程，因为每个进程都对应一个 Python 解释器，因此每个进程都有自己独立的 GIL，这样就可以突破 GIL 的限制。在下一个章节中，我们会为大家介绍关于多进程的相关知识，并对多线程和多进程的代码及其执行效果进行比较。</p>
<h3 id="创建进程"><a class="markdownIt-Anchor" href="#创建进程"></a> 创建进程</h3>
<p>由于 GIL 的存在，CPython 中的多线程并不能发挥 CPU 的多核优势，如果希望突破 GIL 的限制，可以考虑使用多进程。对于多进程的程序，每个进程都有一个属于自己的 GIL，所以多进程不会受到 GIL 的影响。那么，我们应该如何在 Python 程序中创建和使用多进程呢？</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> multiprocessing <span class="keyword">import</span> Process, current_process</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">sub_task</span>(<span class="params">content, nums</span>):</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&#x27;PID: <span class="subst">&#123;current_process().pid&#125;</span>&#x27;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&#x27;Name: <span class="subst">&#123;current_process().name&#125;</span>&#x27;</span>)</span><br><span class="line">    counter, total = <span class="number">0</span>, nums.pop(<span class="number">0</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&#x27;Loop count: <span class="subst">&#123;total&#125;</span>&#x27;</span>)</span><br><span class="line">    time.sleep(<span class="number">0.5</span>)</span><br><span class="line">    <span class="keyword">while</span> counter &lt; total:</span><br><span class="line">        counter += <span class="number">1</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&#x27;<span class="subst">&#123;counter&#125;</span>: <span class="subst">&#123;content&#125;</span>&#x27;</span>)</span><br><span class="line">        time.sleep(<span class="number">0.01</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">test_sub_task</span>():</span><br><span class="line">    nums = [<span class="number">20</span>, <span class="number">30</span>, <span class="number">40</span>]</span><br><span class="line">    <span class="comment"># 创建并启动进程来执行指定的函数</span></span><br><span class="line">    Process(target=sub_task, args=(<span class="string">&#x27;Ping&#x27;</span>, nums)).start()</span><br><span class="line">    Process(target=sub_task, args=(<span class="string">&#x27;Pong&#x27;</span>, nums)).start()</span><br><span class="line">    <span class="comment"># 在主进程中执行sub_task函数</span></span><br><span class="line">    sub_task(<span class="string">&#x27;Good&#x27;</span>, nums)</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h3 id="多进程和多线程的比较"><a class="markdownIt-Anchor" href="#多进程和多线程的比较"></a> 多进程和多线程的比较</h3>
<p>对于爬虫这类 I/O 密集型任务来说，使用多进程并没有什么优势；但是对于计算密集型任务来说，多进程相比多线程，在效率上会有显著的提升，我们可以通过下面的代码来加以证明。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> concurrent.futures</span><br><span class="line"><span class="keyword">from</span> functools <span class="keyword">import</span> wraps</span><br><span class="line"></span><br><span class="line">PRIMES = [</span><br><span class="line">    <span class="number">1116281</span>,</span><br><span class="line">    <span class="number">1297337</span>,</span><br><span class="line">    <span class="number">104395303</span>,</span><br><span class="line">    <span class="number">472882027</span>,</span><br><span class="line">    <span class="number">533000389</span>,</span><br><span class="line">    <span class="number">817504243</span>,</span><br><span class="line">    <span class="number">982451653</span>,</span><br><span class="line">    <span class="number">112272535095293</span>,</span><br><span class="line">    <span class="number">112582705942171</span>,</span><br><span class="line">    <span class="number">112272535095293</span>,</span><br><span class="line">    <span class="number">115280095190773</span>,</span><br><span class="line">    <span class="number">115797848077099</span>,</span><br><span class="line">    <span class="number">1099726899285419</span></span><br><span class="line">] * <span class="number">5</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">calc_times</span>(<span class="params">func</span>):</span><br><span class="line"><span class="meta">    @wraps(<span class="params">func</span>)</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">wrapper</span>(<span class="params">*args, **kwargs</span>):</span><br><span class="line">        start = time.time()</span><br><span class="line">        result = func(*args, **kwargs)</span><br><span class="line">        end = time.time()</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&#x27;\033[31m<span class="subst">&#123;func.__name__&#125;</span>: <span class="subst">&#123;end - start:<span class="number">.3</span>f&#125;</span> seconds\033[0m&#x27;</span>)</span><br><span class="line">        <span class="keyword">return</span> result</span><br><span class="line">    <span class="keyword">return</span> wrapper</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">is_prime</span>(<span class="params">n</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;判断素数&quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>, <span class="built_in">int</span>(n ** <span class="number">0.5</span>) + <span class="number">1</span>):</span><br><span class="line">        <span class="keyword">if</span> n % i == <span class="number">0</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">    <span class="keyword">return</span> n != <span class="number">1</span></span><br><span class="line"><span class="meta">@calc_times</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">test_multi_threads</span>():</span><br><span class="line">    <span class="keyword">with</span> concurrent.futures.ThreadPoolExecutor(max_workers=<span class="number">16</span>) <span class="keyword">as</span> executor:</span><br><span class="line">        <span class="keyword">for</span> number, prime <span class="keyword">in</span> <span class="built_in">zip</span>(PRIMES, executor.<span class="built_in">map</span>(is_prime, PRIMES)):</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&#x27;<span class="subst">&#123;number&#125;</span> is prime: <span class="subst">&#123;prime&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="meta">@calc_times</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">test_multi_process</span>():</span><br><span class="line">    <span class="keyword">with</span> concurrent.futures.ProcessPoolExecutor(max_workers=<span class="number">16</span>) <span class="keyword">as</span> executor:</span><br><span class="line">        <span class="keyword">for</span> number, prime <span class="keyword">in</span> <span class="built_in">zip</span>(PRIMES, executor.<span class="built_in">map</span>(is_prime, PRIMES)):</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&#x27;<span class="subst">&#123;number&#125;</span> is prime: <span class="subst">&#123;prime&#125;</span>&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    <span class="comment"># test_sub_task()</span></span><br><span class="line">    test_multi_threads()</span><br><span class="line">    test_multi_process()</span><br><span class="line"></span><br><span class="line"><span class="comment"># test_multi_threads: 39.310 seconds</span></span><br><span class="line"><span class="comment"># test_multi_process: 24.378 seconds</span></span><br></pre></td></tr></table></figure>
<h3 id="进程间通信"><a class="markdownIt-Anchor" href="#进程间通信"></a> 进程间通信</h3>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> multiprocessing <span class="keyword">import</span> Process, Queue</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">sub_task</span>(<span class="params">content: <span class="built_in">str</span>, queue: Queue</span>):</span><br><span class="line">    counter = queue.get()</span><br><span class="line">    <span class="keyword">while</span> counter &lt; <span class="number">50</span>:</span><br><span class="line">        <span class="built_in">print</span>(content, end=<span class="string">&#x27;\n&#x27;</span>, flush=<span class="literal">True</span>)</span><br><span class="line">        counter += <span class="number">1</span></span><br><span class="line">        queue.put(counter)</span><br><span class="line">        time.sleep(<span class="number">0.01</span>)</span><br><span class="line">        counter = queue.get()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">test_sub_task_count50times</span>():</span><br><span class="line">    queue = Queue()</span><br><span class="line">    queue.put(<span class="number">0</span>)</span><br><span class="line">    p1 = Process(target=sub_task, args=(<span class="string">&#x27;Ping&#x27;</span>, queue))</span><br><span class="line">    p1.start()</span><br><span class="line">    p2 = Process(target=sub_task, args=(<span class="string">&#x27;Pong&#x27;</span>, queue))</span><br><span class="line">    p2.start()</span><br><span class="line">    <span class="keyword">while</span> p1.is_alive() <span class="keyword">and</span> p2.is_alive():</span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line">    queue.put(<span class="number">50</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h3 id="并发中四个重要概念"><a class="markdownIt-Anchor" href="#并发中四个重要概念"></a> 并发中四个重要概念</h3>
<p>同步与异步的关注点是<strong>消息通信机制</strong>，最终表现出来的是“有序”和“无序”的区别；阻塞和非阻塞的关注点是<strong>程序在等待消息时状态</strong>，最终表现出来的是程序在等待时能不能做点别的。</p>
<ul>
<li><strong>阻塞</strong><br />
阻塞状态指程序未得到所需计算资源时被挂起的状态。程序在等待某个操作完成期间，自身无法继续处理其他的事情，则称该程序在该操作上是阻塞的。阻塞随时都可能发生，最典型的就是 I/O 中断（包括网络 I/O 、磁盘 I/O 、用户输入等）、休眠操作、等待某个线程执行结束，甚至包括在 CPU 切换上下文时，程序都无法真正的执行，这就是所谓的阻塞。</li>
<li><strong>非阻塞</strong><br />
程序在等待某操作过程中，自身不被阻塞，可以继续处理其他的事情，则称该程序在该操作上是非阻塞的。非阻塞并不是在任何程序级别、任何情况下都可以存在的。仅当程序封装的级别可以囊括独立的子程序单元时，它才可能存在非阻塞状态。显然，某个操作的阻塞可能会导程序耗时以及效率低下，所以我们会希望把它变成非阻塞的。</li>
<li><strong>同步</strong><br />
不同程序单元为了完成某个任务，在执行过程中需靠某种通信方式以协调一致，我们称这些程序单元是同步执行的。例如前面讲过的给银行账户存钱的操作，我们在代码中使用了“锁”作为通信信号，让多个存钱操作强制排队顺序执行，这就是所谓的同步。</li>
<li><strong>异步</strong><br />
不同程序单元在执行过程中无需通信协调，也能够完成一个任务，这种方式我们就称之为异步。例如，使用爬虫下载页面时，调度程序调用下载程序后，即可调度其他任务，而无需与该下载任务保持通信以协调行为。不同网页的下载、保存等操作都是不相关的，也无需相互通知协调。很显然，异步操作的完成时刻和先后顺序并不能确定。</li>
</ul>
<h3 id="生成器和协程"><a class="markdownIt-Anchor" href="#生成器和协程"></a> 生成器和协程</h3>
<p>前面我们说过，异步编程是一种“协作式并发”，即通过多个子程序相互协作的方式提升 CPU 的利用率，从而减少程序在阻塞和等待中浪费的时间，最终达到并发的效果。我们可以将多个相互协作的子程序称为“协程”，它是实现异步编程的关键。在介绍协程之前，我们先通过下面的代码，看看什么是生成器。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">fib</span>(<span class="params">max_count</span>):</span><br><span class="line">    a, b = <span class="number">0</span>, <span class="number">1</span></span><br><span class="line">    <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(max_count):</span><br><span class="line">        a, b = b, a + b</span><br><span class="line">        <span class="keyword">yield</span> a</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">test_fib</span>():</span><br><span class="line">    <span class="keyword">for</span> val <span class="keyword">in</span> fib(<span class="number">20</span>):</span><br><span class="line">        <span class="built_in">print</span>(val, end=<span class="string">&#x27; &#x27;</span>)</span><br><span class="line">    <span class="built_in">print</span>()</span><br><span class="line"></span><br><span class="line"><span class="string">&quot;&quot;&quot;生成器经过预激活，就是一个协程，它可以跟其他子程序协作。&quot;&quot;&quot;</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">calc_avg</span>():</span><br><span class="line">    total, counter = <span class="number">0</span>, <span class="number">0</span></span><br><span class="line">    avg_value = <span class="literal">None</span></span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        curr_value = <span class="keyword">yield</span> avg_value</span><br><span class="line">        total += curr_value</span><br><span class="line">        counter += <span class="number">1</span></span><br><span class="line">        avg_value = total / counter</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">test_calc_avg</span>():</span><br><span class="line">    obj = calc_avg()</span><br><span class="line">    <span class="comment"># 生成器预激活</span></span><br><span class="line">    obj.send(<span class="literal">None</span>)</span><br><span class="line">    <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">5</span>):</span><br><span class="line">        <span class="built_in">print</span>(obj.send(_))</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h3 id="异步函数"><a class="markdownIt-Anchor" href="#异步函数"></a> 异步函数</h3>
<p>Python 3.5版本中，引入了两个非常有意思的元素，一个叫async，一个叫await，它们在Python 3.7版本中成为了正式的关键字。通过这两个关键字，可以简化协程代码的编写，可以用更为简单的方式让多个子程序很好的协作起来。我们通过一个例子来加以说明，请大家先看看下面的代码。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> asyncio</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">fib</span>(<span class="params">max_count</span>):</span><br><span class="line">    a, b = <span class="number">0</span>, <span class="number">1</span></span><br><span class="line">    <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(max_count):</span><br><span class="line">        a, b = b, a + b</span><br><span class="line">        <span class="keyword">yield</span> a</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">test_fib</span>():</span><br><span class="line">    <span class="keyword">for</span> val <span class="keyword">in</span> fib(<span class="number">20</span>):</span><br><span class="line">        <span class="built_in">print</span>(val, end=<span class="string">&#x27; &#x27;</span>)</span><br><span class="line">    <span class="built_in">print</span>()</span><br><span class="line"></span><br><span class="line"><span class="string">&quot;&quot;&quot;生成器经过预激活，就是一个协程，它可以跟其他子程序协作。&quot;&quot;&quot;</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">calc_avg</span>():</span><br><span class="line">    total, counter = <span class="number">0</span>, <span class="number">0</span></span><br><span class="line">    avg_value = <span class="literal">None</span></span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        curr_value = <span class="keyword">yield</span> avg_value</span><br><span class="line">        total += curr_value</span><br><span class="line">        counter += <span class="number">1</span></span><br><span class="line">        avg_value = total / counter</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">test_calc_avg</span>():</span><br><span class="line">    obj = calc_avg()</span><br><span class="line">    <span class="comment"># 生成器预激活</span></span><br><span class="line">    obj.send(<span class="literal">None</span>)</span><br><span class="line">    <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">5</span>):</span><br><span class="line">        <span class="built_in">print</span>(obj.send(_))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">sync_display</span>(<span class="params">num</span>):</span><br><span class="line">    time.sleep(<span class="number">1</span>)</span><br><span class="line">    <span class="built_in">print</span>(num)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">test_sync_display</span>():</span><br><span class="line">    start = time.time()</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">10</span>):</span><br><span class="line">        sync_display(i)</span><br><span class="line">    end = time.time()</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&#x27;<span class="subst">&#123;end - start:<span class="number">.3</span>f&#125;</span>秒&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">def</span> <span class="title function_">async_display</span>(<span class="params">num</span>):</span><br><span class="line">    <span class="keyword">await</span> asyncio.sleep(<span class="number">1</span>)</span><br><span class="line">    <span class="built_in">print</span>(num)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">test_async_display</span>():</span><br><span class="line">    start = time.time()</span><br><span class="line">    objs = [async_display(i) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">10</span>)]</span><br><span class="line">    loop = asyncio.get_event_loop()</span><br><span class="line">    loop.run_until_complete(asyncio.wait(objs))</span><br><span class="line">    loop.close()</span><br><span class="line">    end = time.time()</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&#x27;<span class="subst">&#123;end - start:<span class="number">.3</span>f&#125;</span>秒&#x27;</span>)</span><br></pre></td></tr></table></figure>
<h3 id="aiohttp库"><a class="markdownIt-Anchor" href="#aiohttp库"></a> aiohttp库</h3>
<p>我们之前使用的requests三方库并不支持异步 I/O，如果希望使用异步 I/O 的方式来加速爬虫代码的执行，我们可以安装和使用名为aiohttp的三方库。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">import</span> aiohttp</span><br><span class="line"><span class="keyword">from</span> aiohttp <span class="keyword">import</span> ClientSession</span><br><span class="line"></span><br><span class="line">TITLE_PATTERN = re.<span class="built_in">compile</span>(<span class="string">r&#x27;&lt;title.*?&gt;(.*?)&lt;/title&gt;&#x27;</span>, re.DOTALL)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">def</span> <span class="title function_">fetch_page_title</span>(<span class="params">url</span>):</span><br><span class="line">    <span class="keyword">async</span> <span class="keyword">with</span> aiohttp.ClientSession(headers=&#123;</span><br><span class="line">        <span class="string">&#x27;User-Agent&#x27;</span>: <span class="string">&#x27;Mozilla/5.0 (Macintosh; Intel Mac OS X 10_14_6) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/95.0.4638.69 Safari/537.36&#x27;</span>,</span><br><span class="line">    &#125;) <span class="keyword">as</span> session:  <span class="comment"># type: ClientSession</span></span><br><span class="line">        <span class="keyword">async</span> <span class="keyword">with</span> session.get(url, ssl=<span class="literal">False</span>) <span class="keyword">as</span> resp:</span><br><span class="line">            <span class="keyword">if</span> resp.status == <span class="number">200</span>:</span><br><span class="line">                html_code = <span class="keyword">await</span> resp.text()</span><br><span class="line">                matcher = TITLE_PATTERN.search(html_code)</span><br><span class="line">                title = matcher.group(<span class="number">1</span>).strip()</span><br><span class="line">                <span class="built_in">print</span>(title)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">    urls = [</span><br><span class="line">        <span class="string">&#x27;https://www.python.org/&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;https://www.jd.com/&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;https://www.baidu.com/&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;https://www.taobao.com/&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;https://git-scm.com/&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;https://www.sohu.com/&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;https://gitee.com/&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;https://www.amazon.com/&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;https://www.usa.gov/&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;https://www.nasa.gov/&#x27;</span></span><br><span class="line">    ]</span><br><span class="line">    objs = [fetch_page_title(url) <span class="keyword">for</span> url <span class="keyword">in</span> urls]</span><br><span class="line">    loop = asyncio.get_event_loop()</span><br><span class="line">    loop.run_until_complete(asyncio.wait(objs))</span><br><span class="line">    loop.close()</span><br></pre></td></tr></table></figure>
<h2 id="numpy的应用"><a class="markdownIt-Anchor" href="#numpy的应用"></a> <code>NumPy</code>的应用</h2>
<p><code>Numpy</code> 是一个开源的 <code>Python</code> 科学计算库，用于快速处理任意维度的数组。<code>Numpy</code> 支持常见的数组和矩阵操作，对于同样的数值计算任务，使用 <code>NumPy</code> 不仅代码要简洁的多，而且 <code>NumPy</code> 在性能上也远远优于原生 <code>Python</code>，至少是一到两个数量级的差距，而且数据量越大，<code>NumPy</code> 的优势就越明显。</p>
<p><code>NumPy</code> 最为核心的数据类型是<code>ndarray</code>，使用<code>ndarray</code>可以处理一维、二维和多维数组，该对象相当于是一个快速而灵活的大数据容器。<code>NumPy</code> 底层代码使用 C 语言编写，解决了 <code>GIL</code> 的限制，<code>ndarray</code>在存取数据的时候，数据与数据的地址都是连续的，这确保了可以进行高效率的批量操作，性能上远远优于 <code>Python</code> 中的<code>list</code>；另一方面<code>ndarray</code>对象提供了更多的方法来处理数据，尤其获取数据统计特征的方法，这些方法也是 <code>Python</code> 原生的<code>list</code>没有的。</p>
<h3 id="创建数组对象"><a class="markdownIt-Anchor" href="#创建数组对象"></a> 创建数组对象</h3>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"></span><br><span class="line"><span class="string">&quot;&quot;&quot;方法一：使用array函数，通过list创建数组对象&quot;&quot;&quot;</span></span><br><span class="line">array1 = np.array([<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>])</span><br><span class="line"><span class="built_in">print</span>(array1)</span><br><span class="line"></span><br><span class="line">array2 = np.array([[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>], [<span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>]])</span><br><span class="line"><span class="built_in">print</span>(array2)</span><br><span class="line"></span><br><span class="line"><span class="string">&quot;&quot;&quot;方法二：使用arange函数，指定取值范围和跨度创建数组对象&quot;&quot;&quot;</span></span><br><span class="line">array3 = np.arange(<span class="number">0</span>, <span class="number">20</span>, <span class="number">2</span>)</span><br><span class="line"><span class="built_in">print</span>(array3)</span><br><span class="line"></span><br><span class="line"><span class="string">&quot;&quot;&quot;方法三：使用linspace函数，用指定范围和元素个数创建数组对象，生成等差数列&quot;&quot;&quot;</span></span><br><span class="line">array4 = np.linspace(-<span class="number">10</span>, <span class="number">10</span>, <span class="number">11</span>)</span><br><span class="line"><span class="built_in">print</span>(array4)</span><br><span class="line"></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">方法四：使用logspace函数，生成等比数列</span></span><br><span class="line"><span class="string">注意：等比数列的起始值是 2^1 ，等比数列的终止值是 2^10 ，num是元素的个数，base就是底数。</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line">array5 = np.logspace(<span class="number">1</span>, <span class="number">10</span>, num=<span class="number">10</span>, base=<span class="number">2</span>)</span><br><span class="line"><span class="built_in">print</span>(array5)</span><br><span class="line"></span><br><span class="line"><span class="string">&quot;&quot;&quot;方法五：通过fromstring函数从字符串提取数据创建数组对象&quot;&quot;&quot;</span></span><br><span class="line">array6 = np.fromstring(<span class="string">&#x27;1, 2, 3, 4, 5&#x27;</span>, sep=<span class="string">&#x27;,&#x27;</span>, dtype=<span class="string">&#x27;i8&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(array6)</span><br><span class="line"></span><br><span class="line"><span class="string">&quot;&quot;&quot;方法六：通过fromiter函数从生成器（迭代器）中获取数据创建数组对象&quot;&quot;&quot;</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">fib</span>(<span class="params">num</span>):</span><br><span class="line">    a, b = <span class="number">0</span>, <span class="number">1</span></span><br><span class="line">    <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(num):</span><br><span class="line">        a, b = b, a + b</span><br><span class="line">        <span class="keyword">yield</span> a</span><br><span class="line"></span><br><span class="line">gen = fib(<span class="number">20</span>)</span><br><span class="line">array7 = np.fromiter(gen, dtype=<span class="string">&#x27;i8&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(array7)</span><br><span class="line"></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">方法七：使用numpy.random模块的函数生成随机数创建数组对象</span></span><br><span class="line"><span class="string">产生 10 个 [ 0 , 1 ) 范围的随机小数，代码：</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line">array8 = np.random.rand(<span class="number">5</span>)</span><br><span class="line"><span class="built_in">print</span>(array8)</span><br><span class="line"></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">产生 10 个 [ 1 , 100 ) 范围的随机整数，代码：</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line">array9 = np.random.randint(<span class="number">1</span>, <span class="number">100</span>, <span class="number">10</span>)</span><br><span class="line"><span class="built_in">print</span>(array9)</span><br><span class="line"></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">产生 20 个 μ = 50 ， σ = 10 的正态分布随机数，代码：</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line">array10 = np.random.normal(<span class="number">50</span>, <span class="number">10</span>, <span class="number">20</span>)</span><br><span class="line"><span class="built_in">print</span>(array10)</span><br><span class="line"></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">产生 [ 0 , 1 ) 范围的随机小数构成的 3 行 4 列的二维数组，代码：</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line">array11 = np.random.rand(<span class="number">3</span>, <span class="number">4</span>)</span><br><span class="line"><span class="built_in">print</span>(array11)</span><br><span class="line"></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">产生 [ 1 , 100 ) 范围的随机整数构成的三维数组，代码：</span></span><br><span class="line"><span class="string">(3, 4, 5): 3block, 4row, 5col</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line">array12 = np.random.randint(<span class="number">1</span>, <span class="number">100</span>, (<span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>))</span><br><span class="line"><span class="built_in">print</span>(array12)</span><br><span class="line"></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">方法八：创建全0、全1或指定元素的数组</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;使用zeros函数，代码：&quot;&quot;&quot;</span></span><br><span class="line">array13 = np.zeros((<span class="number">3</span>, <span class="number">4</span>))</span><br><span class="line"><span class="built_in">print</span>(array13)</span><br><span class="line"><span class="string">&quot;&quot;&quot;使用ones函数，代码：&quot;&quot;&quot;</span></span><br><span class="line">array14 = np.ones((<span class="number">3</span>, <span class="number">4</span>))</span><br><span class="line"><span class="built_in">print</span>(array14)</span><br><span class="line"><span class="string">&quot;&quot;&quot;使用full函数，代码：&quot;&quot;&quot;</span></span><br><span class="line">array15 = np.full((<span class="number">3</span>, <span class="number">4</span>), <span class="number">10</span>)</span><br><span class="line"><span class="built_in">print</span>(array15)</span><br><span class="line"></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">方法九：使用eye函数创建单位矩阵</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line">array16 = np.eye(<span class="number">4</span>)</span><br><span class="line"><span class="built_in">print</span>(array16)</span><br><span class="line"></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">方法十：读取图片获得对应的三维数组</span></span><br><span class="line"><span class="string">说明：上面的代码读取了当前路径下名为guido.jpg 的图片文件，</span></span><br><span class="line"><span class="string">计算机系统中的图片通常由若干行若干列的像素点构成，</span></span><br><span class="line"><span class="string">而每个像素点又是由红绿蓝三原色构成的，刚好可以用三维数组来表示。</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line">array17 = plt.imread(<span class="string">&#x27;guido.jpg&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(array17)</span><br></pre></td></tr></table></figure>
<h3 id="数组对象的属性"><a class="markdownIt-Anchor" href="#数组对象的属性"></a> 数组对象的属性</h3>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&quot;&quot;&quot;size属性：获取数组元素个数。&quot;&quot;&quot;</span></span><br><span class="line">array16 = np.arange(<span class="number">1</span>, <span class="number">100</span>, <span class="number">2</span>)</span><br><span class="line">array18 = np.random.rand(<span class="number">3</span>, <span class="number">4</span>)</span><br><span class="line"><span class="built_in">print</span>(array16.size)</span><br><span class="line"><span class="built_in">print</span>(array17.size)</span><br><span class="line"><span class="built_in">print</span>(array18.size)</span><br><span class="line"></span><br><span class="line"><span class="string">&quot;&quot;&quot;shape属性：获取数组的形状。&quot;&quot;&quot;</span></span><br><span class="line"><span class="built_in">print</span>(array16.shape)</span><br><span class="line"><span class="built_in">print</span>(array17.shape)</span><br><span class="line"><span class="built_in">print</span>(array18.shape)</span><br><span class="line"></span><br><span class="line"><span class="string">&quot;&quot;&quot;dtype属性：获取数组元素的数据类型。&quot;&quot;&quot;</span></span><br><span class="line"><span class="built_in">print</span>(array16.dtype)</span><br><span class="line"><span class="built_in">print</span>(array17.dtype)</span><br><span class="line"><span class="built_in">print</span>(array18.dtype)</span><br><span class="line"></span><br><span class="line"><span class="string">&quot;&quot;&quot;ndim属性：获取数组的维度。&quot;&quot;&quot;</span></span><br><span class="line"><span class="built_in">print</span>(array16.ndim)</span><br><span class="line"><span class="built_in">print</span>(array17.ndim)</span><br><span class="line"><span class="built_in">print</span>(array18.ndim)</span><br><span class="line"></span><br><span class="line"><span class="string">&quot;&quot;&quot;itemsize属性：获取数组单个元素占用内存空间的字节数。&quot;&quot;&quot;</span></span><br><span class="line"><span class="built_in">print</span>(array16.itemsize)</span><br><span class="line"><span class="built_in">print</span>(array17.itemsize)</span><br><span class="line"><span class="built_in">print</span>(array18.itemsize)</span><br><span class="line"></span><br><span class="line"><span class="string">&quot;&quot;&quot;nbytes属性：获取数组所有元素占用内存空间的字节数。&quot;&quot;&quot;</span></span><br><span class="line"><span class="built_in">print</span>(array16.nbytes)</span><br><span class="line"><span class="built_in">print</span>(array17.nbytes)</span><br><span class="line"><span class="built_in">print</span>(array18.nbytes)</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h3 id="数组的索引运算"><a class="markdownIt-Anchor" href="#数组的索引运算"></a> 数组的索引运算</h3>
<p>和 Python 中的列表类似，NumPy 的ndarray对象可以进行索引和切片操作，通过索引可以获取或修改数组中的元素，通过切片操作可以取出数组的一部分，我们把切片操作也称为切片索引。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">普通索引</span></span><br><span class="line"><span class="string">类似于 Python 中list类型的索引运算。</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line">array19 = np.arange(<span class="number">1</span>, <span class="number">10</span>)</span><br><span class="line"><span class="built_in">print</span>(array19[<span class="number">0</span>], array19[array19.size - <span class="number">1</span>])</span><br><span class="line"><span class="built_in">print</span>(array19[-array19.size], array19[-<span class="number">1</span>])</span><br><span class="line"></span><br><span class="line">array20 = np.array([[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>], [<span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>], [<span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>]])</span><br><span class="line"><span class="built_in">print</span>(array20[<span class="number">2</span>])</span><br><span class="line"><span class="built_in">print</span>(array20[<span class="number">0</span>][<span class="number">0</span>])</span><br><span class="line"><span class="built_in">print</span>(array20[-<span class="number">1</span>][-<span class="number">1</span>])</span><br><span class="line"><span class="built_in">print</span>(array20[<span class="number">1</span>][<span class="number">1</span>])</span><br><span class="line"><span class="built_in">print</span>(array20[<span class="number">1</span>, <span class="number">1</span>])</span><br><span class="line">array20[<span class="number">1</span>][<span class="number">1</span>] = <span class="number">20</span></span><br><span class="line"><span class="built_in">print</span>(array20)</span><br><span class="line">array20[<span class="number">1</span>] = [<span class="number">10</span>, <span class="number">11</span>, <span class="number">12</span>]</span><br><span class="line"><span class="built_in">print</span>(array20)</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h3 id="切片索引"><a class="markdownIt-Anchor" href="#切片索引"></a> 切片索引</h3>
<p>切片索引是形如[开始索引:结束索引:跨度]的语法，通过指定开始索引（默认值无穷小）、结束索引（默认值无穷大）和跨度（默认值1），从数组中取出指定部分的元素并构成新的数组。因为开始索引、结束索引和步长都有默认值，所以它们都可以省略，如果不指定步长，第二个冒号也可以省略。一维数组的切片运算跟 Python 中的list类型的切片非常类似，此处不再赘述，二维数组的切片可以参考下面的代码，相信非常容易理解。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&quot;&quot;&quot;&quot;切片索引&quot;&quot;&quot;</span></span><br><span class="line"><span class="built_in">print</span>(array20[:<span class="number">2</span>, <span class="number">1</span>:])</span><br><span class="line"><span class="built_in">print</span>(array20[<span class="number">2</span>, :])</span><br><span class="line"><span class="built_in">print</span>(array20[<span class="number">2</span>:, :])</span><br><span class="line"><span class="built_in">print</span>(array20[:, :<span class="number">2</span>])</span><br><span class="line"><span class="built_in">print</span>(array20[::<span class="number">2</span>, ::<span class="number">2</span>])</span><br><span class="line"><span class="built_in">print</span>(array20[::-<span class="number">2</span>, ::-<span class="number">2</span>])</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h3 id="花式索引"><a class="markdownIt-Anchor" href="#花式索引"></a> 花式索引</h3>
<p>花式索引是用保存整数的数组充当一个数组的索引，这里所说的数组可以是 NumPy 的ndarray，也可以是 Python 中list、tuple等可迭代类型，可以使用正向或负向索引。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(array19[[<span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, -<span class="number">1</span>, <span class="number">4</span>, -<span class="number">1</span>]])</span><br><span class="line"><span class="built_in">print</span>(array20[[<span class="number">0</span>, <span class="number">2</span>]])</span><br><span class="line"><span class="built_in">print</span>(array20[[<span class="number">0</span>, <span class="number">2</span>], [<span class="number">1</span>, <span class="number">2</span>]])</span><br><span class="line"><span class="built_in">print</span>(array20[[<span class="number">0</span>, <span class="number">2</span>], <span class="number">1</span>])</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h3 id="布尔索引"><a class="markdownIt-Anchor" href="#布尔索引"></a> 布尔索引</h3>
<p>布尔索引就是通过保存布尔值的数组充当一个数组的索引，布尔值为True的元素保留，布尔值为False的元素不会被选中。布尔值的数组可以手动构造，也可以通过关系运算来产生。<br />
关于索引运算需要说明的是，切片索引虽然创建了新的数组对象，但是新数组和原数组共享了数组中的数据，简单的说，无论你通过新数组对象或原数组对象修改数组中的数据，修改的其实是内存中的同一块数据。花式索引和布尔索引也会创建新的数组对象，而且新数组复制了原数组的元素，新数组和原数组并不是共享数据的关系，这一点可以查看数组对象的base属性，有兴趣的读者可以自行探索。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(array19[[<span class="literal">True</span>, <span class="literal">True</span>, <span class="literal">False</span>, <span class="literal">False</span>, <span class="literal">True</span>, <span class="literal">False</span>, <span class="literal">False</span>, <span class="literal">True</span>, <span class="literal">True</span>]])</span><br><span class="line"><span class="built_in">print</span>(array19 &gt; <span class="number">5</span>)</span><br><span class="line"><span class="built_in">print</span>(~(array19 &gt; <span class="number">5</span>))</span><br><span class="line"><span class="built_in">print</span>(array19[array19 &gt; <span class="number">5</span>])</span><br><span class="line"><span class="built_in">print</span>(array19 % <span class="number">2</span> == <span class="number">0</span>)</span><br><span class="line"><span class="built_in">print</span>(array19[array19 % <span class="number">2</span> == <span class="number">0</span>])</span><br><span class="line"><span class="built_in">print</span>((array19 &gt; <span class="number">5</span>) &amp; (array19 % <span class="number">2</span> == <span class="number">0</span>))</span><br><span class="line"><span class="built_in">print</span>(array19[(array19 &gt; <span class="number">5</span>) &amp; (array19 % <span class="number">2</span> == <span class="number">0</span>)])</span><br><span class="line"><span class="built_in">print</span>(array19[(array19 &gt; <span class="number">5</span>) | (array19 % <span class="number">2</span> == <span class="number">0</span>)])</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h3 id="案例通过数组切片处理图像"><a class="markdownIt-Anchor" href="#案例通过数组切片处理图像"></a> 案例：通过数组切片处理图像</h3>
<p>学习基础知识总是比较枯燥且没有成就感的，所以我们还是来个案例为大家演示下上面学习的数组索引和切片操作到底有什么用。前面我们说到过，可以用三维数组来表示图像，那么通过图像对应的三维数组进行操作，就可以实现对图像的处理，如下所示。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> matplotlib</span><br><span class="line">matplotlib.use(<span class="string">&#x27;TkAgg&#x27;</span>)</span><br><span class="line">guido_img = plt.imread(<span class="string">&#x27;guido.jpg&#x27;</span>)</span><br><span class="line"><span class="comment"># 正常载入图片</span></span><br><span class="line">plt.imshow(guido_img)</span><br><span class="line">plt.show()</span><br><span class="line"><span class="comment"># 垂直翻转</span></span><br><span class="line">plt.imshow(guido_img[::-<span class="number">1</span>])</span><br><span class="line">plt.show()</span><br><span class="line"><span class="comment"># 水平翻转</span></span><br><span class="line">plt.imshow(guido_img[:, ::-<span class="number">1</span>])</span><br><span class="line">plt.show()</span><br><span class="line"><span class="comment"># 通过切片操作实现抠图，将吉多大叔的头抠出来。</span></span><br><span class="line">plt.imshow(guido_img[<span class="number">30</span>:<span class="number">350</span>, <span class="number">90</span>:<span class="number">300</span>])</span><br><span class="line">plt.show()</span><br><span class="line"><span class="comment"># 通过切片操作实现降采样。</span></span><br><span class="line">plt.imshow(guido_img[::<span class="number">10</span>, ::<span class="number">10</span>])</span><br><span class="line">plt.show()</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h3 id="数组对象的方法"><a class="markdownIt-Anchor" href="#数组对象的方法"></a> 数组对象的方法</h3>
<ol>
<li>计算总和、均值和中位数。</li>
</ol>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(np.<span class="built_in">sum</span>(array1))</span><br><span class="line"><span class="built_in">print</span>(array1.<span class="built_in">sum</span>())</span><br><span class="line"><span class="built_in">print</span>(np.mean(array1))</span><br><span class="line"><span class="built_in">print</span>(array1.mean())</span><br><span class="line"><span class="built_in">print</span>(np.median(array1))</span><br><span class="line"><span class="built_in">print</span>(np.quantile(array1, <span class="number">0.5</span>))</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<ol start="2">
<li>极值、全距和四分位距离。</li>
</ol>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(np.<span class="built_in">max</span>(array1))</span><br><span class="line"><span class="built_in">print</span>(array1.<span class="built_in">max</span>())</span><br><span class="line"><span class="built_in">print</span>(array1.<span class="built_in">min</span>())</span><br><span class="line"><span class="built_in">print</span>(np.<span class="built_in">min</span>(array1))</span><br><span class="line"><span class="built_in">print</span>(np.ptp(array1))</span><br><span class="line">q1, q3 = np.quantile(array1, [<span class="number">0.25</span>, <span class="number">0.75</span>])</span><br><span class="line"><span class="built_in">print</span>(q3 - q1)</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<ol start="3">
<li>方差、标准差和变异系数。</li>
</ol>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(array1.var())</span><br><span class="line"><span class="built_in">print</span>(np.var(array1))</span><br><span class="line"><span class="built_in">print</span>(array1.std())</span><br><span class="line"><span class="built_in">print</span>(np.std(array1))</span><br><span class="line"><span class="built_in">print</span>(array1.std() / array1.mean())</span><br></pre></td></tr></table></figure>
<ol start="4">
<li>绘制箱线图。<br />
箱线图又称为盒须图，是显示一组数据分散情况的统计图，因形状如箱子而得名。 它主要用于反映原始数据分布的特征，还可以进行多组数据分布特征的比较。</li>
</ol>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">plt.boxplot(array1, showmeans=<span class="literal">True</span>)</span><br><span class="line">plt.ylim([-<span class="number">20</span>, <span class="number">120</span>])</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>
<h3 id="数组的运算"><a class="markdownIt-Anchor" href="#数组的运算"></a> 数组的运算</h3>
<p>使用 NumPy 最为方便的是当需要对数组元素进行运算时，不用编写循环代码遍历每个元素，所有的运算都会自动的矢量化。简单的说就是，NumPy 中的数学运算和数学函数会自动作用于数组中的每个成员。</p>
<ol>
<li>数组跟标量的运算</li>
</ol>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">array1= np.arange(<span class="number">1</span>, <span class="number">10</span>)</span><br><span class="line"><span class="built_in">print</span>(array1 + <span class="number">10</span>)</span><br><span class="line"><span class="built_in">print</span>(array1 * <span class="number">10</span>)</span><br><span class="line"><span class="comment"># [11 12 13 14 15 16 17 18 19]</span></span><br><span class="line"><span class="comment"># [10 20 30 40 50 60 70 80 90]</span></span><br><span class="line"><span class="built_in">print</span>(array1 &gt; <span class="number">5</span>)</span><br><span class="line"><span class="built_in">print</span>(array1 % <span class="number">2</span> == <span class="number">0</span>)</span><br><span class="line"><span class="comment"># [False False False False False  True  True  True  True]</span></span><br><span class="line"><span class="comment"># [False  True False  True False  True False  True False]</span></span><br></pre></td></tr></table></figure>
<ol start="2">
<li>数组跟数组的运算<br />
NumPy 的数组跟数组也可以执行算术运算和关系运算，运算会作用于两个数组对应的元素上，这就要求两个数组的形状（shape属性）要相同，如下所示。</li>
</ol>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">array2 = np.array([<span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">3</span>, <span class="number">3</span>])</span><br><span class="line"><span class="built_in">print</span>(array1 + array2)</span><br><span class="line"><span class="built_in">print</span>(array1 * array2)</span><br><span class="line"><span class="built_in">print</span>(array1 ** array2)</span><br><span class="line"><span class="comment"># [ 2  3  4  6  7  8 10 11 12]</span></span><br><span class="line"><span class="comment"># [ 1  2  3  8 10 12 21 24 27]</span></span><br><span class="line"><span class="comment"># [  1   2   3  16  25  36 343 512 729]</span></span><br><span class="line"><span class="built_in">print</span>(array1 &gt; array2)</span><br><span class="line"><span class="built_in">print</span>(array1 % array2 == <span class="number">0</span>)</span><br><span class="line"><span class="comment"># [False  True  True  True  True  True  True  True  True]</span></span><br><span class="line"><span class="comment"># [ True  True  True  True False  True False False  True]</span></span><br></pre></td></tr></table></figure>
<ol start="3">
<li>通用一元函数<br />
NumPy 中通用一元函数的参数是一个数组对象，函数会对数组进行元素级的处理，例如：sqrt函数会对数组中的每个元素计算平方根，而log2函数会对数组中的每个元素计算以2为底的对数，代码如下所示。</li>
</ol>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(np.sqrt(array1))</span><br><span class="line"><span class="built_in">print</span>(np.log2(array1))</span><br></pre></td></tr></table></figure>
<ul>
<li>表1：通用一元函数</li>
</ul>
<table>
<thead>
<tr>
<th>函数</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>abs</code> / <code>fabs</code></td>
<td>求绝对值的函数</td>
</tr>
<tr>
<td><code>sqrt</code></td>
<td>求平方根的函数，相当于<code>array ** 0.5 </code></td>
</tr>
<tr>
<td><code>square</code></td>
<td>求平方的函数，相当于<code>array ** 2</code></td>
</tr>
<tr>
<td><code>exp</code></td>
<td>计算 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathsize="0.9em"><msup><mi>e</mi><mi>x</mi></msup></mstyle></mrow><annotation encoding="application/x-tex">\small{e^x}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.585036em;vertical-align:0em;"></span><span class="mord sizing reset-size6 size5"><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.65004em;"><span style="top:-2.963em;margin-right:0.05555555555555556em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight">x</span></span></span></span></span></span></span></span></span></span></span></span> 的函数</td>
</tr>
<tr>
<td><code>log</code> / <code>log10</code> / <code>log2</code></td>
<td>对数函数（<code>e</code>为底 / <code>10</code>为底 / <code>2</code>为底）</td>
</tr>
<tr>
<td><code>sign</code></td>
<td>符号函数（<code>1</code> - 正数；<code>0</code> - 零；<code>-1</code> - 负数）</td>
</tr>
<tr>
<td><code>ceil</code> / <code>floor</code></td>
<td>上取整 /  下取整</td>
</tr>
<tr>
<td><code>isnan</code></td>
<td>返回布尔数组，NaN对应<code>True</code>，非NaN对应<code>False</code></td>
</tr>
<tr>
<td><code>isfinite</code> / <code>isinf</code></td>
<td>判断数值是否为无穷大的函数</td>
</tr>
<tr>
<td><code>cos</code> / <code>cosh</code> / <code>sin</code></td>
<td>三角函数</td>
</tr>
<tr>
<td><code>sinh</code> / <code>tan</code> / <code>tanh</code></td>
<td>三角函数</td>
</tr>
<tr>
<td><code>arccos</code> / <code>arccosh</code> / <code>arcsin</code></td>
<td>反三角函数</td>
</tr>
<tr>
<td><code>arcsinh</code> / <code>arctan</code> / <code>arctanh</code></td>
<td>反三角函数</td>
</tr>
<tr>
<td><code>rint</code> / <code>round</code></td>
<td>四舍五入函数</td>
</tr>
</tbody>
</table>
<ol start="2">
<li>通用二元函数<br />
NumPy 中通用二元函数的参数是两个数组对象，函数会对两个数组中的对应元素进行运算，例如：maximum函数会对两个数组中对应的元素找最大值，而power函数会对两个数组中对应的元素进行求幂操作，代码如下所示。</li>
</ol>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">array3 = np.array([[<span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>], [<span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>]])</span><br><span class="line">array4 = np.array([[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>], [<span class="number">3</span>, <span class="number">2</span>, <span class="number">1</span>]])</span><br><span class="line"><span class="built_in">print</span>(np.maximum(array3, array4))</span><br><span class="line"><span class="built_in">print</span>(np.power(array3, array4))</span><br><span class="line"><span class="comment"># [[4 5 6]</span></span><br><span class="line"><span class="comment">#  [7 8 9]]</span></span><br><span class="line"><span class="comment"># [[  4  25 216]</span></span><br><span class="line"><span class="comment">#  [343  64   9]]</span></span><br></pre></td></tr></table></figure>
<ul>
<li>表2：通用二元函数</li>
</ul>
<table>
<thead>
<tr>
<th>函数</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>add(x, y)</code> / <code>substract(x, y)</code></td>
<td>加法函数 / 减法函数</td>
</tr>
<tr>
<td><code>multiply(x, y)</code> / <code>divide(x, y)</code></td>
<td>乘法函数 / 除法函数</td>
</tr>
<tr>
<td><code>floor_divide(x, y)</code> / <code>mod(x, y)</code></td>
<td>整除函数 / 求模函数</td>
</tr>
<tr>
<td><code>allclose(x, y)</code></td>
<td>检查数组<code>x</code>和<code>y</code>元素是否几乎相等</td>
</tr>
<tr>
<td><code>power(x, y)</code></td>
<td>数组<code>x</code>的元素 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathsize="0.9em"><msub><mi>x</mi><mi>i</mi></msub></mstyle></mrow><annotation encoding="application/x-tex">\small{x_{i}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5225040000000001em;vertical-align:-0.135em;"></span><span class="mord sizing reset-size6 size5"><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.28967999999999994em;"><span style="top:-2.45em;margin-left:0em;margin-right:0.05555555555555556em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span> 和数组<code>y</code>的元素 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathsize="0.9em"><msub><mi>y</mi><mi>i</mi></msub></mstyle></mrow><annotation encoding="application/x-tex">\small{y_{i}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5625em;vertical-align:-0.174996em;"></span><span class="mord sizing reset-size6 size5"><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.28967999999999994em;"><span style="top:-2.45em;margin-left:-0.03588em;margin-right:0.05555555555555556em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span>，计算 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathsize="0.9em"><msubsup><mi>x</mi><mi>i</mi><msub><mi>y</mi><mi>i</mi></msub></msubsup></mstyle></mrow><annotation encoding="application/x-tex">\small{x_{i}^{y_{i}}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.920928em;vertical-align:-0.229392em;"></span><span class="mord sizing reset-size6 size5"><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7683733333333332em;"><span style="top:-2.34512em;margin-left:0em;margin-right:0.05555555555555556em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span style="top:-3.0813333333333333em;margin-right:0.05555555555555556em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3447999999999998em;margin-left:-0.03588em;margin-right:0.08333333333333334em;"><span class="pstrut" style="height:2.5496em;"></span><span class="sizing reset-size2 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.20479999999999998em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.25488em;"><span></span></span></span></span></span></span></span></span></span></span></td>
</tr>
<tr>
<td><code>maximum(x, y)</code> / <code>fmax(x, y)</code></td>
<td>两两比较元素获取最大值 / 获取最大值（忽略NaN）</td>
</tr>
<tr>
<td><code>minimum(x, y)</code> / <code>fmin(x, y)</code></td>
<td>两两比较元素获取最小值 / 获取最小值（忽略NaN）</td>
</tr>
<tr>
<td><code>dot(x, y)</code></td>
<td>点积运算（数量积，通常记为 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathsize="0.9em"><mo lspace="0em" rspace="0em">⋅</mo></mstyle></mrow><annotation encoding="application/x-tex">\small{\cdot}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.400005em;vertical-align:0em;"></span><span class="mord sizing reset-size6 size5"><span class="mord">⋅</span></span></span></span></span> ，用于欧几里得空间（Euclidean space））</td>
</tr>
<tr>
<td><code>inner(x, y)</code></td>
<td>内积运算（内积的含义要高于点积，点积相当于是内积在欧几里得空间 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathsize="0.9em"><msup><mi mathvariant="double-struck">R</mi><mi>n</mi></msup></mstyle></mrow><annotation encoding="application/x-tex">\small{\mathbb{R}^{n}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.620001em;vertical-align:0em;"></span><span class="mord sizing reset-size6 size5"><span class="mord"><span class="mord"><span class="mord mathbb">R</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.65004em;"><span style="top:-2.963em;margin-right:0.05555555555555556em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span></span></span></span></span></span></span></span></span> 的特例，而内积可以推广到赋范向量空间，只要它满足平行四边形法则即可）</td>
</tr>
<tr>
<td><code>cross(x, y) </code></td>
<td>叉积运算（向量积，通常记为 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathsize="0.9em"><mo lspace="0em" rspace="0em">×</mo></mstyle></mrow><annotation encoding="application/x-tex">\small{\times}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.599994em;vertical-align:-0.07499700000000001em;"></span><span class="mord sizing reset-size6 size5"><span class="mord">×</span></span></span></span></span> ，运算结果是一个向量）</td>
</tr>
<tr>
<td><code>outer(x, y)</code></td>
<td>外积运算（张量积，通常记为 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathsize="0.9em"><mo lspace="0em" rspace="0em">⨂</mo></mstyle></mrow><annotation encoding="application/x-tex">\small{\bigotimes}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9000090000000001em;vertical-align:-0.22500900000000001em;"></span><span class="mord sizing reset-size6 size5"><span class="mop op-symbol small-op" style="position:relative;top:-0.0000050000000000050004em;">⨂</span></span></span></span></span> ，运算结果通常是一个矩阵）</td>
</tr>
<tr>
<td><code>intersect1d(x, y)</code></td>
<td>计算<code>x</code>和<code>y</code>的交集，返回这些元素构成的有序数组</td>
</tr>
<tr>
<td><code>union1d(x, y)</code></td>
<td>计算<code>x</code>和<code>y</code>的并集，返回这些元素构成的有序数组</td>
</tr>
<tr>
<td><code>in1d(x, y)</code></td>
<td>返回由判断<code>x</code> 的元素是否在<code>y</code>中得到的布尔值构成的数组</td>
</tr>
<tr>
<td><code>setdiff1d(x, y)</code></td>
<td>计算<code>x</code>和<code>y</code>的差集，返回这些元素构成的数组</td>
</tr>
<tr>
<td><code>setxor1d(x, y)</code></td>
<td>计算<code>x</code>和<code>y</code>的对称差，返回这些元素构成的数组</td>
</tr>
</tbody>
</table>
<h3 id="广播机制"><a class="markdownIt-Anchor" href="#广播机制"></a> 广播机制</h3>
<p>上面数组运算的例子中，两个数组的形状（<code>shape</code>属性）是完全相同的，我们再来研究一下，两个形状不同的数组是否可以直接做二元运算或使用通用二元函数进行运算，请看下面的例子。</p>
<p>代码：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">array5 = np.array([[<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>], [<span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>], [<span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>], [<span class="number">3</span>, <span class="number">3</span>, <span class="number">3</span>]])</span><br><span class="line">array6 = np.array([<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>])</span><br><span class="line">array5 + array6</span><br></pre></td></tr></table></figure>
<p>输出：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">array([[1, 2, 3],</span><br><span class="line">       [2, 3, 4],</span><br><span class="line">       [3, 4, 5],</span><br><span class="line">       [4, 5, 6]])</span><br></pre></td></tr></table></figure>
<p>代码：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">array7 = np.array([[<span class="number">1</span>], [<span class="number">2</span>], [<span class="number">3</span>], [<span class="number">4</span>]])</span><br><span class="line">array5 + array7</span><br></pre></td></tr></table></figure>
<p>通过上面的例子，我们发现形状不同的数组仍然有机会进行二元运算，但这不代表任意形状的数组都可以进行二元运算。简单的说，只有两个数组后缘维度相同或者后缘维度不同但其中一个数组后缘维度为1时，广播机制才会被触发。通过广播机制，NumPy 将两个原本形状不相同的数组变成形状相同，才能进行二元运算。所谓后缘维度，指的是数组形状（shape属性）从后往前看对应的部分，我们举例说明。</p>
<h3 id="其他常用函数"><a class="markdownIt-Anchor" href="#其他常用函数"></a> 其他常用函数</h3>
<p>除了上面讲到的函数外，NumPy 中还提供了很多用于处理数组的函数，<code>ndarray</code>对象的很多方法也可以通过调用函数来实现，下表给出了一些常用的函数。</p>
<ul>
<li>表3：NumPy其他常用函数</li>
</ul>
<table>
<thead>
<tr>
<th>函数</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>unique</code></td>
<td>去除数组重复元素，返回唯一元素构成的有序数组</td>
</tr>
<tr>
<td><code>copy</code></td>
<td>返回拷贝数组得到的数组</td>
</tr>
<tr>
<td><code>sort</code></td>
<td>返回数组元素排序后的拷贝</td>
</tr>
<tr>
<td><code>split</code> / <code>hsplit</code> / <code>vsplit</code></td>
<td>将数组拆成若干个子数组</td>
</tr>
<tr>
<td><code>stack</code> / <code>hstack</code> / <code>vstack</code></td>
<td>将多个数组堆叠成新数组</td>
</tr>
<tr>
<td><code>concatenate</code></td>
<td>沿着指定的轴连接多个数组构成新数组</td>
</tr>
<tr>
<td><code>append</code> / <code>insert</code></td>
<td>向数组末尾追加元素 / 在数组指定位置插入元素</td>
</tr>
<tr>
<td><code>argwhere</code></td>
<td>找出数组中非0元素的位置</td>
</tr>
<tr>
<td><code>extract</code> / <code>select</code> / <code>where</code></td>
<td>按照指定的条件从数组中抽取或处理数组元素</td>
</tr>
<tr>
<td><code>flip</code></td>
<td>沿指定的轴翻转数组中的元素</td>
</tr>
<tr>
<td><code>fromregex</code></td>
<td>通过读取文件和正则表达式解析获取数据创建数组对象</td>
</tr>
<tr>
<td><code>repeat</code> / <code>tile</code></td>
<td>通过对元素的重复来创建新数组</td>
</tr>
<tr>
<td><code>roll</code></td>
<td>沿指定轴对数组元素进行移位</td>
</tr>
<tr>
<td><code>resize</code></td>
<td>重新调整数组的大小</td>
</tr>
<tr>
<td><code>place</code> / <code>put</code></td>
<td>将数组中满足条件的元素/指定的元素替换为指定的值</td>
</tr>
<tr>
<td><code>partition</code></td>
<td>用选定的元素对数组进行一次划分并返回划分后的数组</td>
</tr>
</tbody>
</table>
<h3 id="向量"><a class="markdownIt-Anchor" href="#向量"></a> 向量</h3>
<p><strong>向量</strong>（<em>vector</em>）也叫<strong>矢量</strong>，是一个同时具有大小和方向，且满足平行四边形法则的几何对象。与向量相对的概念叫<strong>标量</strong>或<strong>数量</strong>，标量只有大小，绝大多数情况下没有方向。我们通常用带箭头的线段来表示向量，在平面直角坐标系中的向量如下图所示。需要注意的是，向量是表达大小和方向的量，并没有规定起点和终点，所以相同的向量可以画在任意位置，例如下图中 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathsize="0.9em"><mi mathvariant="bold-italic">w</mi></mstyle></mrow><annotation encoding="application/x-tex">\small{\boldsymbol{w}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.399996em;vertical-align:0em;"></span><span class="mord sizing reset-size6 size5"><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right:0.02778em;">w</span></span></span></span></span></span></span> 和 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathsize="0.9em"><mi mathvariant="bold-italic">u</mi></mstyle></mrow><annotation encoding="application/x-tex">\small{\boldsymbol{u}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.399996em;vertical-align:0em;"></span><span class="mord sizing reset-size6 size5"><span class="mord"><span class="mord"><span class="mord boldsymbol">u</span></span></span></span></span></span></span> 两个向量并没有什么区别。</p>
<img src="/images/vector_1.png" style="zoom:40%;">
<h3 id="矩阵对象"><a class="markdownIt-Anchor" href="#矩阵对象"></a> 矩阵对象</h3>
<p>NumPy 中提供了专门用于线性代数（<em>linear algebra</em>）的模块和表示矩阵的类型<code>matrix</code>，当然我们通过二维数组也可以表示一个矩阵，官方并不推荐使用<code>matrix</code>类而是建议使用二维数组，而且有可能在将来的版本中会移除<code>matrix</code>类。无论如何，利用这些已经封装好的类和函数，我们可以轻松愉快的实现很多对矩阵的操作。</p>
<p>我们可以通过下面的代码来创建矩阵（<code>matrix</code>）对象。</p>
<p>代码：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">m1 = np.matrix(<span class="string">&#x27;1 2 3; 4 5 6&#x27;</span>)</span><br><span class="line">m1</span><br></pre></td></tr></table></figure>
<blockquote>
<p><strong>说明</strong>：<code>matrix</code>构造器可以传入类数组对象也可以传入字符串来构造矩阵对象。</p>
</blockquote>
<p>输出：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">matrix([[1, 2, 3],</span><br><span class="line">        [4, 5, 6]])</span><br></pre></td></tr></table></figure>
<p>代码：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">m2 = np.asmatrix(np.array([[<span class="number">1</span>, <span class="number">1</span>], [<span class="number">2</span>, <span class="number">2</span>], [<span class="number">3</span>, <span class="number">3</span>]]))</span><br><span class="line">m2</span><br></pre></td></tr></table></figure>
<blockquote>
<p><strong>说明</strong>：<code>asmatrix</code>函数也可以用<code>mat</code>函数代替，这两个函数其实是同一个函数。</p>
</blockquote>
<p>输出：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">matrix([[1, 1],</span><br><span class="line">        [2, 2],</span><br><span class="line">        [3, 3]])</span><br></pre></td></tr></table></figure>
<p>代码：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">m1 * m2</span><br></pre></td></tr></table></figure>
<p>输出：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">matrix([[14, 14],</span><br><span class="line">        [32, 32]])</span><br></pre></td></tr></table></figure>
<blockquote>
<p><strong>说明</strong>：注意<code>matrix</code>对象和<code>ndarray</code>对象乘法运算的差别，<code>matrix</code>对象的<code>*</code>运算是矩阵乘法运算。如果两个二维数组要做矩阵乘法运算，应该使用<code>@</code>运算符或<code>matmul</code>函数，而不是<code>*</code>运算符。</p>
</blockquote>
<p>矩阵对象的属性如下表所示。</p>
<table>
<thead>
<tr>
<th>属性</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>A</code></td>
<td>获取矩阵对象对应的<code>ndarray</code>对象</td>
</tr>
<tr>
<td><code>A1</code></td>
<td>获取矩阵对象对应的扁平化后的<code>ndarray</code>对象</td>
</tr>
<tr>
<td><code>I</code></td>
<td>可逆矩阵的逆矩阵</td>
</tr>
<tr>
<td><code>T</code></td>
<td>矩阵的转置</td>
</tr>
<tr>
<td><code>H</code></td>
<td>矩阵的共轭转置</td>
</tr>
<tr>
<td><code>shape</code></td>
<td>矩阵的形状</td>
</tr>
<tr>
<td><code>size</code></td>
<td>矩阵元素的个数</td>
</tr>
</tbody>
</table>
<p>矩阵对象的方法跟之前讲过的<code>ndarray</code>数组对象的方法基本差不多，此处不再进行赘述。</p>
<h3 id="线性代数模块"><a class="markdownIt-Anchor" href="#线性代数模块"></a> 线性代数模块</h3>
<p>NumPy 的<code>linalg</code>模块中有一组标准的矩阵分解运算以及诸如求逆和行列式之类的函数，它们跟 MATLAB 和 R 等语言所使用的是相同的行业标准线性代数库，下面的表格列出了<code>numpy</code>以及<code>linalg</code>模块中一些常用的线性代数相关函数。</p>
<table>
<thead>
<tr>
<th>函数</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>diag</code></td>
<td>以一维数组的形式返回方阵的对角线元素或将一维数组转换为方阵（非对角元素元素为0）</td>
</tr>
<tr>
<td><code>matmul</code></td>
<td>矩阵乘法运算</td>
</tr>
<tr>
<td><code>trace</code></td>
<td>计算对角线元素的和</td>
</tr>
<tr>
<td><code>norm</code></td>
<td>求矩阵或向量的范数</td>
</tr>
<tr>
<td><code>det</code></td>
<td>计算行列式的值</td>
</tr>
<tr>
<td><code>matrix_rank</code></td>
<td>计算矩阵的秩</td>
</tr>
<tr>
<td><code>eig</code></td>
<td>计算矩阵的特征值（<em>eigenvalue</em>）和特征向量（<em>eigenvector</em>）</td>
</tr>
<tr>
<td><code>inv</code></td>
<td>计算非奇异矩阵（ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathsize="0.9em"><mi>n</mi></mstyle></mrow><annotation encoding="application/x-tex">\small{n}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.387504em;vertical-align:0em;"></span><span class="mord sizing reset-size6 size5"><span class="mord mathnormal">n</span></span></span></span></span> 阶方阵）的逆矩阵</td>
</tr>
<tr>
<td><code>pinv</code></td>
<td>计算矩阵的摩尔-彭若斯（<em>Moore-Penrose</em>）广义逆</td>
</tr>
<tr>
<td><code>qr</code></td>
<td>QR分解（把矩阵分解成一个正交矩阵与一个上三角矩阵的积）</td>
</tr>
<tr>
<td><code>svd</code></td>
<td>计算奇异值分解（<em>singular value decomposition</em>）</td>
</tr>
<tr>
<td><code>solve</code></td>
<td>解线性方程组 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathsize="0.9em"><mrow><mi><mrow><mi mathvariant="bold-italic">A</mi><mi mathvariant="bold-italic">x</mi></mrow></mi><mo>=</mo><mi mathvariant="bold-italic">b</mi></mrow></mstyle></mrow><annotation encoding="application/x-tex">\small{\boldsymbol{Ax}=\boldsymbol{b}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.624996em;vertical-align:0em;"></span><span class="mord sizing reset-size6 size5"><span class="mord"><span class="mord"><span class="mord boldsymbol">A</span><span class="mord boldsymbol">x</span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord"><span class="mord"><span class="mord boldsymbol">b</span></span></span></span></span></span></span>，其中 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathsize="0.9em"><mi mathvariant="bold-italic">A</mi></mstyle></mrow><annotation encoding="application/x-tex">\small{\boldsymbol{A}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.617499em;vertical-align:0em;"></span><span class="mord sizing reset-size6 size5"><span class="mord"><span class="mord"><span class="mord boldsymbol">A</span></span></span></span></span></span></span> 是一个方阵</td>
</tr>
<tr>
<td><code>lstsq</code></td>
<td>计算 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathsize="0.9em"><mrow><mi><mrow><mi mathvariant="bold-italic">A</mi><mi mathvariant="bold-italic">x</mi></mrow></mi><mo>=</mo><mi mathvariant="bold-italic">b</mi></mrow></mstyle></mrow><annotation encoding="application/x-tex">\small{\boldsymbol{Ax}=\boldsymbol{b}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.624996em;vertical-align:0em;"></span><span class="mord sizing reset-size6 size5"><span class="mord"><span class="mord"><span class="mord boldsymbol">A</span><span class="mord boldsymbol">x</span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord"><span class="mord"><span class="mord boldsymbol">b</span></span></span></span></span></span></span> 的最小二乘解</td>
</tr>
</tbody>
</table>
<p>下面我们简单尝试一下上面的函数，先试一试求逆矩阵。</p>
<p>代码：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">m3 = np.array([[<span class="number">1.</span>, <span class="number">2.</span>], [<span class="number">3.</span>, <span class="number">4.</span>]])</span><br><span class="line">m4 = np.linalg.inv(m3)</span><br><span class="line">m4</span><br></pre></td></tr></table></figure>
<p>输出：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">array([[-2. ,  1. ],</span><br><span class="line">       [ 1.5, -0.5]])</span><br></pre></td></tr></table></figure>
<p>代码：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">np.around(m3 @ m4)</span><br></pre></td></tr></table></figure>
<blockquote>
<p><strong>说明</strong>：<code>around</code>函数对数组元素进行四舍五入操作，默认小数点后面的位数为0。</p>
</blockquote>
<p>输出：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">array([[1., 0.],</span><br><span class="line">       [0., 1.]])</span><br></pre></td></tr></table></figure>
<blockquote>
<p><strong>说明</strong>：矩阵和它的逆矩阵做矩阵乘法会得到单位矩阵。</p>
</blockquote>
<p>计算行列式的值。</p>
<p>代码：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">m5 = np.array([[<span class="number">1</span>, <span class="number">3</span>, <span class="number">5</span>], [<span class="number">2</span>, <span class="number">4</span>, <span class="number">6</span>], [<span class="number">4</span>, <span class="number">7</span>, <span class="number">9</span>]])</span><br><span class="line">np.linalg.det(m5)</span><br></pre></td></tr></table></figure>
<p>输出：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">2</span><br></pre></td></tr></table></figure>
<p>计算矩阵的秩。</p>
<p>代码：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">np.linalg.matrix_rank(m5)</span><br></pre></td></tr></table></figure>
<p>输出：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">3</span><br></pre></td></tr></table></figure>
<p>求解线性方程组。</p>
<p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mo fence="true">{</mo><mtable rowspacing="0.3599999999999999em" columnalign="left left" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><msub><mi>x</mi><mn>1</mn></msub><mo>+</mo><mn>2</mn><msub><mi>x</mi><mn>2</mn></msub><mo>+</mo><msub><mi>x</mi><mn>3</mn></msub><mo>=</mo><mn>8</mn></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mn>3</mn><msub><mi>x</mi><mn>1</mn></msub><mo>+</mo><mn>7</mn><msub><mi>x</mi><mn>2</mn></msub><mo>+</mo><mn>2</mn><msub><mi>x</mi><mn>3</mn></msub><mo>=</mo><mn>23</mn></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mn>2</mn><msub><mi>x</mi><mn>1</mn></msub><mo>+</mo><mn>2</mn><msub><mi>x</mi><mn>2</mn></msub><mo>+</mo><msub><mi>x</mi><mn>3</mn></msub><mo>=</mo><mn>9</mn></mrow></mstyle></mtd></mtr></mtable></mrow><annotation encoding="application/x-tex">\begin{cases}
x_1 + 2x_2 + x_3 = 8 \\\\
3x_1 + 7x_2 + 2x_3 = 23 \\\\
2x_1 + 2x_2 + x_3 = 9
\end{cases}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:7.2000399999999996em;vertical-align:-3.3500199999999998em;"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.85002em;"><span style="top:-0.6999900000000001em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎩</span></span></span><span style="top:-0.6949900000000002em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:-0.9899900000000001em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:-1.2849900000000003em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:-1.5799900000000004em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:-1.8749900000000006em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:-2.1699900000000008em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:-2.2049900000000004em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:-3.1500100000000004em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎨</span></span></span><span style="top:-4.29501em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:-4.59001em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:-4.885010000000001em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:-5.180010000000001em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:-5.475010000000001em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:-5.770010000000001em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:-5.80501em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:-6.10002em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎧</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:3.3500199999999998em;"><span></span></span></span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.8500000000000005em;"><span style="top:-5.850000000000001em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord">2</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord">8</span></span></span><span style="top:-4.410000000000001em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"></span></span><span style="top:-2.9700000000000006em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord">3</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord">7</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord">2</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord">2</span><span class="mord">3</span></span></span><span style="top:-1.5300000000000002em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"></span></span><span style="top:-0.08999999999999997em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord">2</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord">2</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord">9</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:3.35em;"><span></span></span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p>
<p>对于上面的线性方程组，我们可以用矩阵的形式来表示它，如下所示。</p>
<p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi mathvariant="bold-italic">A</mi><mo>=</mo><mrow><mo fence="true">[</mo><mtable rowspacing="0.15999999999999992em" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>1</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>2</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>1</mn></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>3</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>7</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>2</mn></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>2</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>2</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>1</mn></mstyle></mtd></mtr></mtable><mo fence="true">]</mo></mrow><mo separator="true">,</mo><mspace width="1em"/><mi mathvariant="bold-italic">x</mi><mo>=</mo><mrow><mo fence="true">[</mo><mtable rowspacing="0.15999999999999992em" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi>x</mi><mn>1</mn></msub></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi>x</mi><mn>2</mn></msub></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi>x</mi><mn>3</mn></msub></mstyle></mtd></mtr></mtable><mo fence="true">]</mo></mrow><mo separator="true">,</mo><mspace width="1em"/><mi mathvariant="bold-italic">b</mi><mo>=</mo><mrow><mo fence="true">[</mo><mtable rowspacing="0.15999999999999992em" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>8</mn></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>23</mn></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>9</mn></mstyle></mtd></mtr></mtable><mo fence="true">]</mo></mrow></mrow><annotation encoding="application/x-tex">\boldsymbol{A} = \begin{bmatrix}
1 &amp; 2 &amp; 1 \\\\
3 &amp; 7 &amp; 2 \\\\
2 &amp; 2 &amp; 1
\end{bmatrix}, \quad
\boldsymbol{x} = \begin{bmatrix}
x_1 \\\\
x_2 \\\\
x_3
\end{bmatrix}, \quad
\boldsymbol{b} = \begin{bmatrix}
8 \\\\
23 \\\\
9
\end{bmatrix}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68611em;vertical-align:0em;"></span><span class="mord"><span class="mord"><span class="mord boldsymbol">A</span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:6.00503em;vertical-align:-2.75004em;"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.2549900000000003em;"><span style="top:-1.0499800000000006em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>⎣</span></span></span><span style="top:-2.1999800000000005em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>⎢</span></span></span><span style="top:-2.79598em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>⎢</span></span></span><span style="top:-3.39198em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>⎢</span></span></span><span style="top:-3.9879800000000003em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>⎢</span></span></span><span style="top:-4.0139700000000005em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>⎢</span></span></span><span style="top:-5.25499em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>⎡</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.75004em;"><span></span></span></span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.2500000000000004em;"><span style="top:-5.410000000000001em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span><span style="top:-4.21em;"><span class="pstrut" style="height:3em;"></span><span class="mord"></span></span><span style="top:-3.01em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">3</span></span></span><span style="top:-1.8099999999999998em;"><span class="pstrut" style="height:3em;"></span><span class="mord"></span></span><span style="top:-0.6099999999999997em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.7500000000000004em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.2500000000000004em;"><span style="top:-5.410000000000001em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">2</span></span></span><span style="top:-3.0100000000000002em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">7</span></span></span><span style="top:-0.6100000000000001em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.75em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.2500000000000004em;"><span style="top:-5.410000000000001em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span><span style="top:-3.0100000000000002em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">2</span></span></span><span style="top:-0.6100000000000001em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.75em;"><span></span></span></span></span></span></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.2549900000000003em;"><span style="top:-1.0499800000000006em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>⎦</span></span></span><span style="top:-2.1999800000000005em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>⎥</span></span></span><span style="top:-2.79598em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>⎥</span></span></span><span style="top:-3.39198em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>⎥</span></span></span><span style="top:-3.9879800000000003em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>⎥</span></span></span><span style="top:-4.0139700000000005em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>⎥</span></span></span><span style="top:-5.25499em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>⎤</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.75004em;"><span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:1em;"></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord"><span class="mord boldsymbol">x</span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:6.00503em;vertical-align:-2.75004em;"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.2549900000000003em;"><span style="top:-1.0499800000000006em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>⎣</span></span></span><span style="top:-2.1999800000000005em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>⎢</span></span></span><span style="top:-2.79598em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>⎢</span></span></span><span style="top:-3.39198em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>⎢</span></span></span><span style="top:-3.9879800000000003em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>⎢</span></span></span><span style="top:-4.0139700000000005em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>⎢</span></span></span><span style="top:-5.25499em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>⎡</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.75004em;"><span></span></span></span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.2500000000000004em;"><span style="top:-5.410000000000001em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-4.21em;"><span class="pstrut" style="height:3em;"></span><span class="mord"></span></span><span style="top:-3.01em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-1.8099999999999998em;"><span class="pstrut" style="height:3em;"></span><span class="mord"></span></span><span style="top:-0.6099999999999997em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.7500000000000004em;"><span></span></span></span></span></span></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.2549900000000003em;"><span style="top:-1.0499800000000006em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>⎦</span></span></span><span style="top:-2.1999800000000005em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>⎥</span></span></span><span style="top:-2.79598em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>⎥</span></span></span><span style="top:-3.39198em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>⎥</span></span></span><span style="top:-3.9879800000000003em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>⎥</span></span></span><span style="top:-4.0139700000000005em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>⎥</span></span></span><span style="top:-5.25499em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>⎤</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.75004em;"><span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:1em;"></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord"><span class="mord boldsymbol">b</span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:6.00503em;vertical-align:-2.75004em;"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.2549900000000003em;"><span style="top:-1.0499800000000006em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>⎣</span></span></span><span style="top:-2.1999800000000005em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>⎢</span></span></span><span style="top:-2.79598em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>⎢</span></span></span><span style="top:-3.39198em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>⎢</span></span></span><span style="top:-3.9879800000000003em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>⎢</span></span></span><span style="top:-4.0139700000000005em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>⎢</span></span></span><span style="top:-5.25499em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>⎡</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.75004em;"><span></span></span></span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.2500000000000004em;"><span style="top:-5.410000000000001em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">8</span></span></span><span style="top:-4.21em;"><span class="pstrut" style="height:3em;"></span><span class="mord"></span></span><span style="top:-3.01em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">2</span><span class="mord">3</span></span></span><span style="top:-1.8099999999999998em;"><span class="pstrut" style="height:3em;"></span><span class="mord"></span></span><span style="top:-0.6099999999999997em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">9</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.7500000000000004em;"><span></span></span></span></span></span></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.2549900000000003em;"><span style="top:-1.0499800000000006em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>⎦</span></span></span><span style="top:-2.1999800000000005em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>⎥</span></span></span><span style="top:-2.79598em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>⎥</span></span></span><span style="top:-3.39198em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>⎥</span></span></span><span style="top:-3.9879800000000003em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>⎥</span></span></span><span style="top:-4.0139700000000005em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>⎥</span></span></span><span style="top:-5.25499em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>⎤</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.75004em;"><span></span></span></span></span></span></span></span></span></span></span></span></p>
<p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi><mrow><mi mathvariant="bold-italic">A</mi><mi mathvariant="bold-italic">x</mi></mrow></mi><mo>=</mo><mi mathvariant="bold-italic">b</mi></mrow><annotation encoding="application/x-tex">\boldsymbol{Ax} = \boldsymbol{b}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68611em;vertical-align:0em;"></span><span class="mord"><span class="mord"><span class="mord boldsymbol">A</span><span class="mord boldsymbol">x</span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord"><span class="mord"><span class="mord boldsymbol">b</span></span></span></span></span></span></span></p>
<p>线性方程组有唯一解的条件：系数矩阵 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathsize="0.9em"><mi mathvariant="bold-italic">A</mi></mstyle></mrow><annotation encoding="application/x-tex">\small{\boldsymbol{A}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.617499em;vertical-align:0em;"></span><span class="mord sizing reset-size6 size5"><span class="mord"><span class="mord"><span class="mord boldsymbol">A</span></span></span></span></span></span></span> 的秩等于增广矩阵 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathsize="0.9em"><mi><mrow><mi mathvariant="bold-italic">A</mi><mi mathvariant="bold-italic">b</mi></mrow></mi></mstyle></mrow><annotation encoding="application/x-tex">\small{\boldsymbol{Ab}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.624996em;vertical-align:0em;"></span><span class="mord sizing reset-size6 size5"><span class="mord"><span class="mord"><span class="mord boldsymbol">A</span><span class="mord boldsymbol">b</span></span></span></span></span></span></span> 的秩，而且跟未知数的个数相同。</p>
<p>代码：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">A = np.array([[<span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>], [<span class="number">3</span>, <span class="number">7</span>, <span class="number">2</span>], [<span class="number">2</span>, <span class="number">2</span>, <span class="number">1</span>]])</span><br><span class="line">b = np.array([<span class="number">8</span>, <span class="number">23</span>, <span class="number">9</span>]).reshape(-<span class="number">1</span>, <span class="number">1</span>)</span><br><span class="line"><span class="built_in">print</span>(np.linalg.matrix_rank(A))</span><br><span class="line"><span class="built_in">print</span>(np.linalg.matrix_rank(np.hstack((A, b))))</span><br></pre></td></tr></table></figure>
<blockquote>
<p><strong>说明</strong>：使用数组对象的<code>reshape</code>方法调形时，如果其中一个参数为-1，那么该维度有多少个元素是通过数组元素个数（<code>size</code>属性）和其他维度的元素个数自动计算出来的。</p>
</blockquote>
<p>输出：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">3</span><br><span class="line">3</span><br></pre></td></tr></table></figure>
<p>代码：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">np.linalg.solve(A, b)</span><br></pre></td></tr></table></figure>
<p>输出：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">array([[1.],</span><br><span class="line">       [2.],</span><br><span class="line">       [3.]])</span><br></pre></td></tr></table></figure>
<blockquote>
<p><strong>说明</strong>：上面的结果表示，线性方程组的解为： <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathsize="0.9em"><mrow><msub><mi>x</mi><mn>1</mn></msub><mo>=</mo><mn>1</mn><mo separator="true">,</mo><msub><mi>x</mi><mn>2</mn></msub><mo>=</mo><mn>2</mn><mo separator="true">,</mo><msub><mi>x</mi><mn>3</mn></msub><mo>=</mo><mn>3</mn></mrow></mstyle></mrow><annotation encoding="application/x-tex">\small{x_1 = 1, x_2 = 2, x_3 = 3}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7549920000000001em;vertical-align:-0.174996em;"></span><span class="mord sizing reset-size6 size5"><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2796266666666667em;"><span style="top:-2.45em;margin-left:0em;margin-right:0.05555555555555556em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2796266666666667em;"><span style="top:-2.45em;margin-left:0em;margin-right:0.05555555555555556em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord">2</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2796266666666667em;"><span style="top:-2.45em;margin-left:0em;margin-right:0.05555555555555556em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord">3</span></span></span></span></span> 。</p>
</blockquote>
<p>下面是另一种求解线性方程组的方法，大家可以停下来思考下为什么。</p>
<p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi mathvariant="bold-italic">x</mi><mo>=</mo><msup><mi mathvariant="bold-italic">A</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><mo>⋅</mo><mi mathvariant="bold-italic">b</mi></mrow><annotation encoding="application/x-tex">\boldsymbol{x} = \boldsymbol{A}^{-1} \cdot \boldsymbol{b}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.44444em;vertical-align:0em;"></span><span class="mord"><span class="mord"><span class="mord boldsymbol">x</span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.890118em;vertical-align:0em;"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord boldsymbol">A</span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.890118em;"><span style="top:-3.13901em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord"><span class="mord"><span class="mord boldsymbol">b</span></span></span></span></span></span></span></p>
<p>代码：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">np.linalg.inv(A) @ b</span><br></pre></td></tr></table></figure>
<p>输出：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">array([[1.],</span><br><span class="line">       [2.],</span><br><span class="line">       [3.]])</span><br></pre></td></tr></table></figure>
<h3 id="多项式"><a class="markdownIt-Anchor" href="#多项式"></a> 多项式</h3>
<p>除了数组，NumPy 中还封装了用于<strong>多项式</strong>（<em>polynomial</em>）运算的数据类型。多项式是变量的整数次幂与系数的乘积之和，形如：</p>
<p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><msub><mi>a</mi><mi>n</mi></msub><msup><mi>x</mi><mi>n</mi></msup><mo>+</mo><msub><mi>a</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msub><msup><mi>x</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msup><mo>+</mo><mo>⋯</mo><mo>+</mo><msub><mi>a</mi><mn>1</mn></msub><msup><mi>x</mi><mn>1</mn></msup><mo>+</mo><msub><mi>a</mi><mn>0</mn></msub><msup><mi>x</mi><mn>0</mn></msup></mrow><annotation encoding="application/x-tex">f(x)=a_nx^n + a_{n-1}x^{n-1} + \cdots + a_1x^{1} + a_0x^{0}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.8643919999999999em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7143919999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.072439em;vertical-align:-0.208331em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.301108em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.208331em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.864108em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.66666em;vertical-align:-0.08333em;"></span><span class="minner">⋯</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.0141079999999998em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641079999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.0141079999999998em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641079999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">0</span></span></span></span></span></span></span></span></span></span></span></span></span></p>
<p>在 NumPy 1.4版本之前，我们可以用<code>poly1d</code>类型来表示多项式，目前它仍然可用，但是官方提供了新的模块<code>numpy.polynomial</code>，它除了支持基本的幂级数多项式外，还可以支持切比雪夫多项式、拉盖尔多项式等。</p>
<h4 id="创建多项式对象"><a class="markdownIt-Anchor" href="#创建多项式对象"></a> 创建多项式对象</h4>
<p>创建<code>poly1d</code>对象，例如： <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathsize="0.9em"><mrow><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><mn>3</mn><msup><mi>x</mi><mn>2</mn></msup><mo>+</mo><mn>2</mn><mi>x</mi><mo>+</mo><mn>1</mn></mrow></mstyle></mrow><annotation encoding="application/x-tex">\small{f(x)=3x^{2}+2x+1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.938364em;vertical-align:-0.225em;"></span><span class="mord sizing reset-size6 size5"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord">3</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7926266666666666em;"><span style="top:-2.963em;margin-right:0.05555555555555556em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord">2</span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord">1</span></span></span></span></span> 。</p>
<p>代码：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">p1 = np.poly1d([<span class="number">3</span>, <span class="number">2</span>, <span class="number">1</span>])</span><br><span class="line">p2 = np.poly1d([<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>])</span><br><span class="line"><span class="built_in">print</span>(p1)</span><br><span class="line"><span class="built_in">print</span>(p2)</span><br></pre></td></tr></table></figure>
<p>输出：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">   2</span><br><span class="line">3 x + 2 x + 1</span><br><span class="line">   2</span><br><span class="line">1 x + 2 x + 3</span><br></pre></td></tr></table></figure>
<h4 id="多项式的操作"><a class="markdownIt-Anchor" href="#多项式的操作"></a> 多项式的操作</h4>
<p><strong>获取多项式的系数</strong></p>
<p>代码：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(p1.coefficients)</span><br><span class="line"><span class="built_in">print</span>(p2.coeffs)</span><br></pre></td></tr></table></figure>
<p>输出：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[3 2 1]</span><br><span class="line">[1 2 3]</span><br></pre></td></tr></table></figure>
<p><strong>两个多项式的四则运算</strong></p>
<p>代码：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(p1 + p2)</span><br><span class="line"><span class="built_in">print</span>(p1 * p2)</span><br></pre></td></tr></table></figure>
<p>输出：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">   2</span><br><span class="line">4 x + 4 x + 4</span><br><span class="line">   4     3      2</span><br><span class="line">3 x + 8 x + 14 x + 8 x + 3</span><br></pre></td></tr></table></figure>
<p><strong>带入 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathsize="0.9em"><mi>x</mi></mstyle></mrow><annotation encoding="application/x-tex">\small{x}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.387504em;vertical-align:0em;"></span><span class="mord sizing reset-size6 size5"><span class="mord mathnormal">x</span></span></span></span></span> 求多项式的值</strong></p>
<p>代码：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(p1(<span class="number">3</span>))</span><br><span class="line"><span class="built_in">print</span>(p2(<span class="number">3</span>))</span><br></pre></td></tr></table></figure>
<p>输出：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">34</span><br><span class="line">18</span><br></pre></td></tr></table></figure>
<p><strong>多项式求导和不定积分</strong></p>
<p>代码：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(p1.deriv())</span><br><span class="line"><span class="built_in">print</span>(p1.integ())</span><br></pre></td></tr></table></figure>
<p>输出：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">6 x + 2</span><br><span class="line">   3     2</span><br><span class="line">1 x + 1 x + 1 x</span><br></pre></td></tr></table></figure>
<p><strong>求多项式的根</strong></p>
<p>例如有多项式 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathsize="0.9em"><mrow><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><msup><mi>x</mi><mn>2</mn></msup><mo>+</mo><mn>3</mn><mi>x</mi><mo>+</mo><mn>2</mn></mrow></mstyle></mrow><annotation encoding="application/x-tex">\small{f(x)=x^2+3x+2}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.938364em;vertical-align:-0.225em;"></span><span class="mord sizing reset-size6 size5"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7926266666666666em;"><span style="top:-2.963em;margin-right:0.05555555555555556em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord">3</span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord">2</span></span></span></span></span> ，多项式的根即一元二次方程 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathsize="0.9em"><mrow><msup><mi>x</mi><mn>2</mn></msup><mo>+</mo><mn>3</mn><mi>x</mi><mo>+</mo><mn>2</mn><mo>=</mo><mn>0</mn></mrow></mstyle></mrow><annotation encoding="application/x-tex">\small{x^2+3x+2=0}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.788361em;vertical-align:-0.07499700000000001em;"></span><span class="mord sizing reset-size6 size5"><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7926266666666666em;"><span style="top:-2.963em;margin-right:0.05555555555555556em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord">3</span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord">2</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord">0</span></span></span></span></span> 的解。</p>
<p>代码：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">p3 = np.poly1d([<span class="number">1</span>, <span class="number">3</span>, <span class="number">2</span>])</span><br><span class="line"><span class="built_in">print</span>(p3.roots)</span><br></pre></td></tr></table></figure>
<p>输出：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[-2. -1.]</span><br></pre></td></tr></table></figure>
<p>如果使用<code>numpy.polynomial</code>模块的<code>Polynomial</code>类来表示多项式对象，那么对应的操作如下所示。</p>
<p>代码：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> numpy.polynomial <span class="keyword">import</span> Polynomial</span><br><span class="line"></span><br><span class="line">p3 = Polynomial((<span class="number">2</span>, <span class="number">3</span>, <span class="number">1</span>))</span><br><span class="line"><span class="built_in">print</span>(p3)           <span class="comment"># 输出多项式</span></span><br><span class="line"><span class="built_in">print</span>(p3(<span class="number">3</span>))        <span class="comment"># 令x=3，计算多项式的值</span></span><br><span class="line"><span class="built_in">print</span>(p3.roots())   <span class="comment"># 计算多项式的根</span></span><br><span class="line"><span class="built_in">print</span>(p3.degree())  <span class="comment"># 获得多项式的次数</span></span><br><span class="line"><span class="built_in">print</span>(p3.deriv())   <span class="comment"># 求导</span></span><br><span class="line"><span class="built_in">print</span>(p3.integ())   <span class="comment"># 求不定积分</span></span><br></pre></td></tr></table></figure>
<p>输出：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">2.0 + 3.0·x + 1.0·x²</span><br><span class="line">20.0</span><br><span class="line">[-2. -1.]</span><br><span class="line">2</span><br><span class="line">3.0 + 2.0·x</span><br><span class="line">0.0 + 2.0·x + 1.5·x² + 0.33333333·x³</span><br></pre></td></tr></table></figure>
<h3 id="最小二乘解"><a class="markdownIt-Anchor" href="#最小二乘解"></a> 最小二乘解</h3>
<p><code>Polynomial</code>类还有一个名为<code>fit</code>的类方法，它可以给多项式求最小二乘解。所谓最小二乘解（least-squares solution），是用最小二乘法通过最小化误差的平方和来寻找数据的最佳匹配函数的系数。假设多项式为 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathsize="0.9em"><mrow><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><mi>a</mi><mi>x</mi><mo>+</mo><mi>b</mi></mrow></mstyle></mrow><annotation encoding="application/x-tex">\small{f(x)=ax+b}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9em;vertical-align:-0.225em;"></span><span class="mord sizing reset-size6 size5"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord mathnormal">a</span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathnormal">b</span></span></span></span></span> ，最小二乘解就是让下面的残差平方和 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathsize="0.9em"><mrow><mi>R</mi><mi>S</mi><mi>S</mi></mrow></mstyle></mrow><annotation encoding="application/x-tex">\small{RSS}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.614997em;vertical-align:0em;"></span><span class="mord sizing reset-size6 size5"><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span></span></span></span></span> 达到最小的 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathsize="0.9em"><mi>a</mi></mstyle></mrow><annotation encoding="application/x-tex">\small{a}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.387504em;vertical-align:0em;"></span><span class="mord sizing reset-size6 size5"><span class="mord mathnormal">a</span></span></span></span></span> 和 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathsize="0.9em"><mi>b</mi></mstyle></mrow><annotation encoding="application/x-tex">\small{b}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.624996em;vertical-align:0em;"></span><span class="mord sizing reset-size6 size5"><span class="mord mathnormal">b</span></span></span></span></span>。</p>
<p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>R</mi><mi>S</mi><mi>S</mi><mo>=</mo><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>0</mn></mrow><mi>k</mi></munderover><mrow><mo stretchy="false">(</mo><mi>f</mi><mo stretchy="false">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo stretchy="false">)</mo><mo>−</mo><msub><mi>y</mi><mi>i</mi></msub><msup><mo stretchy="false">)</mo><mn>2</mn></msup></mrow></mrow><annotation encoding="application/x-tex">RSS = \sum_{i=0}^{k}{(f(x_i) - y_i)^{2}}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:3.1137820000000005em;vertical-align:-1.277669em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.8361130000000003em;"><span style="top:-1.872331em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">0</span></span></span></span><span style="top:-3.050005em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3000050000000005em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.277669em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641079999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span></span></span></span></p>
<p>例如，我们想利用收集到的月收入和网购支出的历史数据来建立一个预测模型，以达到通过某人的月收入预测他网购支出金额的目标，下面是我们收集到的收入和网购支出的数据，保存在两个数组中。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">x = np.array([</span><br><span class="line">    <span class="number">25000</span>, <span class="number">15850</span>, <span class="number">15500</span>, <span class="number">20500</span>, <span class="number">22000</span>, <span class="number">20010</span>, <span class="number">26050</span>, <span class="number">12500</span>, <span class="number">18500</span>, <span class="number">27300</span>,</span><br><span class="line">    <span class="number">15000</span>,  <span class="number">8300</span>, <span class="number">23320</span>,  <span class="number">5250</span>,  <span class="number">5800</span>,  <span class="number">9100</span>,  <span class="number">4800</span>, <span class="number">16000</span>, <span class="number">28500</span>, <span class="number">32000</span>,</span><br><span class="line">    <span class="number">31300</span>, <span class="number">10800</span>,  <span class="number">6750</span>,  <span class="number">6020</span>, <span class="number">13300</span>, <span class="number">30020</span>,  <span class="number">3200</span>, <span class="number">17300</span>,  <span class="number">8835</span>,  <span class="number">3500</span></span><br><span class="line">])</span><br><span class="line">y = np.array([</span><br><span class="line">    <span class="number">2599</span>, <span class="number">1400</span>, <span class="number">1120</span>, <span class="number">2560</span>, <span class="number">1900</span>, <span class="number">1200</span>, <span class="number">2320</span>,  <span class="number">800</span>, <span class="number">1650</span>, <span class="number">2200</span>,</span><br><span class="line">     <span class="number">980</span>,  <span class="number">580</span>, <span class="number">1885</span>,  <span class="number">600</span>,  <span class="number">400</span>,  <span class="number">800</span>,  <span class="number">420</span>, <span class="number">1380</span>, <span class="number">1980</span>, <span class="number">3999</span>,</span><br><span class="line">    <span class="number">3800</span>,  <span class="number">725</span>,  <span class="number">520</span>,  <span class="number">420</span>, <span class="number">1200</span>, <span class="number">4020</span>,  <span class="number">350</span>, <span class="number">1500</span>,  <span class="number">560</span>,  <span class="number">500</span></span><br><span class="line">])</span><br></pre></td></tr></table></figure>
<p>我们可以先绘制散点图来了解两组数据是否具有正相关或负相关关系。正相关意味着数组<code>x</code>中较大的值对应到数组<code>y</code>中也是较大的值，而负相关则意味着数组<code>x</code>中较大的值对应到数组<code>y</code>中较小的值。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"></span><br><span class="line">plt.figure(dpi=<span class="number">120</span>)</span><br><span class="line">plt.scatter(x, y, color=<span class="string">&#x27;blue&#x27;</span>)</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>
<p>输出：</p>
<img src="/images/in_out_scatter_plot.png" style="zoom:50%;">
<p>如果需要定量的研究两组数据的相关性，我们可以计算协方差或相关系数，对应的 NumPy 函数分别是<code>cov</code>和<code>corrcoef</code>。</p>
<p>代码：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">np.corrcoef(x, y)</span><br></pre></td></tr></table></figure>
<p>输出：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">array([[1.        , 0.92275889],</span><br><span class="line">       [0.92275889, 1.        ]])</span><br></pre></td></tr></table></figure>
<blockquote>
<p><strong>说明</strong>：相关系数是一个<code>-1</code>到<code>1</code>之间的值，越靠近<code>1</code> 说明正相关性越强，越靠近<code>-1</code>说明负相关性越强，靠近<code>0</code>则说明两组数据没有明显的相关性。上面月收入和网购支出之间的相关系数是<code>0.92275889</code>，说明二者是强正相关关系。</p>
</blockquote>
<p>通过上面的操作，我们确定了收入和网购支出之前存在强正相关关系，于是我们用这些数据来创建一个回归模型，找出一条能够很好的拟合这些数据点的直线。这里，我们就可以用到上面提到的<code>fit</code>方法，具体的代码如下所示。</p>
<p>代码：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> numpy.polynomial <span class="keyword">import</span> Polynomial</span><br><span class="line"></span><br><span class="line">Polynomial.fit(x, y, deg=<span class="number">1</span>).convert().coef</span><br></pre></td></tr></table></figure>
<blockquote>
<p><strong>说明</strong>：<code>deg=1</code>说明回归模型最高次项就是1次项，回归模型形如 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathsize="0.9em"><mrow><mi>y</mi><mo>=</mo><mi>a</mi><mi>x</mi><mo>+</mo><mi>b</mi></mrow></mstyle></mrow><annotation encoding="application/x-tex">\small{y=ax+b}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.799992em;vertical-align:-0.174996em;"></span><span class="mord sizing reset-size6 size5"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord mathnormal">a</span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathnormal">b</span></span></span></span></span> ；如果要生一个类似于 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathsize="0.9em"><mrow><mi>y</mi><mo>=</mo><mi>a</mi><msup><mi>x</mi><mn>2</mn></msup><mo>+</mo><mi>b</mi><mi>x</mi><mo>+</mo><mi>c</mi></mrow></mstyle></mrow><annotation encoding="application/x-tex">\small{y=ax^2+bx+c}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.88836em;vertical-align:-0.174996em;"></span><span class="mord sizing reset-size6 size5"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord mathnormal">a</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7926266666666666em;"><span style="top:-2.963em;margin-right:0.05555555555555556em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathnormal">b</span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathnormal">c</span></span></span></span></span> 的模型，就需要设置<code>deg=2</code>，以此类推。</p>
</blockquote>
<p>输出：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">array([-2.94883437e+02,  1.10333716e-01])</span><br></pre></td></tr></table></figure>
<p>根据上面输出的结果，我们的回归方程应该是 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathsize="0.9em"><mrow><mi>y</mi><mo>=</mo><mn>0.110333716</mn><mi>x</mi><mo>−</mo><mn>294.883437</mn></mrow></mstyle></mrow><annotation encoding="application/x-tex">\small{y=0.110333716x-294.883437}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7549920000000001em;vertical-align:-0.174996em;"></span><span class="mord sizing reset-size6 size5"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord">0</span><span class="mord">.</span><span class="mord">1</span><span class="mord">1</span><span class="mord">0</span><span class="mord">3</span><span class="mord">3</span><span class="mord">3</span><span class="mord">7</span><span class="mord">1</span><span class="mord">6</span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord">2</span><span class="mord">9</span><span class="mord">4</span><span class="mord">.</span><span class="mord">8</span><span class="mord">8</span><span class="mord">3</span><span class="mord">4</span><span class="mord">3</span><span class="mord">7</span></span></span></span></span> 。我们将这个回归方程绘制到刚才的散点图上，红色的点是我们的预测值，蓝色的点是历史数据，也就是真实值。</p>
<p>代码：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"></span><br><span class="line">plt.scatter(x, y, color=<span class="string">&#x27;blue&#x27;</span>)</span><br><span class="line">plt.scatter(x, <span class="number">0.110333716</span> * x - <span class="number">294.883437</span>, color=<span class="string">&#x27;red&#x27;</span>)</span><br><span class="line">plt.plot(x, <span class="number">0.110333716</span> * x - <span class="number">294.883437</span>, color=<span class="string">&#x27;darkcyan&#x27;</span>)</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>
<p>输出：</p>
<img src="/images/in_out_regression_result.png" style="zoom:50%;">
<p>如果不使用<code>Polynomial</code>类型的<code>fit</code>方法，我们也可以通过 NumPy 提供的<code>polyfit</code>函数来完成同样的操作，有兴趣的读者可以自行研究。</p>
<blockquote>
<p><strong>说明</strong>：本章部分图片来自于维基百科。</p>
</blockquote>
<h2 id="pandas"><a class="markdownIt-Anchor" href="#pandas"></a> Pandas</h2>
<p>Pandas 是 Wes McKinney 在2008年开发的一个强大的<strong>分析结构化数据</strong>的工具集。Pandas 以 NumPy 为基础（实现数据存储和运算），提供了专门用于数据分析的类型、方法和函数，对数据分析和数据挖掘提供了很好的支持；同时 pandas 还可以跟数据可视化工具 matplotlib 很好的整合在一起，非常轻松愉快的实现数据可视化呈现。</p>
<p>Pandas 核心的数据类型是<code>Series</code>（数据系列）、<code>DataFrame</code>（数据窗/数据框），分别用于处理一维和二维的数据，除此之外，还有一个名为<code>Index</code>的类型及其子类型，它们为<code>Series</code>和<code>DataFrame</code>提供了索引功能。日常工作中<code>DataFrame</code>使用得最为广泛，因为二维的数据结构刚好可以对应有行有列的表格。<code>Series</code>和<code>DataFrame</code>都提供了大量的处理数据的方法，数据分析师以此为基础，可以实现对数据的筛选、合并、拼接、清洗、预处理、聚合、透视和可视化等各种操作。</p>
<h3 id="创建series对象"><a class="markdownIt-Anchor" href="#创建series对象"></a> 创建Series对象</h3>
<p>Pandas 库中的<code>Series</code>对象可以用来表示一维数据结构，但是多了索引和一些额外的功能。<code>Series</code>类型的内部结构包含了两个数组，其中一个用来保存数据，另一个用来保存数据的索引。我们可以通过列表或数组创建<code>Series</code>对象，代码如下所示。</p>
<p>代码：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"></span><br><span class="line">ser1 = pd.Series(data=[<span class="number">120</span>, <span class="number">380</span>, <span class="number">250</span>, <span class="number">360</span>], index=[<span class="string">&#x27;一季度&#x27;</span>, <span class="string">&#x27;二季度&#x27;</span>, <span class="string">&#x27;三季度&#x27;</span>, <span class="string">&#x27;四季度&#x27;</span>])</span><br><span class="line">ser1</span><br></pre></td></tr></table></figure>
<blockquote>
<p><strong>说明</strong>：<code>Series</code>构造器中的<code>data</code>参数表示数据，<code>index</code>参数表示数据的索引，相当于数据对应的标签。</p>
</blockquote>
<p>输出：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">一季度    120</span><br><span class="line">二季度    380</span><br><span class="line">三季度    250</span><br><span class="line">四季度    360</span><br><span class="line">dtype: int64</span><br></pre></td></tr></table></figure>
<p>通过字典创建Series对象。</p>
<p>代码：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ser2 = pd.Series(&#123;<span class="string">&#x27;一季度&#x27;</span>: <span class="number">320</span>, <span class="string">&#x27;二季度&#x27;</span>: <span class="number">180</span>, <span class="string">&#x27;三季度&#x27;</span>: <span class="number">300</span>, <span class="string">&#x27;四季度&#x27;</span>: <span class="number">405</span>&#125;)</span><br><span class="line">ser2</span><br></pre></td></tr></table></figure>
<blockquote>
<p><strong>说明</strong>：通过字典创建<code>Series</code>对象时，字典的键就是数据的标签（索引），键对应的值就是数据。</p>
</blockquote>
<p>输出：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">一季度    320</span><br><span class="line">二季度    180</span><br><span class="line">三季度    300</span><br><span class="line">四季度    405</span><br><span class="line">dtype: int64</span><br></pre></td></tr></table></figure>
<h3 id="series对象的运算"><a class="markdownIt-Anchor" href="#series对象的运算"></a> Series对象的运算</h3>
<h4 id="标量运算"><a class="markdownIt-Anchor" href="#标量运算"></a> 标量运算</h4>
<p>我们尝试给刚才的<code>ser1</code>每个季度加上<code>10</code>，代码如下所示。</p>
<p>代码：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ser1 += <span class="number">10</span></span><br><span class="line">ser1</span><br></pre></td></tr></table></figure>
<p>输出：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">一季度    130</span><br><span class="line">二季度    390</span><br><span class="line">三季度    260</span><br><span class="line">四季度    370</span><br><span class="line">dtype: int64</span><br></pre></td></tr></table></figure>
<h4 id="矢量运算"><a class="markdownIt-Anchor" href="#矢量运算"></a> 矢量运算</h4>
<p>我们尝试把<code>ser1</code>和<code>ser2</code>对应季度的数据加起来，代码如下所示。</p>
<p>代码：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ser1 + ser2</span><br></pre></td></tr></table></figure>
<p>输出：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">一季度    450</span><br><span class="line">二季度    570</span><br><span class="line">三季度    560</span><br><span class="line">四季度    775</span><br><span class="line">dtype: int64</span><br></pre></td></tr></table></figure>
<h4 id="索引运算"><a class="markdownIt-Anchor" href="#索引运算"></a> 索引运算</h4>
<h5 id="普通索引"><a class="markdownIt-Anchor" href="#普通索引"></a> 普通索引</h5>
<p>跟数组一样，<code>Series</code>对象也可以进行索引和切片操作，不同的是<code>Series</code>对象因为内部维护了一个保存索引的数组，所以除了可以使用整数索引检索数据外，还可以通过自己设置的索引（标签）获取对应的数据。</p>
<p>使用整数索引。</p>
<p>代码：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ser1[2] deprecated</span></span><br><span class="line">ser1.iloc[<span class="number">2</span>] <span class="comment"># better</span></span><br></pre></td></tr></table></figure>
<p>输出：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">260</span><br></pre></td></tr></table></figure>
<p>使用自定义索引。</p>
<p>代码：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ser1[<span class="string">&#x27;三季度&#x27;</span>]</span><br></pre></td></tr></table></figure>
<p>输出：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">260</span><br></pre></td></tr></table></figure>
<p>代码：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ser1[<span class="string">&#x27;一季度&#x27;</span>] = <span class="number">380</span></span><br><span class="line">ser1</span><br></pre></td></tr></table></figure>
<p>输出：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">一季度    380</span><br><span class="line">二季度    390</span><br><span class="line">三季度    260</span><br><span class="line">四季度    370</span><br><span class="line">dtype: int64</span><br></pre></td></tr></table></figure>
<h5 id="切片索引-2"><a class="markdownIt-Anchor" href="#切片索引-2"></a> 切片索引</h5>
<p><code>Series</code>对象的切片操作跟列表、数组类似，通过给出起始和结束索引，从原来的<code>Series</code>对象中取出或修改部分数据，这里也可以使用整数索引和自定义的索引，代码如下所示。</p>
<p>代码：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ser2[<span class="number">1</span>:<span class="number">3</span>]</span><br></pre></td></tr></table></figure>
<p>输出：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">二季度    180</span><br><span class="line">三季度    300</span><br><span class="line">dtype: int64</span><br></pre></td></tr></table></figure>
<p>代码：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ser2[<span class="string">&#x27;二季度&#x27;</span>:<span class="string">&#x27;四季度&#x27;</span>]</span><br></pre></td></tr></table></figure>
<p>输出：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">二季度    180</span><br><span class="line">三季度    300</span><br><span class="line">四季度    405</span><br><span class="line">dtype: int64</span><br></pre></td></tr></table></figure>
<blockquote>
<p><strong>提示</strong>：在使用自定义索引进行切片时，结束索引对应的元素也是可以取到的。</p>
</blockquote>
<p>代码：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ser2[<span class="number">1</span>:<span class="number">3</span>] = <span class="number">400</span>, <span class="number">500</span></span><br><span class="line">ser2</span><br></pre></td></tr></table></figure>
<p>输出：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">一季度    320</span><br><span class="line">二季度    400</span><br><span class="line">三季度    500</span><br><span class="line">四季度    405</span><br><span class="line">dtype: int64</span><br></pre></td></tr></table></figure>
<h5 id="花式索引-2"><a class="markdownIt-Anchor" href="#花式索引-2"></a> 花式索引</h5>
<p>代码：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ser2[[<span class="string">&#x27;二季度&#x27;</span>, <span class="string">&#x27;四季度&#x27;</span>]]</span><br></pre></td></tr></table></figure>
<p>输出：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">二季度    400</span><br><span class="line">四季度    405</span><br><span class="line">dtype: int64</span><br></pre></td></tr></table></figure>
<p>代码：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ser2[[<span class="string">&#x27;二季度&#x27;</span>, <span class="string">&#x27;四季度&#x27;</span>]] = <span class="number">600</span>, <span class="number">520</span></span><br><span class="line">ser2</span><br></pre></td></tr></table></figure>
<p>输出：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">一季度    320</span><br><span class="line">二季度    600</span><br><span class="line">三季度    500</span><br><span class="line">四季度    520</span><br><span class="line">dtype: int64</span><br></pre></td></tr></table></figure>
<h5 id="布尔索引-2"><a class="markdownIt-Anchor" href="#布尔索引-2"></a> 布尔索引</h5>
<p>代码：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ser2[ser2 &gt;= <span class="number">500</span>]</span><br></pre></td></tr></table></figure>
<p>输出：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">二季度    600</span><br><span class="line">三季度    500</span><br><span class="line">四季度    520</span><br><span class="line">dtype: int64</span><br></pre></td></tr></table></figure>
<h3 id="series对象的属性和方法"><a class="markdownIt-Anchor" href="#series对象的属性和方法"></a> Series对象的属性和方法</h3>
<p><code>Series</code>对象的属性和方法非常多，我们就捡着重要的跟大家讲吧。先看看下面的表格，它展示了<code>Series</code>对象常用的属性。</p>
<table>
<thead>
<tr>
<th>属性</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>dtype</code> / <code>dtypes</code></td>
<td>返回<code>Series</code>对象的数据类型</td>
</tr>
<tr>
<td><code>hasnans</code></td>
<td>判断<code>Series</code>对象中有没有空值</td>
</tr>
<tr>
<td><code>at</code> / <code>iat</code></td>
<td>通过索引访问<code>Series</code>对象中的单个值</td>
</tr>
<tr>
<td><code>loc</code> / <code>iloc</code></td>
<td>通过索引访问<code>Series</code>对象中的单个值或一组值</td>
</tr>
<tr>
<td><code>index</code></td>
<td>返回<code>Series</code>对象的索引（<code>Index</code>对象）</td>
</tr>
<tr>
<td><code>is_monotonic</code></td>
<td>判断<code>Series</code>对象中的数据是否单调</td>
</tr>
<tr>
<td><code>is_monotonic_increasing</code></td>
<td>判断<code>Series</code>对象中的数据是否单调递增</td>
</tr>
<tr>
<td><code>is_monotonic_decreasing</code></td>
<td>判断<code>Series</code>对象中的数据是否单调递减</td>
</tr>
<tr>
<td><code>is_unique</code></td>
<td>判断<code>Series</code>对象中的数据是否独一无二</td>
</tr>
<tr>
<td><code>size</code></td>
<td>返回<code>Series</code>对象中元素的个数</td>
</tr>
<tr>
<td><code>values</code></td>
<td>以<code>ndarray</code>的方式返回<code>Series</code>对象中的值（<code>ndarray</code>对象）</td>
</tr>
</tbody>
</table>
<p>我们可以通过下面的代码来了解<code>Series</code>对象的属性。</p>
<p>代码：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(ser2.dtype)                    <span class="comment"># 数据类型</span></span><br><span class="line"><span class="built_in">print</span>(ser2.hasnans)                  <span class="comment"># 有没有空值</span></span><br><span class="line"><span class="built_in">print</span>(ser2.index)                    <span class="comment"># 索引</span></span><br><span class="line"><span class="built_in">print</span>(ser2.values)                   <span class="comment"># 值</span></span><br><span class="line"><span class="built_in">print</span>(ser2.is_monotonic_increasing)  <span class="comment"># 是否单调递增</span></span><br><span class="line"><span class="built_in">print</span>(ser2.is_unique)                <span class="comment"># 是否每个值都独一无二</span></span><br></pre></td></tr></table></figure>
<p>输出：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">int64</span><br><span class="line">False</span><br><span class="line">Index([&#x27;一季度&#x27;, &#x27;二季度&#x27;, &#x27;三季度&#x27;, &#x27;四季度&#x27;], dtype=&#x27;object&#x27;)</span><br><span class="line">[320 600 500 520]</span><br><span class="line">False</span><br><span class="line">True</span><br></pre></td></tr></table></figure>
<p><code>Series</code>对象的方法很多，下面我们通过一些代码片段为大家介绍常用的方法。</p>
<h4 id="统计相关"><a class="markdownIt-Anchor" href="#统计相关"></a> 统计相关</h4>
<p><code>Series</code>对象支持各种获取描述性统计信息的方法。</p>
<p>代码：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(ser2.count())   <span class="comment"># 计数</span></span><br><span class="line"><span class="built_in">print</span>(ser2.<span class="built_in">sum</span>())     <span class="comment"># 求和</span></span><br><span class="line"><span class="built_in">print</span>(ser2.mean())    <span class="comment"># 求平均</span></span><br><span class="line"><span class="built_in">print</span>(ser2.median())  <span class="comment"># 找中位数</span></span><br><span class="line"><span class="built_in">print</span>(ser2.<span class="built_in">max</span>())     <span class="comment"># 找最大</span></span><br><span class="line"><span class="built_in">print</span>(ser2.<span class="built_in">min</span>())     <span class="comment"># 找最小</span></span><br><span class="line"><span class="built_in">print</span>(ser2.std())     <span class="comment"># 求标准差</span></span><br><span class="line"><span class="built_in">print</span>(ser2.var())     <span class="comment"># 求方差</span></span><br></pre></td></tr></table></figure>
<p>输出：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">4</span><br><span class="line">1940</span><br><span class="line">485.0</span><br><span class="line">510.0</span><br><span class="line">600</span><br><span class="line">320</span><br><span class="line">118.18065267490557</span><br><span class="line">13966.666666666666</span><br></pre></td></tr></table></figure>
<p><code>Series</code>对象还有一个名为<code>describe()</code>的方法，可以获得上述所有的描述性统计信息，如下所示。</p>
<p>代码：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ser2.describe()</span><br></pre></td></tr></table></figure>
<p>输出：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">count      4.000000</span><br><span class="line">mean     485.000000</span><br><span class="line">std      118.180653</span><br><span class="line">min      320.000000</span><br><span class="line">25%      455.000000</span><br><span class="line">50%      510.000000</span><br><span class="line">75%      540.000000</span><br><span class="line">max      600.000000</span><br><span class="line">dtype: float64</span><br></pre></td></tr></table></figure>
<blockquote>
<p><strong>提示</strong>：因为<code>describe()</code>返回的也是一个<code>Series</code>对象，所以也可以用<code>ser2.describe()['mean']</code>来获取平均值，用<code>ser2.describe()[['max', 'min']]</code>来获取最大值和最小值。</p>
</blockquote>
<p>如果<code>Series</code>对象有重复的值，我们可以使用<code>unique()</code>方法获得由独一无二的值构成的数组；可以使用<code>nunique()</code>方法统计不重复值的数量；如果想要统计每个值重复的次数，可以使用<code>value_counts()</code>方法，这个方法会返回一个<code>Series</code>对象，它的索引就是原来的<code>Series</code>对象中的值，而每个值出现的次数就是返回的<code>Series</code>对象中的数据，在默认情况下会按照出现次数做降序排列，如下所示。</p>
<p>代码：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ser3 = pd.Series(data=[<span class="string">&#x27;apple&#x27;</span>, <span class="string">&#x27;banana&#x27;</span>, <span class="string">&#x27;apple&#x27;</span>, <span class="string">&#x27;pitaya&#x27;</span>, <span class="string">&#x27;apple&#x27;</span>, <span class="string">&#x27;pitaya&#x27;</span>, <span class="string">&#x27;durian&#x27;</span>])</span><br><span class="line">ser3.value_counts()</span><br></pre></td></tr></table></figure>
<p>输出：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">apple     3</span><br><span class="line">pitaya    2</span><br><span class="line">durian    1</span><br><span class="line">banana    1</span><br><span class="line">dtype: int64</span><br></pre></td></tr></table></figure>
<p>代码：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ser3.nunique()</span><br></pre></td></tr></table></figure>
<p>输出：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">4</span><br></pre></td></tr></table></figure>
<p>对于<code>ser3</code>，我们还可以用<code>mode()</code>方法来找出数据的众数，由于众数可能不唯一，所以<code>mode()</code>方法的返回值仍然是一个<code>Series</code>对象。</p>
<p>代码：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ser3.mode()</span><br></pre></td></tr></table></figure>
<p>输出：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">0    apple</span><br><span class="line">dtype: object</span><br></pre></td></tr></table></figure>
<h4 id="处理数据"><a class="markdownIt-Anchor" href="#处理数据"></a> 处理数据</h4>
<p><code>Series</code>对象的<code>isna()</code>和<code>isnull()</code>方法可以用于空值的判断，<code>notna()</code>和<code>notnull()</code>方法可以用于非空值的判断，代码如下所示。</p>
<p>代码：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ser4 = pd.Series(data=[<span class="number">10</span>, <span class="number">20</span>, np.nan, <span class="number">30</span>, np.nan])</span><br><span class="line">ser4.isna()</span><br></pre></td></tr></table></figure>
<blockquote>
<p><strong>说明</strong>：<code>np.nan</code>是一个IEEE 754标准的浮点小数，专门用来表示“不是一个数”，在上面的代码中我们用它来代表空值；当然，也可以用 Python 中的<code>None</code>来表示空值，在 pandas 中<code>None</code>也会被处理为<code>np.nan</code>。</p>
</blockquote>
<p>输出：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">0    False</span><br><span class="line">1    False</span><br><span class="line">2     True</span><br><span class="line">3    False</span><br><span class="line">4     True</span><br><span class="line">dtype: bool</span><br></pre></td></tr></table></figure>
<p>代码：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ser4.notna()</span><br></pre></td></tr></table></figure>
<p>输出：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">0     True</span><br><span class="line">1     True</span><br><span class="line">2    False</span><br><span class="line">3     True</span><br><span class="line">4    False</span><br><span class="line">dtype: bool</span><br></pre></td></tr></table></figure>
<p><code>Series</code>对象的<code>dropna()</code>和<code>fillna()</code>方法分别用来删除空值和填充空值，具体的用法如下所示。</p>
<p>代码：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ser4.dropna()</span><br></pre></td></tr></table></figure>
<p>输出：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">0    10.0</span><br><span class="line">1    20.0</span><br><span class="line">3    30.0</span><br><span class="line">dtype: float64</span><br></pre></td></tr></table></figure>
<p>代码：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ser4.fillna(value=<span class="number">40</span>)  <span class="comment"># 将空值填充为40</span></span><br></pre></td></tr></table></figure>
<p>输出：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">0    10.0</span><br><span class="line">1    20.0</span><br><span class="line">2    40.0</span><br><span class="line">3    30.0</span><br><span class="line">4    40.0</span><br><span class="line">dtype: float64</span><br></pre></td></tr></table></figure>
<p>代码：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ser4.fillna(method=<span class="string">&#x27;ffill&#x27;</span>)  <span class="comment"># 用空值前面的非空值填充</span></span><br></pre></td></tr></table></figure>
<p>输出：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">0    10.0</span><br><span class="line">1    20.0</span><br><span class="line">2    20.0</span><br><span class="line">3    30.0</span><br><span class="line">4    30.0</span><br><span class="line">dtype: float64</span><br></pre></td></tr></table></figure>
<p>需要提醒大家注意的是，<code>dropna()</code>和<code>fillna()</code>方法都有一个名为<code>inplace</code>的参数，它的默认值是<code>False</code>，表示删除空值或填充空值不会修改原来的<code>Series</code>对象，而是返回一个新的<code>Series</code>对象。如果将<code>inplace</code>参数的值修改为<code>True</code>，那么删除或填充空值会就地操作，直接修改原来的<code>Series</code>对象，此时方法的返回值是<code>None</code>。后面我们会接触到的很多方法，包括<code>DataFrame</code>对象的很多方法都会有这个参数，它们的意义跟这里是一样的。</p>
<p><code>Series</code>对象的<code>mask()</code>和<code>where()</code>方法可以将满足或不满足条件的值进行替换，如下所示。</p>
<p>代码：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ser5 = pd.Series(<span class="built_in">range</span>(<span class="number">5</span>))</span><br><span class="line">ser5.where(ser5 &gt; <span class="number">0</span>)</span><br></pre></td></tr></table></figure>
<p>输出：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">0    NaN</span><br><span class="line">1    1.0</span><br><span class="line">2    2.0</span><br><span class="line">3    3.0</span><br><span class="line">4    4.0</span><br><span class="line">dtype: float64</span><br></pre></td></tr></table></figure>
<p>代码：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ser5.where(ser5 &gt; <span class="number">1</span>, <span class="number">10</span>)</span><br></pre></td></tr></table></figure>
<p>输出：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">0    10</span><br><span class="line">1    10</span><br><span class="line">2     2</span><br><span class="line">3     3</span><br><span class="line">4     4</span><br><span class="line">dtype: int64</span><br></pre></td></tr></table></figure>
<p>代码：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ser5.mask(ser5 &gt; <span class="number">1</span>, <span class="number">10</span>)</span><br></pre></td></tr></table></figure>
<p>输出：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">0     0</span><br><span class="line">1     1</span><br><span class="line">2    10</span><br><span class="line">3    10</span><br><span class="line">4    10</span><br><span class="line">dtype: int64</span><br></pre></td></tr></table></figure>
<p><code>Series</code>对象的<code>duplicated()</code>方法可以帮助我们找出重复的数据，而<code>drop_duplicates()</code>方法可以帮我们删除重复数据。</p>
<p>代码：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ser3.duplicated()</span><br></pre></td></tr></table></figure>
<p>输出：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">0    False</span><br><span class="line">1    False</span><br><span class="line">2     True</span><br><span class="line">3    False</span><br><span class="line">4     True</span><br><span class="line">5     True</span><br><span class="line">6    False</span><br><span class="line">dtype: bool</span><br></pre></td></tr></table></figure>
<p>代码：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ser3.drop_duplicates()</span><br></pre></td></tr></table></figure>
<p>输出：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">0     apple</span><br><span class="line">1    banana</span><br><span class="line">3    pitaya</span><br><span class="line">6    durian</span><br><span class="line">dtype: object</span><br></pre></td></tr></table></figure>
<p><code>Series</code>对象的<code>apply()</code>和<code>map()</code>方法非常重要，它们可以通过字典或者指定的函数来处理数据，把数据映射或转换成我们想要的样子。这两个方法在数据准备阶段非常重要，我们先来试一试这个名为<code>map</code>的方法。</p>
<p>代码：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ser6 = pd.Series([<span class="string">&#x27;cat&#x27;</span>, <span class="string">&#x27;dog&#x27;</span>, np.nan, <span class="string">&#x27;rabbit&#x27;</span>])</span><br><span class="line">ser6</span><br></pre></td></tr></table></figure>
<p>输出：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">0       cat</span><br><span class="line">1       dog</span><br><span class="line">2       NaN</span><br><span class="line">3    rabbit</span><br><span class="line">dtype: object</span><br></pre></td></tr></table></figure>
<p>代码：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ser6.<span class="built_in">map</span>(&#123;<span class="string">&#x27;cat&#x27;</span>: <span class="string">&#x27;kitten&#x27;</span>, <span class="string">&#x27;dog&#x27;</span>: <span class="string">&#x27;puppy&#x27;</span>&#125;)</span><br></pre></td></tr></table></figure>
<blockquote>
<p><strong>说明</strong>：通过字典给出的映射规则对数据进行处理。</p>
</blockquote>
<p>输出：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">0    kitten</span><br><span class="line">1     puppy</span><br><span class="line">2       NaN</span><br><span class="line">3       NaN</span><br><span class="line">dtype: object</span><br></pre></td></tr></table></figure>
<p>代码：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ser6.<span class="built_in">map</span>(<span class="string">&#x27;I am a &#123;&#125;&#x27;</span>.<span class="built_in">format</span>, na_action=<span class="string">&#x27;ignore&#x27;</span>)</span><br></pre></td></tr></table></figure>
<blockquote>
<p><strong>说明</strong>：将指定字符串的<code>format</code>方法作用到数据系列的数据上，忽略掉所有的空值。</p>
</blockquote>
<p>输出：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">0       I am a cat</span><br><span class="line">1       I am a dog</span><br><span class="line">2              NaN</span><br><span class="line">3    I am a rabbit</span><br><span class="line">dtype: object</span><br></pre></td></tr></table></figure>
<p>我们创建一个新的<code>Series</code>对象，</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ser7 = pd.Series([<span class="number">20</span>, <span class="number">21</span>, <span class="number">12</span>],  index=[<span class="string">&#x27;London&#x27;</span>, <span class="string">&#x27;New York&#x27;</span>, <span class="string">&#x27;Helsinki&#x27;</span>])</span><br><span class="line">ser7</span><br></pre></td></tr></table></figure>
<p>输出：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">London      20</span><br><span class="line">New York    21</span><br><span class="line">Helsinki    12</span><br><span class="line">dtype: int64</span><br></pre></td></tr></table></figure>
<p>代码：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ser7.apply(np.square)</span><br></pre></td></tr></table></figure>
<blockquote>
<p><strong>说明</strong>：将求平方的函数作用到数据系列的数据上，也可以将参数<code>np.square</code>替换为<code>lambda x: x ** 2</code>。</p>
</blockquote>
<p>输出：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">London      400</span><br><span class="line">New York    441</span><br><span class="line">Helsinki    144</span><br><span class="line">dtype: int64</span><br></pre></td></tr></table></figure>
<p>代码：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ser7.apply(<span class="keyword">lambda</span> x, value: x - value, args=(<span class="number">5</span>, ))</span><br></pre></td></tr></table></figure>
<blockquote>
<p>注意：上面<code>apply</code>方法中的<code>lambda</code>函数有两个参数，第一个参数是数据系列中的数据，而第二个参数需要我们传入，所以我们给<code>apply</code>方法增加了<code>args</code>参数，用于给<code>lambda</code>函数的第二个参数传值。</p>
</blockquote>
<p>输出：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">London      15</span><br><span class="line">New York    16</span><br><span class="line">Helsinki     7</span><br><span class="line">dtype: int64</span><br></pre></td></tr></table></figure>
<h4 id="取头部值和排序"><a class="markdownIt-Anchor" href="#取头部值和排序"></a> 取头部值和排序</h4>
<p><code>Series</code>对象的<code>sort_index()</code>和<code>sort_values()</code>方法可以用于对索引和数据的排序，排序方法有一个名为<code>ascending</code>的布尔类型参数，该参数用于控制排序的结果是升序还是降序；而名为<code>kind</code>的参数则用来控制排序使用的算法，默认使用了<code>quicksort</code>，也可以选择<code>mergesort</code>或<code>heapsort</code>；如果存在空值，那么可以用<code>na_position</code>参数空值放在最前还是最后，默认是<code>last</code>，代码如下所示。</p>
<p>代码：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">ser8 = pd.Series(</span><br><span class="line">    data=[<span class="number">35</span>, <span class="number">96</span>, <span class="number">12</span>, <span class="number">57</span>, <span class="number">25</span>, <span class="number">89</span>], </span><br><span class="line">    index=[<span class="string">&#x27;grape&#x27;</span>, <span class="string">&#x27;banana&#x27;</span>, <span class="string">&#x27;pitaya&#x27;</span>, <span class="string">&#x27;apple&#x27;</span>, <span class="string">&#x27;peach&#x27;</span>, <span class="string">&#x27;orange&#x27;</span>]</span><br><span class="line">)</span><br><span class="line">ser8.sort_values()  <span class="comment"># 按值从小到大排序</span></span><br></pre></td></tr></table></figure>
<p>输出：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">pitaya    12</span><br><span class="line">peach     25</span><br><span class="line">grape     35</span><br><span class="line">apple     57</span><br><span class="line">orange    89</span><br><span class="line">banana    96</span><br><span class="line">dtype: int64</span><br></pre></td></tr></table></figure>
<p>代码：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ser8.sort_index(ascending=<span class="literal">False</span>)  <span class="comment"># 按索引从大到小排序</span></span><br></pre></td></tr></table></figure>
<p>输出：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">pitaya    12</span><br><span class="line">peach     25</span><br><span class="line">orange    89</span><br><span class="line">grape     35</span><br><span class="line">banana    96</span><br><span class="line">apple     57</span><br><span class="line">dtype: int64</span><br></pre></td></tr></table></figure>
<p>如果要从<code>Series</code>对象中找出元素中最大或最小的“Top-N”，我们不需要对所有的值进行排序的，可以使用<code>nlargest()</code>和<code>nsmallest()</code>方法来完成，如下所示。</p>
<p>代码：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ser8.nlargest(<span class="number">3</span>)  <span class="comment"># 值最大的3个</span></span><br></pre></td></tr></table></figure>
<p>输出：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">banana    96</span><br><span class="line">orange    89</span><br><span class="line">apple     57</span><br><span class="line">dtype: int64</span><br></pre></td></tr></table></figure>
<p>代码：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ser8.nsmallest(<span class="number">2</span>)  <span class="comment"># 值最小的2个</span></span><br></pre></td></tr></table></figure>
<p>输出：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">pitaya    12</span><br><span class="line">peach     25</span><br><span class="line">dtype: int64</span><br></pre></td></tr></table></figure>
<h4 id="绘制图表"><a class="markdownIt-Anchor" href="#绘制图表"></a> 绘制图表</h4>
<p><code>Series</code>对象有一个名为<code>plot</code>的方法可以用来生成图表，如果选择生成折线图、饼图、柱状图等，默认会使用<code>Series</code>对象的索引作为横坐标，使用<code>Series</code>对象的数据作为纵坐标。下面我们创建一个<code>Series</code>对象并基于它绘制柱状图，代码如下所示。</p>
<p>代码：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"></span><br><span class="line">ser9 = pd.Series(&#123;<span class="string">&#x27;Q1&#x27;</span>: <span class="number">400</span>, <span class="string">&#x27;Q2&#x27;</span>: <span class="number">520</span>, <span class="string">&#x27;Q3&#x27;</span>: <span class="number">180</span>, <span class="string">&#x27;Q4&#x27;</span>: <span class="number">380</span>&#125;)</span><br><span class="line"><span class="comment"># 通过plot方法的kind指定图表类型为柱状图</span></span><br><span class="line">ser9.plot(kind=<span class="string">&#x27;bar&#x27;</span>)</span><br><span class="line"><span class="comment"># 定制纵轴的取值范围</span></span><br><span class="line">plt.ylim(<span class="number">0</span>, <span class="number">600</span>)</span><br><span class="line"><span class="comment"># 定制横轴刻度（旋转到0度）</span></span><br><span class="line">plt.xticks(rotation=<span class="number">0</span>)</span><br><span class="line"><span class="comment"># 为柱子增加数据标签</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(ser9.size):</span><br><span class="line">    plt.text(i, ser9[i] + <span class="number">5</span>, ser9[i], ha=<span class="string">&#x27;center&#x27;</span>)</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>
<p>输出：</p>
<img src="/images/ser_bar_graph.png" style="zoom:35%;">
<p>我们也可以将其绘制为饼图，代码如下所示。</p>
<p>代码：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># plot方法的kind参数指定了图表类型为饼图</span></span><br><span class="line"><span class="comment"># autopct会自动计算并显示百分比</span></span><br><span class="line"><span class="comment"># pctdistance用来控制百分比到圆心的距离</span></span><br><span class="line">ser9.plot(kind=<span class="string">&#x27;pie&#x27;</span>, autopct=<span class="string">&#x27;%.1f%%&#x27;</span>, pctdistance=<span class="number">0.65</span>)</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>
<p>输出：</p>
<img src="/images/ser_pie_graph.png" style="zoom:35%;">
<h3 id="创建dataframe对象"><a class="markdownIt-Anchor" href="#创建dataframe对象"></a> 创建DataFrame对象</h3>
<p>如果使用 pandas 做数据分析，那么<code>DataFrame</code>一定是被使用得最多的类型，它可以用来保存和处理异质的二维数据。这里所谓的“异质”是指<code>DataFrame</code>中每个列的数据类型不需要相同，这也是它区别于 NumPy 二维数组的地方。<code>DataFrame</code>提供了极为丰富的属性和方法，帮助我们实现对数据的重塑、清洗、预处理、透视、呈现等一系列操作。</p>
<h4 id="通过二维数组创建dataframe对象"><a class="markdownIt-Anchor" href="#通过二维数组创建dataframe对象"></a> 通过二维数组创建DataFrame对象</h4>
<p>代码：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">scores = np.random.randint(<span class="number">60</span>, <span class="number">101</span>, (<span class="number">5</span>, <span class="number">3</span>))</span><br><span class="line">courses = [<span class="string">&#x27;语文&#x27;</span>, <span class="string">&#x27;数学&#x27;</span>, <span class="string">&#x27;英语&#x27;</span>]</span><br><span class="line">stu_ids = np.arange(<span class="number">1001</span>, <span class="number">1006</span>)</span><br><span class="line">df1 = pd.DataFrame(data=scores, columns=courses, index=stu_ids)</span><br><span class="line">df1</span><br></pre></td></tr></table></figure>
<p>输出：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">        语文  数学  英语</span><br><span class="line">1001    69    80    79</span><br><span class="line">1002    71    60    100</span><br><span class="line">1003    94    81    93</span><br><span class="line">1004    88    88    67</span><br><span class="line">1005    82    66    60</span><br></pre></td></tr></table></figure>
<h4 id="通过字典创建dataframe对象"><a class="markdownIt-Anchor" href="#通过字典创建dataframe对象"></a> 通过字典创建DataFrame对象</h4>
<p>代码：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">scores = &#123;</span><br><span class="line">    <span class="string">&#x27;语文&#x27;</span>: [<span class="number">62</span>, <span class="number">72</span>, <span class="number">93</span>, <span class="number">88</span>, <span class="number">93</span>],</span><br><span class="line">    <span class="string">&#x27;数学&#x27;</span>: [<span class="number">95</span>, <span class="number">65</span>, <span class="number">86</span>, <span class="number">66</span>, <span class="number">87</span>],</span><br><span class="line">    <span class="string">&#x27;英语&#x27;</span>: [<span class="number">66</span>, <span class="number">75</span>, <span class="number">82</span>, <span class="number">69</span>, <span class="number">82</span>],</span><br><span class="line">&#125;</span><br><span class="line">stu_ids = np.arange(<span class="number">1001</span>, <span class="number">1006</span>)</span><br><span class="line">df2 = pd.DataFrame(data=scores, index=stu_ids)</span><br><span class="line">df2</span><br></pre></td></tr></table></figure>
<p>输出：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">        语文  数学  英语</span><br><span class="line">1001    62    95    66</span><br><span class="line">1002    72    65    75</span><br><span class="line">1003    93    86    82</span><br><span class="line">1004    88    66    69</span><br><span class="line">1005    93    87    82</span><br></pre></td></tr></table></figure>
<h4 id="读取csv文件创建dataframe对象"><a class="markdownIt-Anchor" href="#读取csv文件创建dataframe对象"></a> 读取CSV文件创建DataFrame对象</h4>
<p>可以通过<code>pandas</code> 模块的<code>read_csv</code>函数来读取 CSV 文件，<code>read_csv</code>函数的参数非常多，下面介绍几个比较重要的参数。</p>
<ul>
<li><code>sep</code> / <code>delimiter</code>：分隔符，默认是<code>,</code>。</li>
<li><code>header</code>：表头（列索引）的位置，默认值是<code>infer</code>，用第一行的内容作为表头（列索引）。</li>
<li><code>index_col</code>：用作行索引（标签）的列。</li>
<li><code>usecols</code>：需要加载的列，可以使用序号或者列名。</li>
<li><code>true_values</code> / <code>false_values</code>：哪些值被视为布尔值<code>True</code> / <code>False</code>。</li>
<li><code>skiprows</code>：通过行号、索引或函数指定需要跳过的行。</li>
<li><code>skipfooter</code>：要跳过的末尾行数。</li>
<li><code>nrows</code>：需要读取的行数。</li>
<li><code>na_values</code>：哪些值被视为空值。</li>
<li><code>iterator</code>：设置为<code>True</code>，函数返回迭代器对象。</li>
<li><code>chunksize</code>：配合上面的参数，设置每次迭代获取的数据体量。</li>
</ul>
<p>代码：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">df3 = pd.read_csv(<span class="string">&#x27;data/2018年北京积分落户数据.csv&#x27;</span>, index_col=<span class="string">&#x27;id&#x27;</span>)</span><br><span class="line">df3</span><br></pre></td></tr></table></figure>
<blockquote>
<p><strong>提示</strong>：上面代码中的CSV文件是用相对路径进行获取的，也就是说当前工作路径下有名为<code>data</code>的文件夹，而“2018年北京积分落户数据.csv”就在这个文件夹下。如果使用Windows系统，在写路径分隔符时也建议使用<code>/</code>而不是<code>\</code>，如果想使用<code>\</code>，建议在字符串前面添加一个<code>r</code>，使用原始字符串来避开转义字符，例如<code>r'c:\new\data\2018年北京积分落户数据.csv'</code>。</p>
</blockquote>
<p>输出：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">      name   birthday      company          score</span><br><span class="line">id                                             </span><br><span class="line">1     杨xx   1972-12       北京利德华福xxxx  122.59</span><br><span class="line">2     纪xx   1974-12       北京航天数据xxxx  121.25</span><br><span class="line">3     王x    1974-05       品牌联盟(北京)xx  118.96</span><br><span class="line">4     杨x    1975-07       中科专利商标xxxx  118.21</span><br><span class="line">5     张xx   1974-11       北京阿里巴巴xxxx  117.79</span><br><span class="line">...   ...      ...                  ...     ...</span><br><span class="line">6015  孙xx   1978-08       华为海洋网络xxxx   90.75</span><br><span class="line">6016  刘xx   1976-11       福斯（上海）xxxx   90.75</span><br><span class="line">6017  周x    1977-10       赢创德固赛xxxxxx   90.75</span><br><span class="line">6018  赵x    1979-07       澳科利耳医疗xxxx   90.75</span><br><span class="line">6019  贺x    1981-06       北京宝洁技术xxxx   90.75</span><br><span class="line"></span><br><span class="line">[6019 rows x 4 columns]</span><br></pre></td></tr></table></figure>
<blockquote>
<p><strong>说明</strong>： 上面输出的内容隐去了姓名（name）和公司名称（company）字段中的部分信息。如果需要上面例子中的 CSV 文件，可以通过百度云盘获取，链接：<a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1rQujl5RQn9R7PadB2Z5g_g">https://pan.baidu.com/s/1rQujl5RQn9R7PadB2Z5g_g</a>，提取码：e7b4。</p>
</blockquote>
<h4 id="读取excel工作表创建dataframe对象"><a class="markdownIt-Anchor" href="#读取excel工作表创建dataframe对象"></a> 读取Excel工作表创建DataFrame对象</h4>
<p>可以通过<code>pandas</code> 模块的<code>read_excel</code>函数来读取 Excel 文件，该函数与上面的<code>read_csv</code>非常类似，多了一个<code>sheet_name</code>参数来指定数据表的名称，但是不同于 CSV 文件，没有<code>sep</code>或<code>delimiter</code>这样的参数。假设有名为“2022年股票数据.xlsx”的 Excel 文件，里面有用股票代码命名的五个表单，分别是阿里巴巴（BABA）、百度（BIDU）、京东（JD）、亚马逊（AMZN）、甲骨文（ORCL）这五个公司2022年的股票数据，如果想加载亚马逊的股票数据，代码如下所示。</p>
<p>代码：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">df4 = pd.read_excel(<span class="string">&#x27;data/2022年股票数据.xlsx&#x27;</span>, sheet_name=<span class="string">&#x27;AMZN&#x27;</span>, index_col=<span class="string">&#x27;Date&#x27;</span>)</span><br><span class="line">df4</span><br></pre></td></tr></table></figure>
<blockquote>
<p><strong>说明</strong>：上面例子中的 CSV 文件可以通过百度云盘获取，链接：<a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1rQujl5RQn9R7PadB2Z5g_g">https://pan.baidu.com/s/1rQujl5RQn9R7PadB2Z5g_g</a>，提取码：e7b4。</p>
</blockquote>
<p>输出：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">               Open     High       Low    Close    Volume</span><br><span class="line">Date                                                     </span><br><span class="line">2022-12-30   83.120   84.050   82.4700   84.000  62401194</span><br><span class="line">2022-12-29   82.870   84.550   82.5500   84.180  54995895</span><br><span class="line">2022-12-28   82.800   83.480   81.6900   81.820  58228575</span><br><span class="line">2022-12-27   84.970   85.350   83.0000   83.040  57284035</span><br><span class="line">2022-12-23   83.250   85.780   82.9344   85.250  57433655</span><br><span class="line">...             ...      ...       ...      ...       ...</span><br><span class="line">2022-01-07  163.839  165.243  162.0310  162.554  46605900</span><br><span class="line">2022-01-06  163.450  164.800  161.9370  163.254  51957780</span><br><span class="line">2022-01-05  166.883  167.126  164.3570  164.357  64302720</span><br><span class="line">2022-01-04  170.438  171.400  166.3490  167.522  70725160</span><br><span class="line">2022-01-03  167.550  170.704  166.1600  170.404  63869140</span><br><span class="line"></span><br><span class="line">[251 rows x 5 columns]</span><br></pre></td></tr></table></figure>
<h4 id="读取关系数据库二维表创建dataframe对象"><a class="markdownIt-Anchor" href="#读取关系数据库二维表创建dataframe对象"></a> 读取关系数据库二维表创建DataFrame对象</h4>
<p><code>pandas</code>模块的<code>read_sql</code>函数可以通过 SQL 语句从数据库中读取数据创建<code>DataFrame</code>对象，该函数的第二个参数代表了需要连接的数据库。对于 MySQL 数据库，我们可以通过<code>pymysql</code>或<code>mysqlclient</code>来创建数据库连接（需要提前安装好三方库），得到一个<code>Connection</code> 对象，而这个对象就是<code>read_sql</code>函数需要的第二个参数，代码如下所示。</p>
<p>代码：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pymysql</span><br><span class="line"></span><br><span class="line"><span class="comment"># 创建一个MySQL数据库的连接对象</span></span><br><span class="line">conn = pymysql.connect(</span><br><span class="line">    host=<span class="string">&#x27;101.42.16.8&#x27;</span>, port=<span class="number">3306</span>,</span><br><span class="line">    user=<span class="string">&#x27;guest&#x27;</span>, password=<span class="string">&#x27;Guest.618&#x27;</span>,</span><br><span class="line">    database=<span class="string">&#x27;hrs&#x27;</span>, charset=<span class="string">&#x27;utf8mb4&#x27;</span></span><br><span class="line">)</span><br><span class="line"><span class="comment"># 通过SQL从数据库二维表读取数据创建DataFrame</span></span><br><span class="line">df5 = pd.read_sql(<span class="string">&#x27;select * from tb_emp&#x27;</span>, conn, index_col=<span class="string">&#x27;eno&#x27;</span>)</span><br><span class="line">df5</span><br></pre></td></tr></table></figure>
<blockquote>
<p><strong>提示</strong>：执行上面的代码需要先安装<code>pymysql</code>库，如果尚未安装，可以先在单元格中先执行魔法指令<code>%pip install pymysql</code>，然后再运行上面的代码。上面的代码连接的是我部署在腾讯云上的 MySQL 数据库，公网 IP 地址：<code>101.42.16.8</code>，用户名：<code>guest</code>，密码：<code>Guest.618</code>，数据库：<code>hrs</code>，字符集：<code>utf8mb4</code>，大家可以使用这个数据库，但是不要进行恶意的访问。<code>hrs</code>数据库一共有三张表，分别是：<code>tb_dept</code>（部门表）、<code>tb_emp</code>（员工表）、<code>tb_emp2</code>（员工表2）。</p>
</blockquote>
<p>输出：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">       ename   job     mgr     sal    comm    dno</span><br><span class="line">eno                                        </span><br><span class="line">1359   胡一刀   销售员  3344.0  1800   200.0   30</span><br><span class="line">2056    乔峰   分析师   7800.0  5000  1500.0   20</span><br><span class="line">3088   李莫愁   设计师  2056.0  3500   800.0   20</span><br><span class="line">3211   张无忌   程序员  2056.0  3200     NaN   20</span><br><span class="line">3233   丘处机   程序员  2056.0  3400     NaN   20</span><br><span class="line">3244   欧阳锋   程序员  3088.0  3200     NaN   20</span><br><span class="line">3251   张翠山   程序员  2056.0  4000     NaN   20</span><br><span class="line">3344    黄蓉  销售主管  7800.0  3000   800.0   30</span><br><span class="line">3577    杨过    会计    5566.0  2200     NaN   10</span><br><span class="line">3588   朱九真    会计   5566.0  2500     NaN   10</span><br><span class="line">4466   苗人凤   销售员  3344.0  2500     NaN   30</span><br><span class="line">5234    郭靖    出纳    5566.0  2000     NaN   10</span><br><span class="line">5566   宋远桥   会计师  7800.0  4000  1000.0   10</span><br><span class="line">7800   张三丰    总裁     NaN   9000  1200.0   20</span><br></pre></td></tr></table></figure>
<p>执行上面的代码会出现一个警告，因为 pandas 库希望我们使用<code>SQLAlchemy</code>三方库接入数据库，具体内容是：“UserWarning: pandas only supports SQLAlchemy connectable (engine/connection) or database string URI or sqlite3 DBAPI2 connection. Other DBAPI2 objects are not tested. Please consider using SQLAlchemy.”。如果不想看到这个警告，我们可以试一试下面的解决方案。</p>
<p>首先，安装三方库<code>SQLAlchemy</code>，在 Jupyter 中可以使用<code>%pip</code>魔法指令。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">%pip install sqlalchemy</span><br></pre></td></tr></table></figure>
<p>通过<code>SQLAlchemy</code>的<code>create_engine</code>函数创建<code>Engine</code>对象作为<code>read_sql</code>函数的第二个参数，此时<code>read_sql</code>函数的第一个参数可以是 SQL 语句，也可以是二维表的表名。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sqlalchemy <span class="keyword">import</span> create_engine</span><br><span class="line"></span><br><span class="line"><span class="comment"># 通过指定的URL（统一资源定位符）访问数据库</span></span><br><span class="line">engine = create_engine(<span class="string">&#x27;mysql+pymysql://guest:Guest.618@101.42.16.8:3306/hrs&#x27;</span>)</span><br><span class="line"><span class="comment"># 直接通过表名加载整张表的数据</span></span><br><span class="line">df5 = pd.read_sql(<span class="string">&#x27;tb_emp&#x27;</span>, engine, index_col=<span class="string">&#x27;eno&#x27;</span>)</span><br><span class="line">df5</span><br></pre></td></tr></table></figure>
<blockquote>
<p><strong>说明</strong>：如果通过表名加载二维表数据，也可以将上面的函数换成<code>read_sql_table</code>。</p>
</blockquote>
<p>我们再来加载部门表的数据创建<code>DataFrame</code>对象。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">df6 = pd.read_sql(<span class="string">&#x27;select dno, dname, dloc from tb_dept&#x27;</span>, engine, index_col=<span class="string">&#x27;dno&#x27;</span>)</span><br><span class="line">df6</span><br></pre></td></tr></table></figure>
<blockquote>
<p><strong>说明</strong>：如果通过 SQL 查询获取数据，也可以将上面的函数换成<code>read_sql_query</code>。</p>
</blockquote>
<p>输出：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">      dname   dloc</span><br><span class="line">dno           </span><br><span class="line">10    会计部   北京</span><br><span class="line">20    研发部   成都</span><br><span class="line">30    销售部   重庆</span><br><span class="line">40    运维部   深圳</span><br></pre></td></tr></table></figure>
<p>在完成数据加载后，如果希望释放数据库连接，可以使用下面的代码。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">engine.connect().close()</span><br></pre></td></tr></table></figure>
<h4 id="基本属性和方法"><a class="markdownIt-Anchor" href="#基本属性和方法"></a> 基本属性和方法</h4>
<p>在开始讲解<code>DataFrame</code>的属性和方法前，我们先从之前提到的<code>hrs</code>数据库中读取三张表的数据，创建出三个<code>DataFrame</code>对象，完整的代码如下所示。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sqlalchemy <span class="keyword">import</span> create_engine</span><br><span class="line"></span><br><span class="line">engine = create_engine(<span class="string">&#x27;mysql+pymysql://guest:Guest.618@101.42.16.8:3306/hrs&#x27;</span>)</span><br><span class="line">dept_df = pd.read_sql_table(<span class="string">&#x27;tb_dept&#x27;</span>, engine, index_col=<span class="string">&#x27;dno&#x27;</span>)</span><br><span class="line">emp_df = pd.read_sql_table(<span class="string">&#x27;tb_emp&#x27;</span>, engine, index_col=<span class="string">&#x27;eno&#x27;</span>)</span><br><span class="line">emp2_df = pd.read_sql_table(<span class="string">&#x27;tb_emp2&#x27;</span>, engine, index_col=<span class="string">&#x27;eno&#x27;</span>)</span><br></pre></td></tr></table></figure>
<p>得到的三个<code>DataFrame</code>对象如下所示。</p>
<p>部门表（<code>dept_df</code>），其中<code>dno</code>是部门的编号，<code>dname</code>和<code>dloc</code>分别是部门的名称和所在地。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">    dname  dloc</span><br><span class="line">dno</span><br><span class="line">10  会计部  北京</span><br><span class="line">20  研发部  成都</span><br><span class="line">30  销售部  重庆</span><br><span class="line">40  运维部  深圳</span><br></pre></td></tr></table></figure>
<p>员工表（<code>emp_df</code>），其中<code>eno</code>是员工编号，<code>ename</code>、<code>job</code>、<code>mgr</code>、<code>sal</code>、<code>comm</code>和<code>dno</code>分别代表员工的姓名、职位、主管编号、月薪、补贴和部门编号。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">        ename    job        mgr      sal     comm    dno</span><br><span class="line">eno</span><br><span class="line">1359    胡一刀    销售员      3344.0    1800    200.0    30</span><br><span class="line">2056    乔峰      分析师      7800.0    5000    1500.0   20</span><br><span class="line">3088    李莫愁    设计师      2056.0    3500    800.0    20</span><br><span class="line">3211    张无忌     程序员     2056.0    3200    NaN     20</span><br><span class="line">3233    丘处机     程序员     2056.0    3400    NaN     20</span><br><span class="line">3244    欧阳锋     程序员     3088.0    3200    NaN     20</span><br><span class="line">3251    张翠山     程序员     2056.0    4000    NaN     20</span><br><span class="line">3344    黄蓉      销售主管    7800.0    3000    800.0   30</span><br><span class="line">3577    杨过      会计       5566.0    2200     NaN     10</span><br><span class="line">3588    朱九真     会计       5566.0    2500    NaN     10</span><br><span class="line">4466    苗人凤     销售员     3344.0    2500    NaN     30</span><br><span class="line">5234    郭靖       出纳      5566.0    2000    NaN      10</span><br><span class="line">5566    宋远桥     会计师     7800.0    4000    1000.0   10</span><br><span class="line">7800    张三丰     总裁       NaN      9000    1200.0    20</span><br></pre></td></tr></table></figure>
<blockquote>
<p><strong>说明</strong>：在数据库中<code>mgr</code>和<code>comm</code>两个列的数据类型是<code>int</code>，但是因为有缺失值（空值），读取到<code>DataFrame</code>之后，列的数据类型变成了<code>float</code>，因为我们通常会用<code>float</code>类型的<code>NaN</code>来表示空值。</p>
</blockquote>
<p>员工表（<code>emp2_df</code>），跟上面的员工表结构相同，但是保存了不同的员工数据。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">       ename    job      mgr      sal    comm    dno</span><br><span class="line">eno                                      </span><br><span class="line">9500   张三丰   总裁      NaN      50000  8000    20</span><br><span class="line">9600   王大锤   程序员    9800.0   8000   600     20</span><br><span class="line">9700   张三丰   总裁      NaN      60000  6000    20</span><br><span class="line">9800   骆昊     架构师    7800.0   30000  5000    20</span><br><span class="line">9900   陈小刀   分析师    9800.0   10000  1200    20</span><br></pre></td></tr></table></figure>
<p><code>DataFrame</code>对象的属性如下表所示。</p>
<table>
<thead>
<tr>
<th>属性名</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>at</code> / <code>iat</code></td>
<td>通过标签获取<code>DataFrame</code>中的单个值。</td>
</tr>
<tr>
<td><code>columns</code></td>
<td><code>DataFrame</code>对象列的索引</td>
</tr>
<tr>
<td><code>dtypes</code></td>
<td><code>DataFrame</code>对象每一列的数据类型</td>
</tr>
<tr>
<td><code>empty</code></td>
<td><code>DataFrame</code>对象是否为空</td>
</tr>
<tr>
<td><code>loc</code> / <code>iloc</code></td>
<td>通过标签获取<code>DataFrame</code>中的一组值。</td>
</tr>
<tr>
<td><code>ndim</code></td>
<td><code>DataFrame</code>对象的维度</td>
</tr>
<tr>
<td><code>shape</code></td>
<td><code>DataFrame</code>对象的形状（行数和列数）</td>
</tr>
<tr>
<td><code>size</code></td>
<td><code>DataFrame</code>对象中元素的个数</td>
</tr>
<tr>
<td><code>values</code></td>
<td><code>DataFrame</code>对象的数据对应的二维数组</td>
</tr>
</tbody>
</table>
<p>关于<code>DataFrame</code>的方法，首先需要了解的是<code>info()</code>方法，它可以帮助我们了解<code>DataFrame</code>的相关信息，如下所示。</p>
<p>代码：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">emp_df.info()</span><br></pre></td></tr></table></figure>
<p>输出：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&lt;class &#x27;pandas.core.frame.DataFrame&#x27;&gt;</span><br><span class="line">Int64Index: 14 entries, 1359 to 7800</span><br><span class="line">Data columns (total 6 columns):</span><br><span class="line"> #   Column  Non-Null Count  Dtype  </span><br><span class="line">---  ------  --------------  -----  </span><br><span class="line"> 0   ename   14 non-null     object </span><br><span class="line"> 1   job     14 non-null     object </span><br><span class="line"> 2   mgr     13 non-null     float64</span><br><span class="line"> 3   sal     14 non-null     int64  </span><br><span class="line"> 4   comm    6 non-null      float64</span><br><span class="line"> 5   dno     14 non-null     int64  </span><br><span class="line">dtypes: float64(2), int64(2), object(2)</span><br><span class="line">memory usage: 1.3+ KB</span><br></pre></td></tr></table></figure>
<p>如果需要查看<code>DataFrame</code>的头部或尾部的数据，可以使用<code>head()</code>或<code>tail()</code>方法，这两个方法的默认参数是<code>5</code>，表示获取<code>DataFrame</code>最前面5行或最后面5行的数据，如下所示。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">emp_df.head()</span><br></pre></td></tr></table></figure>
<p>输出：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">        ename    job    mgr    sal    comm  dno</span><br><span class="line">eno</span><br><span class="line">1359    胡一刀   销售员   3344   1800   200   30</span><br><span class="line">2056    乔峰     分析师   7800   5000   1500  20</span><br><span class="line">3088    李莫愁    设计师   2056   3500  800   20</span><br><span class="line">3211    张无忌    程序员   2056   3200  NaN   20</span><br><span class="line">3233    丘处机    程序员   2056   3400  NaN   20</span><br></pre></td></tr></table></figure>
<h4 id="操作数据"><a class="markdownIt-Anchor" href="#操作数据"></a> 操作数据</h4>
<h5 id="索引和切片"><a class="markdownIt-Anchor" href="#索引和切片"></a> 索引和切片</h5>
<p>如果要获取<code>DataFrame</code>的某一列，例如取出上面<code>emp_df</code>的<code>ename</code>列，可以使用下面的两种方式。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">emp_df.ename</span><br></pre></td></tr></table></figure>
<p>或者</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">emp_df[<span class="string">&#x27;ename&#x27;</span>]</span><br></pre></td></tr></table></figure>
<p>执行上面的代码可以发现，我们获得的是一个<code>Series</code>对象。事实上，<code>DataFrame</code>对象就是将多个<code>Series</code>对象组合到一起的结果。</p>
<p>如果要获取<code>DataFrame</code>的某一行，可以使用整数索引或我们设置的索引，例如取出员工编号为<code>2056</code>的员工数据，代码如下所示。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">emp_df.iloc[<span class="number">1</span>]</span><br></pre></td></tr></table></figure>
<p>或者</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">emp_df.loc[<span class="number">2056</span>]</span><br></pre></td></tr></table></figure>
<p>通过执行上面的代码我们发现，单独取<code>DataFrame</code> 的某一行或某一列得到的都是<code>Series</code>对象。我们当然也可以通过花式索引来获取多个行或多个列的数据，花式索引的结果仍然是一个<code>DataFrame</code>对象。</p>
<p>获取多个列：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">emp_df[[<span class="string">&#x27;ename&#x27;</span>, <span class="string">&#x27;job&#x27;</span>]]</span><br></pre></td></tr></table></figure>
<p>获取多个行：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">emp_df.loc[[<span class="number">2056</span>, <span class="number">7800</span>, <span class="number">3344</span>]]</span><br></pre></td></tr></table></figure>
<p>如果要获取或修改<code>DataFrame</code> 对象某个单元格的数据，需要同时指定行和列的索引，例如要获取员工编号为<code>2056</code>的员工的职位信息，代码如下所示。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">emp_df[<span class="string">&#x27;job&#x27;</span>][<span class="number">2056</span>]</span><br></pre></td></tr></table></figure>
<p>或者</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">emp_df.loc[<span class="number">2056</span>][<span class="string">&#x27;job&#x27;</span>]</span><br></pre></td></tr></table></figure>
<p>或者</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">emp_df.loc[<span class="number">2056</span>, <span class="string">&#x27;job&#x27;</span>]</span><br></pre></td></tr></table></figure>
<p>我们推荐大家使用第三种做法，因为它只做了一次索引运算。如果要将该员工的职位修改为“架构师”，可以使用下面的代码。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">emp_df.loc[<span class="number">2056</span>, <span class="string">&#x27;job&#x27;</span>] = <span class="string">&#x27;架构师&#x27;</span></span><br></pre></td></tr></table></figure>
<p>当然，我们也可以通过切片操作来获取多行多列，相信大家一定已经想到了这一点。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">emp_df.loc[<span class="number">2056</span>:<span class="number">3344</span>]</span><br></pre></td></tr></table></figure>
<p>输出：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">        ename    job        mgr      sal     comm    dno</span><br><span class="line">eno</span><br><span class="line">2056    乔峰      分析师     7800.0    5000    1500.0   20</span><br><span class="line">3088    李莫愁    设计师     2056.0    3500    800.0    20</span><br><span class="line">3211    张无忌    程序员     2056.0    3200    NaN      20</span><br><span class="line">3233    丘处机    程序员     2056.0    3400    NaN      20</span><br><span class="line">3244    欧阳锋    程序员     3088.0    3200    NaN      20</span><br><span class="line">3251    张翠山    程序员     2056.0    4000    NaN      20</span><br><span class="line">3344    黄蓉     销售主管    7800.0    3000    800.0    30</span><br></pre></td></tr></table></figure>
<h5 id="数据筛选"><a class="markdownIt-Anchor" href="#数据筛选"></a> 数据筛选</h5>
<p>上面我们提到了花式索引，相信大家已经联想到了布尔索引。跟<code>ndarray</code>和<code>Series</code>一样，我们可以通过布尔索引对<code>DataFrame</code>对象进行数据筛选，例如我们要从<code>emp_df</code>中筛选出月薪超过<code>3500</code>的员工，代码如下所示。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">emp_df[emp_df.sal &gt; <span class="number">3500</span>]</span><br></pre></td></tr></table></figure>
<p>输出：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">        ename    job        mgr      sal     comm    dno</span><br><span class="line">eno</span><br><span class="line">2056    乔峰      分析师      7800.0   5000    1500.0    20</span><br><span class="line">3251    张翠山    程序员      2056.0    4000    NaN      20</span><br><span class="line">5566    宋远桥    会计师      7800.0    4000    1000.0   10</span><br><span class="line">7800    张三丰    总裁        NaN      9000    1200.0    20</span><br></pre></td></tr></table></figure>
<p>当然，我们也可以组合多个条件来进行数据筛选，例如从<code>emp_df</code>中筛选出月薪超过<code>3500</code>且部门编号为<code>20</code>的员工，代码如下所示。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">emp_df[(emp_df.sal &gt; <span class="number">3500</span>) &amp; (emp_df.dno == <span class="number">20</span>)]</span><br></pre></td></tr></table></figure>
<p>输出：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">        ename    job        mgr      sal     comm    dno</span><br><span class="line">eno</span><br><span class="line">2056    乔峰      分析师      7800.0   5000   1500.0    20</span><br><span class="line">3251    张翠山     程序员     2056.0   4000    NaN       20</span><br><span class="line">7800    张三丰     总裁       NaN      9000   1200.0    20</span><br></pre></td></tr></table></figure>
<p>除了使用布尔索引，<code>DataFrame</code>对象的<code>query</code>方法也可以实现数据筛选，<code>query</code>方法的参数是一个字符串，它代表了筛选数据使用的表达式，而且更符合 Python 程序员的使用习惯。下面我们使用<code>query</code>方法将上面的效果重新实现一遍，代码如下所示。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">emp_df.query(<span class="string">&#x27;sal &gt; 3500 and dno == 20&#x27;</span>)</span><br></pre></td></tr></table></figure>
<h3 id="数据重塑"><a class="markdownIt-Anchor" href="#数据重塑"></a> 数据重塑</h3>
<p>有的时候，我们做数据分析需要的原始数据可能并不是来自一个地方，就像上一章的例子中，我们从关系型数据库中读取了三张表，得到了三个<code>DataFrame</code>对象，但实际工作可能需要我们把他们的数据整合到一起。例如：<code>emp_df</code>和<code>emp2_df</code>其实都是员工的数据，而且数据结构完全一致，我们可以使用<code>pandas</code>提供的<code>concat</code>函数实现两个或多个<code>DataFrame</code>的数据拼接，代码如下所示。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">all_emp_df = pd.concat([emp_df, emp2_df])</span><br></pre></td></tr></table></figure>
<p>输出：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">        ename    job        mgr      sal     comm    dno</span><br><span class="line">eno</span><br><span class="line">1359    胡一刀    销售员	   3344.0	1800	200.0	30</span><br><span class="line">2056    乔峰	    分析师	    7800.0	 5000	 1500.0	 20</span><br><span class="line">3088    李莫愁	   设计师	   2056.0	3500	800.0	20</span><br><span class="line">3211    张无忌	   程序员	   2056.0	3200	NaN     20</span><br><span class="line">3233    丘处机	   程序员	   2056.0	3400	NaN	    20</span><br><span class="line">3244    欧阳锋	   程序员	   3088.0	3200	NaN     20</span><br><span class="line">3251    张翠山	   程序员	   2056.0	4000	NaN	    20</span><br><span class="line">3344    黄蓉	    销售主管   7800.0	3000	800.0	30</span><br><span class="line">3577    杨过	    会计	     5566.0	  2200	  NaN	  10</span><br><span class="line">3588    朱九真	   会计	    5566.0	 2500	 NaN	 10</span><br><span class="line">4466    苗人凤	   销售员	   3344.0	2500	NaN	    30</span><br><span class="line">5234    郭靖	    出纳	     5566.0	  2000	  NaN	  10</span><br><span class="line">5566    宋远桥	   会计师	   7800.0	4000	1000.0	10</span><br><span class="line">7800    张三丰	   总裁	    NaN      9000	 1200.0	 20</span><br><span class="line">9500	张三丰	   总裁	    NaN	     50000	 8000.0	 20</span><br><span class="line">9600	王大锤    程序员	   9800.0	8000	600.0	20</span><br><span class="line">9700	张三丰	   总裁	    NaN	     60000	 6000.0	 20</span><br><span class="line">9800	骆昊	    架构师	    7800.0	 30000	 5000.0	 20</span><br><span class="line">9900	陈小刀	   分析师	   9800.0	10000	1200.0	20</span><br></pre></td></tr></table></figure>
<p>上面的代码将两个代表员工数据的<code>DataFrame</code>拼接到了一起，接下来我们使用<code>merge</code>函数将员工表和部门表的数据合并到一张表中，代码如下所示。</p>
<p>先使用<code>reset_index</code>方法重新设置<code>all_emp_df</code>的索引，这样<code>eno</code> 不再是索引而是一个普通列，<code>reset_index</code>方法的<code>inplace</code>参数设置为<code>True</code>表示，重置索引的操作直接在<code>all_emp_df</code>上执行，而不是返回修改后的新对象。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">all_emp_df.reset_index(inplace=<span class="literal">True</span>)</span><br></pre></td></tr></table></figure>
<p>通过<code>merge</code>函数合并数据，当然，也可以调用<code>DataFrame</code>对象的<code>merge</code>方法来达到同样的效果。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pd.merge(all_emp_df, dept_df, how=<span class="string">&#x27;inner&#x27;</span>, on=<span class="string">&#x27;dno&#x27;</span>)</span><br></pre></td></tr></table></figure>
<p>输出：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">    eno	    ename	job	     mgr	 sal	 comm	 dno	dname	 dloc</span><br><span class="line">0	1359	胡一刀	 销售员	3344.0	1800	200.0	30	   销售部	 重庆</span><br><span class="line">1	3344	黄蓉	  销售主管	7800.0	3000	800.0	30	   销售部	 重庆</span><br><span class="line">2	4466	苗人凤	 销售员	3344.0	2500	NaN	    30	   销售部	 重庆</span><br><span class="line">3	2056	乔峰	  分析师	 7800.0	 5000	 1500.0	 20	    研发部	  成都</span><br><span class="line">4	3088	李莫愁	 设计师	2056.0	3500	800.0	20	   研发部	 成都</span><br><span class="line">5	3211	张无忌  程序员	2056.0	3200	NaN	    20	   研发部	 成都</span><br><span class="line">6	3233	丘处机	 程序员	2056.0	3400	NaN	    20	   研发部	 成都</span><br><span class="line">7	3244	欧阳锋	 程序员	3088.0	3200	NaN	    20	   研发部	 成都</span><br><span class="line">8	3251	张翠山	 程序员	2056.0	4000	NaN	    20	   研发部	 成都</span><br><span class="line">9	7800	张三丰	 总裁	     NaN	 9000	 1200.0	 20	    研发部	  成都</span><br><span class="line">10	9500	张三丰	 总裁	     NaN	 50000	 8000.0	 20	    研发部	  成都</span><br><span class="line">11	9600	王大锤	 程序员	9800.0	8000	600.0	20	   研发部	 成都</span><br><span class="line">12	9700	张三丰	 总裁	     NaN	 60000	 6000.0	 20	    研发部	  成都</span><br><span class="line">13	9800	骆昊	  架构师	 7800.0	 30000	 5000.0	 20	    研发部	  成都</span><br><span class="line">14	9900	陈小刀	 分析师	9800.0	10000	1200.0	20	   研发部	 成都</span><br><span class="line">15	3577	杨过	  会计	  5566.0  2200	  NaN	  10	会计部	  北京</span><br><span class="line">16	3588	朱九真	 会计	     5566.0	 2500	 NaN	 10	   会计部	 北京</span><br><span class="line">17	5234	郭靖	  出纳	  5566.0  2000	  NaN	  10	会计部	  北京</span><br><span class="line">18	5566	宋远桥	 会计师	7800.0	4000	1000.0	10	  会计部	北京</span><br></pre></td></tr></table></figure>
<p><code>merge</code>函数的一个参数代表合并的左表、第二个参数代表合并的右表，有SQL编程经验的同学对这两个词是不是感觉到非常亲切。正如大家猜想的那样，<code>DataFrame</code>对象的合并跟数据库中的表连接非常类似，所以上面代码中的<code>how</code>代表了合并两张表的方式，有<code>left</code>、<code>right</code>、<code>inner</code>、<code>outer</code>四个选项；而<code>on</code>则代表了基于哪个列实现表的合并，相当于 SQL 表连接中的连表条件，如果左右两表对应的列列名不同，可以用<code>left_on</code>和<code>right_on</code>参数取代<code>on</code>参数分别进行指定。</p>
<p>如果对上面的代码稍作修改，将<code>how</code>参数修改为<code>'right'</code>，大家可以思考一下代码执行的结果。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pd.merge(all_emp_df, dept_df, how=<span class="string">&#x27;right&#x27;</span>, on=<span class="string">&#x27;dno&#x27;</span>)</span><br></pre></td></tr></table></figure>
<p>运行结果比之前的输出多出了如下所示的一行，这是因为<code>how='right'</code>代表右外连接，也就意味着右表<code>dept_df</code>中的数据会被完整的查出来，但是在<code>all_emp_df</code>中又没有编号为<code>40</code> 部门的员工，所以对应的位置都被填入了空值。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">19	NaN    NaN    NaN    NaN    NaN     NaN    40    运维部    深圳</span><br></pre></td></tr></table></figure>
<h3 id="数据清洗"><a class="markdownIt-Anchor" href="#数据清洗"></a> 数据清洗</h3>
<p>通常，我们从 Excel、CSV 或数据库中获取到的数据并不是非常完美的，里面可能因为系统或人为的原因混入了重复值或异常值，也可能在某些字段上存在缺失值；再者，<code>DataFrame</code>中的数据也可能存在格式不统一、量纲不统一等各种问题。因此，在开始数据分析之前，对数据进行清洗就显得特别重要。</p>
<h4 id="缺失值"><a class="markdownIt-Anchor" href="#缺失值"></a> 缺失值</h4>
<p>可以使用<code>DataFrame</code>对象的<code>isnull</code>或<code>isna</code>方法来找出数据表中的缺失值，如下所示。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">emp_df.isnull()</span><br></pre></td></tr></table></figure>
<p>或者</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">emp_df.isna()</span><br></pre></td></tr></table></figure>
<p>输出：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">        ename   job	    mgr     sal     comm    dno</span><br><span class="line">eno						</span><br><span class="line">1359	False	False	False	False	False	False</span><br><span class="line">2056	False	False	False	False	False	False</span><br><span class="line">3088	False	False	False	False	False	False</span><br><span class="line">3211	False	False	False	False	True	False</span><br><span class="line">3233	False	False	False	False	True	False</span><br><span class="line">3244	False	False	False	False	True	False</span><br><span class="line">3251	False	False	False	False	True	False</span><br><span class="line">3344	False	False	False	False	False	False</span><br><span class="line">3577	False	False	False	False	True	False</span><br><span class="line">3588	False	False	False	False	True	False</span><br><span class="line">4466	False	False	False	False	True	False</span><br><span class="line">5234	False	False	False	False	True	False</span><br><span class="line">5566	False	False	False	False	False	False</span><br><span class="line">7800	False	False	True	False	False	False</span><br></pre></td></tr></table></figure>
<p>相对应的，<code>notnull</code>和<code>notna</code>方法可以将非空的值标记为<code>True</code>。如果想删除这些缺失值，可以使用<code>DataFrame</code>对象的<code>dropna</code>方法，该方法的<code>axis</code>参数可以指定沿着0轴还是1轴删除，也就是说当遇到空值时，是删除整行还是删除整列，默认是沿0轴进行删除的，代码如下所示。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">emp_df.dropna()</span><br></pre></td></tr></table></figure>
<p>输出：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">        ename   job      mgr	 sal    comm     dno</span><br><span class="line">eno						</span><br><span class="line">1359	胡一刀  销售员	3344.0	1800   200.0	30</span><br><span class="line">2056	乔峰    架构师	 7800.0	 5000	1500.0	 20</span><br><span class="line">3088	李莫愁  设计师	2056.0	3500   800.0	20</span><br><span class="line">3344	黄蓉    销售主管	7800.0	3000   800.0	30</span><br><span class="line">5566	宋远桥  会计师	7800.0	4000   1000.0	10</span><br></pre></td></tr></table></figure>
<p>如果要沿着1轴进行删除，可以使用下面的代码。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">emp_df.dropna(axis=<span class="number">1</span>)</span><br></pre></td></tr></table></figure>
<p>输出：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">        ename    job      sal    dno</span><br><span class="line">eno				</span><br><span class="line">1359	胡一刀   销售员    1800	30</span><br><span class="line">2056	乔峰     架构师	  5000	 20</span><br><span class="line">3088	李莫愁   设计师    3500	20</span><br><span class="line">3211	张无忌   程序员    3200	20</span><br><span class="line">3233	丘处机   程序员    3400	20</span><br><span class="line">3244	欧阳锋   程序员    3200	20</span><br><span class="line">3251	张翠山   程序员    4000	20</span><br><span class="line">3344	黄蓉     销售主管  3000	30</span><br><span class="line">3577	杨过     会计	   2200	  10</span><br><span class="line">3588	朱九真   会计	  2500	 10</span><br><span class="line">4466	苗人凤   销售员	 2500   30</span><br><span class="line">5234	郭靖     出纳      2000   10</span><br><span class="line">5566	宋远桥   会计师    4000   10</span><br><span class="line">7800	张三丰   总裁      9000   20</span><br></pre></td></tr></table></figure>
<blockquote>
<p><strong>注意</strong>：<code>DataFrame</code>对象的很多方法都有一个名为<code>inplace</code>的参数，该参数的默认值为<code>False</code>，表示我们的操作不会修改原来的<code>DataFrame</code>对象，而是将处理后的结果通过一个新的<code>DataFrame</code>对象返回。如果将该参数的值设置为<code>True</code>，那么我们的操作就会在原来的<code>DataFrame</code>上面直接修改，方法的返回值为<code>None</code>。简单的说，上面的操作并没有修改<code>emp_df</code>，而是返回了一个新的<code>DataFrame</code>对象。</p>
</blockquote>
<p>在某些特定的场景下，我们可以对空值进行填充，对应的方法是<code>fillna</code>，填充空值时可以使用指定的值（通过<code>value</code>参数进行指定），也可以用表格中前一个单元格（通过设置参数<code>method=ffill</code>）或后一个单元格（通过设置参数<code>method=bfill</code>）的值进行填充，当代码如下所示。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">emp_df.fillna(value=<span class="number">0</span>)</span><br></pre></td></tr></table></figure>
<blockquote>
<p><strong>注意</strong>：填充的值如何选择也是一个值得探讨的话题，实际工作中，可能会使用某种统计量（如：均值、众数等）进行填充，或者使用某种插值法（如：随机插值法、拉格朗日插值法等）进行填充，甚至有可能通过回归模型、贝叶斯模型等对缺失数据进行填充。</p>
</blockquote>
<p>输出：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">        ename    job        mgr      sal     comm    dno</span><br><span class="line">eno</span><br><span class="line">1359	胡一刀    销售员	   3344.0	1800	200.0	30</span><br><span class="line">2056	乔峰	    分析师	    7800.0	 5000	 1500.0	 20</span><br><span class="line">3088	李莫愁	   设计师	   2056.0	3500	800.0	20</span><br><span class="line">3211	张无忌	   程序员	   2056.0	3200	0.0     20</span><br><span class="line">3233	丘处机	   程序员	   2056.0	3400	0.0	    20</span><br><span class="line">3244	欧阳锋	   程序员	   3088.0	3200	0.0     20</span><br><span class="line">3251	张翠山	   程序员	   2056.0	4000	0.0	    20</span><br><span class="line">3344	黄蓉	    销售主管   7800.0	3000	800.0	30</span><br><span class="line">3577	杨过	    会计	     5566.0	  2200	  0.0	  10</span><br><span class="line">3588	朱九真	   会计	    5566.0	 2500	 0.0	 10</span><br><span class="line">4466	苗人凤	   销售员	   3344.0	2500	0.0	    30</span><br><span class="line">5234	郭靖	    出纳	     5566.0	  2000	  0.0	  10</span><br><span class="line">5566	宋远桥	   会计师	   7800.0	4000	1000.0	10</span><br><span class="line">7800	张三丰	   总裁	    0.0      9000	 1200.0	 20</span><br></pre></td></tr></table></figure>
<h4 id="重复值"><a class="markdownIt-Anchor" href="#重复值"></a> 重复值</h4>
<p>接下来，我们先给之前的部门表添加两行数据，让部门表中名为“研发部”和“销售部”的部门各有两个。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">dept_df.loc[<span class="number">50</span>] = &#123;<span class="string">&#x27;dname&#x27;</span>: <span class="string">&#x27;研发部&#x27;</span>, <span class="string">&#x27;dloc&#x27;</span>: <span class="string">&#x27;上海&#x27;</span>&#125;</span><br><span class="line">dept_df.loc[<span class="number">60</span>] = &#123;<span class="string">&#x27;dname&#x27;</span>: <span class="string">&#x27;销售部&#x27;</span>, <span class="string">&#x27;dloc&#x27;</span>: <span class="string">&#x27;长沙&#x27;</span>&#125;</span><br><span class="line">dept_df</span><br></pre></td></tr></table></figure>
<p>输出:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">    dname  dloc</span><br><span class="line">dno		</span><br><span class="line">10	会计部	北京</span><br><span class="line">20	研发部	成都</span><br><span class="line">30	销售部	重庆</span><br><span class="line">40	运维部	天津</span><br><span class="line">50	研发部	上海</span><br><span class="line">60	销售部	长沙</span><br></pre></td></tr></table></figure>
<p>现在，我们的数据表中有重复数据了，我们可以通过<code>DataFrame</code>对象的<code>duplicated</code>方法判断是否存在重复值，该方法在不指定参数时默认判断行索引是否重复，我们也可以指定根据部门名称<code>dname</code>判断部门是否重复，代码如下所示。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">dept_df.duplicated(<span class="string">&#x27;dname&#x27;</span>)</span><br></pre></td></tr></table></figure>
<p>输出：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">dno</span><br><span class="line">10    False</span><br><span class="line">20    False</span><br><span class="line">30    False</span><br><span class="line">40    False</span><br><span class="line">50     True</span><br><span class="line">60     True</span><br><span class="line">dtype: bool</span><br></pre></td></tr></table></figure>
<p>从上面的输出可以看到，<code>50</code>和<code>60</code>两个部门从部门名称上来看是重复的，如果要删除重复值，可以使用<code>drop_duplicates</code>方法，该方法的<code>keep</code>参数可以控制在遇到重复值时，保留第一项还是保留最后一项，或者多个重复项一个都不用保留，全部删除掉。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">dept_df.drop_duplicates(<span class="string">&#x27;dname&#x27;</span>)</span><br></pre></td></tr></table></figure>
<p>输出：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">	dname	dloc</span><br><span class="line">dno		</span><br><span class="line">10	会计部	北京</span><br><span class="line">20	研发部	成都</span><br><span class="line">30	销售部	重庆</span><br><span class="line">40	运维部	天津</span><br></pre></td></tr></table></figure>
<p>将<code>keep</code>参数的值修改为<code>last</code>。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">dept_df.drop_duplicates(<span class="string">&#x27;dname&#x27;</span>, keep=<span class="string">&#x27;last&#x27;</span>)</span><br></pre></td></tr></table></figure>
<p>输出：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">	dname	dloc</span><br><span class="line">dno		</span><br><span class="line">10	会计部	北京</span><br><span class="line">40	运维部	天津</span><br><span class="line">50	研发部	上海</span><br><span class="line">60	销售部	长沙</span><br></pre></td></tr></table></figure>
<p>使用同样的方式，我们也可以清除<code>all_emp_df</code>中的重复数据，例如我们认定“ename”和“job”两个字段完全相同的就是重复数据，我们可以用下面的代码去除重复数据。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">all_emp_df.drop_duplicates([<span class="string">&#x27;ename&#x27;</span>, <span class="string">&#x27;job&#x27;</span>], inplace=<span class="literal">True</span>)</span><br></pre></td></tr></table></figure>
<blockquote>
<p><strong>说明</strong>：上面的<code>drop_duplicates</code>方法添加了参数<code>inplace=True</code>，该方法不会返回新的<code>DataFrame</code>对象，而是在原来的<code>DataFrame</code>对象上直接删除，大家可以查看<code>all_emp_df</code>看看是不是已经移除了重复的员工数据。</p>
</blockquote>
<h4 id="异常值"><a class="markdownIt-Anchor" href="#异常值"></a> 异常值</h4>
<p>异常值在统计学上的全称是疑似异常值，也称作离群点（outlier），异常值的分析也称作离群点分析。异常值是指样本中出现的“极端值”，数据值看起来异常大或异常小，其分布明显偏离其余的观测值。实际工作中，有些异常值可能是由系统或人为原因造成的，但有些异常值却不是，它们能够重复且稳定的出现，属于正常的极端值，例如很多游戏产品中头部玩家的数据往往都是离群的极端值。所以，我们既不能忽视异常值的存在，也不能简单地把异常值从数据分析中剔除。重视异常值的出现，分析其产生的原因，常常成为发现问题进而改进决策的契机。</p>
<p>异常值的检测有Z-score 方法、IQR 方法、DBScan 聚类、孤立森林等，这里我们对前两种方法做一个简单的介绍。</p>
<img src="/images/3sigma.png" style="zoom:100%;">
<p>如果数据服从正态分布，依据3σ法则，异常值被定义与平均值的偏差超过三倍标准差的值。在正态分布下，距离平均值3σ之外的值出现的概率为 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathsize="0.9em"><mrow><mi>P</mi><mo stretchy="false">(</mo><mo stretchy="false">∣</mo><mi>x</mi><mo>−</mo><mi>μ</mi><mo stretchy="false">∣</mo><mo>&gt;</mo><mn>3</mn><mi>σ</mi><mo stretchy="false">)</mo><mo>&lt;</mo><mn>0.003</mn></mrow></mstyle></mrow><annotation encoding="application/x-tex">\small{P(\lvert x - \mu \rvert \gt 3 \sigma) &lt; 0.003}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9em;vertical-align:-0.225em;"></span><span class="mord sizing reset-size6 size5"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mopen">∣</span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathnormal">μ</span><span class="mclose">∣</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord">3</span><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord">0</span><span class="mord">.</span><span class="mord">0</span><span class="mord">0</span><span class="mord">3</span></span></span></span></span> ，属于小概率事件。如果数据不服从正态分布，那么可以用远离均值的多少倍的标准差来描述，这里的倍数就是Z-score。Z-score以标准差为单位去度量某一原始分数偏离平均值的距离，公式如下所示。</p>
<p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>z</mi><mo>=</mo><mfrac><mrow><mi>X</mi><mo>−</mo><mi>μ</mi></mrow><mi>σ</mi></mfrac></mrow><annotation encoding="application/x-tex">z = \frac {X - \mu} {\sigma}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.04398em;">z</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:2.0463299999999998em;vertical-align:-0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3603299999999998em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathnormal">μ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p>
<p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mo stretchy="false">∣</mo><mi>z</mi><mo stretchy="false">∣</mo><mo>&gt;</mo><mn>3</mn></mrow><annotation encoding="application/x-tex">\lvert z \rvert &gt; 3
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">∣</span><span class="mord mathnormal" style="margin-right:0.04398em;">z</span><span class="mclose">∣</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">3</span></span></span></span></span></p>
<p>Z-score需要根据经验和实际情况来决定，通常把远离标准差 3 倍距离以上的数据点视为离群点，下面的代给出了如何通过Z-score方法检测异常值。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">detect_outliers_zscore</span>(<span class="params">data, threshold=<span class="number">3</span></span>):</span><br><span class="line">    avg_value = np.mean(data)</span><br><span class="line">    std_value = np.std(data)</span><br><span class="line">    z_score = np.<span class="built_in">abs</span>((data - avg_value) / std_value)</span><br><span class="line">    <span class="keyword">return</span> data[z_score &gt; threshold]</span><br></pre></td></tr></table></figure>
<p>IQR 方法中的 IQR（Inter-Quartile Range）代表四分位距离，即上四分位数（Q3）和下四分位数（Q1）的差值。通常情况下，可以认为小于 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathsize="0.9em"><mrow><mi>Q</mi><mn>1</mn><mo>−</mo><mn>1.5</mn><mo>×</mo><mi>I</mi><mi>Q</mi><mi>R</mi></mrow></mstyle></mrow><annotation encoding="application/x-tex">\small{Q1 - 1.5 \times IQR}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7899930000000001em;vertical-align:-0.174996em;"></span><span class="mord sizing reset-size6 size5"><span class="mord mathnormal">Q</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord">1</span><span class="mord">.</span><span class="mord">5</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">I</span><span class="mord mathnormal">Q</span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span></span></span></span></span> 或大于 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathsize="0.9em"><mrow><mi>Q</mi><mn>3</mn><mo>+</mo><mn>1.5</mn><mo>×</mo><mi>I</mi><mi>Q</mi><mi>R</mi></mrow></mstyle></mrow><annotation encoding="application/x-tex">\small{Q3 + 1.5 \times IQR}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7899930000000001em;vertical-align:-0.174996em;"></span><span class="mord sizing reset-size6 size5"><span class="mord mathnormal">Q</span><span class="mord">3</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord">1</span><span class="mord">.</span><span class="mord">5</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">I</span><span class="mord mathnormal">Q</span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span></span></span></span></span> 的就是异常值，而这种检测异常值的方法也是箱线图（后面会讲到）默认使用的方法。下面的代码给出了如何通过 IQR 方法检测异常值。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">detect_outliers_iqr</span>(<span class="params">data, whis=<span class="number">1.5</span></span>):</span><br><span class="line">    q1, q3 = np.quantile(data, [<span class="number">0.25</span>, <span class="number">0.75</span>])</span><br><span class="line">    iqr = q3 - q1</span><br><span class="line">    lower, upper = q1 - whis * iqr, q3 + whis * iqr</span><br><span class="line">    <span class="keyword">return</span> data[(data &lt; lower) | (data &gt; upper)]</span><br></pre></td></tr></table></figure>
<p>如果要删除异常值，可以使用<code>DataFrame</code>对象的<code>drop</code>方法，该方法可以根据行索引或列索引删除指定的行或列。例如我们认为月薪低于<code>2000</code>或高于<code>8000</code>的是员工表中的异常值，可以用下面的代码删除对应的记录。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">emp_df.drop(emp_df[(emp_df.sal &gt; <span class="number">8000</span>) | (emp_df.sal &lt; <span class="number">2000</span>)].index)</span><br></pre></td></tr></table></figure>
<p>如果要替换掉异常值，可以通过给单元格赋值的方式来实现，也可以使用<code>replace</code>方法将指定的值替换掉。例如我们要将月薪为<code>1800</code>和<code>9000</code>的替换为月薪的平均值，补贴为<code>800</code>的替换为<code>1000</code>，代码如下所示。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">avg_sal = np.mean(emp_df.sal).astype(<span class="built_in">int</span>)</span><br><span class="line">emp_df.replace(&#123;<span class="string">&#x27;sal&#x27;</span>: [<span class="number">1800</span>, <span class="number">9000</span>], <span class="string">&#x27;comm&#x27;</span>: <span class="number">800</span>&#125;, &#123;<span class="string">&#x27;sal&#x27;</span>: avg_sal, <span class="string">&#x27;comm&#x27;</span>: <span class="number">1000</span>&#125;)</span><br></pre></td></tr></table></figure>
<h4 id="预处理"><a class="markdownIt-Anchor" href="#预处理"></a> 预处理</h4>
<p>对数据进行预处理也是一个很大的话题，它包含了对数据的拆解、变换、归约、离散化等操作。我们先来看看数据的拆解。如果数据表中的数据是一个时间日期，我们通常都需要从年、季度、月、日、星期、小时、分钟等维度对其进行拆解，如果时间日期是用字符串表示的，可以先通过<code>pandas</code>的<code>to_datetime</code>函数将其处理成时间日期。</p>
<p>在下面的例子中，我们先读取 Excel 文件，获取到一组销售数据，其中第一列就是销售日期，我们将其拆解为“月份”、“季度”和“星期”，代码如下所示。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">sales_df = pd.read_excel(</span><br><span class="line">    <span class="string">&#x27;data/2020年销售数据.xlsx&#x27;</span>,</span><br><span class="line">    usecols=[<span class="string">&#x27;销售日期&#x27;</span>, <span class="string">&#x27;销售区域&#x27;</span>, <span class="string">&#x27;销售渠道&#x27;</span>, <span class="string">&#x27;品牌&#x27;</span>, <span class="string">&#x27;销售额&#x27;</span>]</span><br><span class="line">)</span><br><span class="line">sales_df.info()</span><br></pre></td></tr></table></figure>
<blockquote>
<p><strong>说明</strong>：上面代码中使用了相对路径来获取 Excel 文件，也就是说 Excel 文件在当前工作路径下名为<code>data</code>的文件夹中。如果需要上面例子中的 Excel 文件，可以通过下面的百度云盘地址进行获取。链接：<a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1rQujl5RQn9R7PadB2Z5g_g">https://pan.baidu.com/s/1rQujl5RQn9R7PadB2Z5g_g</a>，提取码：e7b4。</p>
</blockquote>
<p>输出：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&lt;class &#x27;pandas.core.frame.DataFrame&#x27;&gt;</span><br><span class="line">RangeIndex: 1945 entries, 0 to 1944</span><br><span class="line">Data columns (total 5 columns):</span><br><span class="line"> #   Column  Non-Null Count  Dtype         </span><br><span class="line">---  ------  --------------  -----         </span><br><span class="line"> 0   销售日期    1945 non-null   datetime64[ns]</span><br><span class="line"> 1   销售区域    1945 non-null   object        </span><br><span class="line"> 2   销售渠道    1945 non-null   object        </span><br><span class="line"> 3   品牌        1945 non-null   object        </span><br><span class="line"> 4   销售额      1945 non-null   int64         </span><br><span class="line">dtypes: datetime64[ns](1), int64(1), object(3)</span><br><span class="line">memory usage: 76.1+ KB</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">sales_df[<span class="string">&#x27;月份&#x27;</span>] = sales_df[<span class="string">&#x27;销售日期&#x27;</span>].dt.month</span><br><span class="line">sales_df[<span class="string">&#x27;季度&#x27;</span>] = sales_df[<span class="string">&#x27;销售日期&#x27;</span>].dt.quarter</span><br><span class="line">sales_df[<span class="string">&#x27;星期&#x27;</span>] = sales_df[<span class="string">&#x27;销售日期&#x27;</span>].dt.weekday</span><br><span class="line">sales_df</span><br></pre></td></tr></table></figure>
<p>输出：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">	    销售日期	 销售区域	销售渠道	品牌	  销售额	月份	季度	星期</span><br><span class="line">0	    2020-01-01	上海	     拼多多	 八匹马   8217	    1	 1	   2</span><br><span class="line">1	    2020-01-01	上海	     抖音	      八匹马	6351	 1	  1	    2</span><br><span class="line">2	    2020-01-01	上海	     天猫	      八匹马	14365	 1	  1	    2</span><br><span class="line">3	    2020-01-01	上海	     天猫       八匹马	2366	 1	  1     2</span><br><span class="line">4	    2020-01-01	上海	     天猫 	  皮皮虾	15189	 1	  1     2</span><br><span class="line">...     ...         ...        ...       ...      ...     ...  ...   ...</span><br><span class="line">1940    2020-12-30	北京	     京东	      花花姑娘 6994     12	 4	   2</span><br><span class="line">1941    2020-12-30	福建	     实体	      八匹马	7663	 12	  4	    2</span><br><span class="line">1942    2020-12-31	福建	     实体	      花花姑娘 14795    12	 4	   3</span><br><span class="line">1943    2020-12-31	福建	     抖音	      八匹马	3481	 12	  4	    3</span><br><span class="line">1944    2020-12-31	福建	     天猫	      八匹马	2673	 12	  4	    3</span><br></pre></td></tr></table></figure>
<p>在上面的代码中，通过日期时间类型的<code>Series</code>对象的<code>dt</code> 属性，获得一个访问日期时间的对象，通过该对象的<code>year</code>、<code>month</code>、<code>quarter</code>、<code>hour</code>等属性，就可以获取到年、月、季度、小时等时间信息，获取到的仍然是一个<code>Series</code>对象，它包含了一组时间信息，所以我们通常也将这个<code>dt</code>属性称为“日期时间向量”。</p>
<p>我们再来说一说字符串类型的数据的处理，我们先从指定的 Excel 文件中读取某招聘网站的招聘数据。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">jobs_df = pd.read_csv(</span><br><span class="line">    <span class="string">&#x27;data/某招聘网站招聘数据.csv&#x27;</span>,</span><br><span class="line">    usecols=[<span class="string">&#x27;city&#x27;</span>, <span class="string">&#x27;companyFullName&#x27;</span>, <span class="string">&#x27;positionName&#x27;</span>, <span class="string">&#x27;salary&#x27;</span>]</span><br><span class="line">)</span><br><span class="line">jobs_df.info()</span><br></pre></td></tr></table></figure>
<blockquote>
<p><strong>说明</strong>：上面代码中使用了相对路径来获取 CSV 文件，也就是说 CSV 文件在当前工作路径下名为<code>data</code>的文件夹中。如果需要上面例子中的 CSV 文件，可以通过下面的百度云盘地址进行获取。链接：<a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1rQujl5RQn9R7PadB2Z5g_g">https://pan.baidu.com/s/1rQujl5RQn9R7PadB2Z5g_g</a>，提取码：e7b4。</p>
</blockquote>
<p>输出：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&lt;class &#x27;pandas.core.frame.DataFrame&#x27;&gt;</span><br><span class="line">RangeIndex: 3140 entries, 0 to 3139</span><br><span class="line">Data columns (total 4 columns):</span><br><span class="line"> #   Column           Non-Null Count  Dtype </span><br><span class="line">---  ------           --------------  ----- </span><br><span class="line"> 0   city             3140 non-null   object</span><br><span class="line"> 1   companyFullName  3140 non-null   object</span><br><span class="line"> 2   positionName     3140 non-null   object</span><br><span class="line"> 3   salary           3140 non-null   object</span><br><span class="line">dtypes: object(4)</span><br><span class="line">memory usage: 98.2+ KB</span><br></pre></td></tr></table></figure>
<p>查看前<code>5</code>条数据。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">jobs_df.head()</span><br></pre></td></tr></table></figure>
<p>输出：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">    city    companyFullName              positionName    salary</span><br><span class="line">0   北京	  达疆网络科技（上海）有限公司    数据分析岗       15k-30k</span><br><span class="line">1   北京	  北京音娱时光科技有限公司        数据分析        10k-18k</span><br><span class="line">2   北京	  北京千喜鹤餐饮管理有限公司	     数据分析        20k-30k</span><br><span class="line">3   北京	  吉林省海生电子商务有限公司	     数据分析        33k-50k</span><br><span class="line">4   北京	  韦博网讯科技（北京）有限公司	数据分析        10k-15k</span><br></pre></td></tr></table></figure>
<p>上面的数据表一共有<code>3140</code>条数据，但并非所有的职位都是“数据分析”的岗位，如果要筛选出数据分析的岗位，可以通过检查<code>positionName</code>字段是否包含“数据分析”这个关键词，这里需要模糊匹配，应该如何实现呢？我们可以先获取<code>positionName</code>列，因为这个<code>Series</code>对象的<code>dtype</code>是字符串，所以可以通过<code>str</code>属性获取对应的字符串向量，然后就可以利用我们熟悉的字符串的方法来对其进行操作，代码如下所示。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">jobs_df = jobs_df[jobs_df.positionName.<span class="built_in">str</span>.contains(<span class="string">&#x27;数据分析&#x27;</span>)]</span><br><span class="line">jobs_df.shape</span><br></pre></td></tr></table></figure>
<p>输出：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(1515, 4)</span><br></pre></td></tr></table></figure>
<p>可以看出，筛选后的数据还有<code>1515</code>条。接下来，我们还需要对<code>salary</code>字段进行处理，如果我们希望统计所有岗位的平均工资或每个城市的平均工资，首先需要将用范围表示的工资处理成其中间值，代码如下所示。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">jobs_df.salary.<span class="built_in">str</span>.extract(<span class="string">r&#x27;(\d+)[kK]?-(\d+)[kK]?&#x27;</span>)</span><br></pre></td></tr></table></figure>
<blockquote>
<p><strong>说明</strong>：上面的代码通过正则表达式捕获组从字符串中抽取出两组数字，分别对应工资的下限和上限，对正则表达式不熟悉的读者，可以阅读我的知乎专栏“从零开始学Python”中的<a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/158929767">《正则表达式的应用》</a>一文。</p>
</blockquote>
<p>输出：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">        0     1</span><br><span class="line">0	    15    30</span><br><span class="line">1	    10	  18</span><br><span class="line">2       20    30</span><br><span class="line">3       33    50</span><br><span class="line">4       10    15</span><br><span class="line">...     ...   ...</span><br><span class="line">3065    8     10</span><br><span class="line">3069    6     10</span><br><span class="line">3070    2     4</span><br><span class="line">3071    6     12</span><br><span class="line">3088    8     12</span><br></pre></td></tr></table></figure>
<p>需要提醒大家的是，抽取出来的两列数据都是字符串类型的值，我们需要将其转换成<code>int</code>类型，才能计算平均值，对应的方法是<code>DataFrame</code>对象的<code>applymap</code>方法，该方法的参数是一个函数，而该函数会作用于<code>DataFrame</code>中的每个元素。完成这一步之后，我们就可以使用<code>apply</code>方法将上面的<code>DataFrame</code>处理成中间值，<code>apply</code>方法的参数也是一个函数，可以通过指定<code>axis</code>参数使其作用于<code>DataFrame</code> 对象的行或列，代码如下所示。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">temp_df = jobs_df.salary.<span class="built_in">str</span>.extract(<span class="string">r&#x27;(\d+)[kK]?-(\d+)[kK]?&#x27;</span>).applymap(<span class="built_in">int</span>)</span><br><span class="line">temp_df.apply(np.mean, axis=<span class="number">1</span>)</span><br></pre></td></tr></table></figure>
<p>输出：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">0       22.5</span><br><span class="line">1       14.0</span><br><span class="line">2       25.0</span><br><span class="line">3       41.5</span><br><span class="line">4       12.5</span><br><span class="line">        ... </span><br><span class="line">3065    9.0</span><br><span class="line">3069    8.0</span><br><span class="line">3070    3.0</span><br><span class="line">3071    9.0</span><br><span class="line">3088    10.0</span><br><span class="line">Length: 1515, dtype: float64</span><br></pre></td></tr></table></figure>
<p>接下来，我们可以用上面的结果替换掉原来的<code>salary</code>列或者增加一个新的列来表示职位对应的工资，完整的代码如下所示。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">temp_df = jobs_df.salary.<span class="built_in">str</span>.extract(<span class="string">r&#x27;(\d+)[kK]?-(\d+)[kK]?&#x27;</span>).applymap(<span class="built_in">int</span>)</span><br><span class="line">jobs_df[<span class="string">&#x27;salary&#x27;</span>] = temp_df.apply(np.mean, axis=<span class="number">1</span>)</span><br><span class="line">jobs_df.head()</span><br></pre></td></tr></table></figure>
<p>输出：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">    city    companyFullName              positionName    salary</span><br><span class="line">0   北京	  达疆网络科技（上海）有限公司    数据分析岗       22.5</span><br><span class="line">1   北京	  北京音娱时光科技有限公司        数据分析        14.0</span><br><span class="line">2   北京	  北京千喜鹤餐饮管理有限公司	     数据分析        25.0</span><br><span class="line">3   北京	  吉林省海生电子商务有限公司	     数据分析        41.5</span><br><span class="line">4   北京	  韦博网讯科技（北京）有限公司	数据分析        12.5</span><br></pre></td></tr></table></figure>
<p><code>applymap</code>和<code>apply</code>两个方法在数据预处理的时候经常用到，<code>Series</code>对象也有<code>apply</code>方法，也是用于数据的预处理，但是<code>DataFrame</code>对象还有一个名为<code>transform</code> 的方法，也是通过传入的函数对数据进行变换，类似<code>Series</code>对象的<code>map</code>方法。需要强调的是，<code>apply</code>方法具有归约效果的，简单的说就是能将较多的数据处理成较少的数据或一条数据；而<code>transform</code>方法没有归约效果，只能对数据进行变换，原来有多少条数据，处理后还是有多少条数据。</p>
<p>如果要对数据进行深度的分析和挖掘，字符串、日期时间这样的非数值类型都需要处理成数值，因为非数值类型没有办法计算相关性，也没有办法进行 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathsize="0.9em"><msup><mi>χ</mi><mn>2</mn></msup></mstyle></mrow><annotation encoding="application/x-tex">\small{\chi^{2}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.88836em;vertical-align:-0.174996em;"></span><span class="mord sizing reset-size6 size5"><span class="mord"><span class="mord mathnormal">χ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7926266666666666em;"><span style="top:-2.963em;margin-right:0.05555555555555556em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span></span></span> 检验等操作。对于字符串类型，通常可以其分为以下三类，再进行对应的处理。</p>
<ol>
<li>有序变量（Ordinal Variable）：字符串表示的数据有顺序关系，那么可以对字符串进行序号化处理。</li>
<li>分类变量（Categorical Variable）/ 名义变量（Nominal Variable）：字符串表示的数据没有大小关系和等级之分，那么就可以使用独热编码的方式处理成哑变量（虚拟变量）矩阵。</li>
<li>定距变量（Scale Variable）：字符串本质上对应到一个有大小高低之分的数据，而且可以进行加减运算，那么只需要将字符串处理成对应的数值即可。</li>
</ol>
<p>对于第1类和第3类，我们可以用上面提到的<code>apply</code>或<code>transform</code>方法来处理，也可以利用<code>scikit-learn</code>中的<code>OrdinalEncoder</code>处理第1类字符串，这个我们在后续的课程中会讲到。对于第2类字符串，可以使用<code>pandas</code>的<code>get_dummies()</code>函数来生成哑变量（虚拟变量）矩阵，代码如下所示。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">persons_df = pd.DataFrame(</span><br><span class="line">    data=&#123;</span><br><span class="line">        <span class="string">&#x27;姓名&#x27;</span>: [<span class="string">&#x27;关羽&#x27;</span>, <span class="string">&#x27;张飞&#x27;</span>, <span class="string">&#x27;赵云&#x27;</span>, <span class="string">&#x27;马超&#x27;</span>, <span class="string">&#x27;黄忠&#x27;</span>],</span><br><span class="line">        <span class="string">&#x27;职业&#x27;</span>: [<span class="string">&#x27;医生&#x27;</span>, <span class="string">&#x27;医生&#x27;</span>, <span class="string">&#x27;程序员&#x27;</span>, <span class="string">&#x27;画家&#x27;</span>, <span class="string">&#x27;教师&#x27;</span>],</span><br><span class="line">        <span class="string">&#x27;学历&#x27;</span>: [<span class="string">&#x27;研究生&#x27;</span>, <span class="string">&#x27;大专&#x27;</span>, <span class="string">&#x27;研究生&#x27;</span>, <span class="string">&#x27;高中&#x27;</span>, <span class="string">&#x27;本科&#x27;</span>]</span><br><span class="line">    &#125;</span><br><span class="line">)</span><br><span class="line">persons_df</span><br></pre></td></tr></table></figure>
<p>输出：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">	姓名	职业	学历</span><br><span class="line">0	关羽	医生	研究生</span><br><span class="line">1	张飞	医生	大专</span><br><span class="line">2	赵云	程序员	研究生</span><br><span class="line">3	马超	画家	高中</span><br><span class="line">4	黄忠	教师	本科</span><br></pre></td></tr></table></figure>
<p>将职业处理成哑变量矩阵。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pd.get_dummies(persons_df[<span class="string">&#x27;职业&#x27;</span>])</span><br></pre></td></tr></table></figure>
<p>输出：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">    医生 教师  画家  程序员</span><br><span class="line">0	1    0    0    0</span><br><span class="line">1	1    0    0    0</span><br><span class="line">2	0    0    0    1</span><br><span class="line">3	0    0    1    0</span><br><span class="line">4	0    1    0    0</span><br></pre></td></tr></table></figure>
<p>将学历处理成大小不同的值。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">handle_education</span>(<span class="params">x</span>):</span><br><span class="line">    edu_dict = &#123;<span class="string">&#x27;高中&#x27;</span>: <span class="number">1</span>, <span class="string">&#x27;大专&#x27;</span>: <span class="number">3</span>, <span class="string">&#x27;本科&#x27;</span>: <span class="number">5</span>, <span class="string">&#x27;研究生&#x27;</span>: <span class="number">10</span>&#125;</span><br><span class="line">    <span class="keyword">return</span> edu_dict.get(x, <span class="number">0</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">persons_df[<span class="string">&#x27;学历&#x27;</span>].apply(handle_education)</span><br></pre></td></tr></table></figure>
<p>输出：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">0    10</span><br><span class="line">1     3</span><br><span class="line">2    10</span><br><span class="line">3     1</span><br><span class="line">4     5</span><br><span class="line">Name: 学历, dtype: int64</span><br></pre></td></tr></table></figure>
<p>我们再来说说数据离散化。离散化也叫分箱，如果变量的取值是连续值，那么它的取值有无数种可能，在进行数据分组的时候就会非常的不方便，这个时候将连续变量离散化就显得非常重要。之所以把离散化叫做分箱，是因为我们可以预先设置一些箱子，每个箱子代表了数据取值的范围，这样就可以将连续的值分配到不同的箱子中，从而实现离散化。下面的例子读取了2018年北京积分落户数据，我们可以根据落户积分对数据进行分组，具体的做法如下所示。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">luohu_df = pd.read_csv(<span class="string">&#x27;data/2018年北京积分落户数据.csv&#x27;</span>, index_col=<span class="string">&#x27;id&#x27;</span>)</span><br><span class="line">luohu_df.score.describe()</span><br></pre></td></tr></table></figure>
<p>输出：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">count    6019.000000</span><br><span class="line">mean       95.654552</span><br><span class="line">std         4.354445</span><br><span class="line">min        90.750000</span><br><span class="line">25%        92.330000</span><br><span class="line">50%        94.460000</span><br><span class="line">75%        97.750000</span><br><span class="line">max       122.590000</span><br><span class="line">Name: score, dtype: float64</span><br></pre></td></tr></table></figure>
<p>可以看出，落户积分的最大值是<code>122.59</code>，最小值是<code>90.75</code>，那么我们可以构造一个从<code>90</code>分到<code>125</code>分，每<code>5</code>分一组的<code>7</code>个箱子，<code>pandas</code>的<code>cut</code>函数可以帮助我们首先数据分箱，代码如下所示。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">bins = np.arange(<span class="number">90</span>, <span class="number">126</span>, <span class="number">5</span>)</span><br><span class="line">pd.cut(luohu_df.score, bins, right=<span class="literal">False</span>)</span><br></pre></td></tr></table></figure>
<blockquote>
<p><strong>说明</strong>：<code>cut</code>函数的<code>right</code>参数默认值为<code>True</code>，表示箱子左开右闭；修改为<code>False</code>可以让箱子的右边界为开区间，左边界为闭区间，大家看看下面的输出就明白了。</p>
</blockquote>
<p>输出：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">id</span><br><span class="line">1       [120, 125)</span><br><span class="line">2       [120, 125)</span><br><span class="line">3       [115, 120)</span><br><span class="line">4       [115, 120)</span><br><span class="line">5       [115, 120)</span><br><span class="line">           ...    </span><br><span class="line">6015      [90, 95)</span><br><span class="line">6016      [90, 95)</span><br><span class="line">6017      [90, 95)</span><br><span class="line">6018      [90, 95)</span><br><span class="line">6019      [90, 95)</span><br><span class="line">Name: score, Length: 6019, dtype: category</span><br><span class="line">Categories (7, interval[int64, left]): [[90, 95) &lt; [95, 100) &lt; [100, 105) &lt; [105, 110) &lt; [110, 115) &lt; [115, 120) &lt; [120, 125)]</span><br></pre></td></tr></table></figure>
<p>我们可以根据分箱的结果对数据进行分组，然后使用聚合函数对每个组进行统计，这是数据分析中经常用到的操作，下一个章节会为大家介绍。除此之外，<code>pandas</code>还提供了一个名为<code>qcut</code>的函数，可以指定分位数对数据进行分箱，有兴趣的读者可以自行研究。</p>
<h3 id="数据透视"><a class="markdownIt-Anchor" href="#数据透视"></a> 数据透视</h3>
<p>经过前面的学习，我们已经将数据准备就绪而且变成了我们想要的样子，接下来就是最为重要的数据透视阶段了。当我们拿到一大堆数据的时候，如何从数据中迅速的解读出有价值的信息，把繁杂的数据变成容易解读的统计图表并再此基础上产生业务洞察，这就是数据分析要解决的核心问题。</p>
<h4 id="获取描述性统计信息"><a class="markdownIt-Anchor" href="#获取描述性统计信息"></a> 获取描述性统计信息</h4>
<p>首先，我们可以获取数据的描述性统计信息，通过描述性统计信息，我们可以了解数据的集中趋势和离散趋势。</p>
<p>例如，我们有如下所示的学生成绩表。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">scores = np.random.randint(<span class="number">50</span>, <span class="number">101</span>, (<span class="number">5</span>, <span class="number">3</span>))</span><br><span class="line">names = (<span class="string">&#x27;关羽&#x27;</span>, <span class="string">&#x27;张飞&#x27;</span>, <span class="string">&#x27;赵云&#x27;</span>, <span class="string">&#x27;马超&#x27;</span>, <span class="string">&#x27;黄忠&#x27;</span>)</span><br><span class="line">courses = (<span class="string">&#x27;语文&#x27;</span>, <span class="string">&#x27;数学&#x27;</span>, <span class="string">&#x27;英语&#x27;</span>)</span><br><span class="line">df = pd.DataFrame(data=scores, columns=courses, index=names)</span><br><span class="line">df</span><br></pre></td></tr></table></figure>
<p>输出：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">     语文   数学   英语</span><br><span class="line">关羽  96    72    73</span><br><span class="line">张飞  72    70	97</span><br><span class="line">赵云  74    51	79</span><br><span class="line">马超  100   54	54</span><br><span class="line">黄忠  89    100	88</span><br></pre></td></tr></table></figure>
<p>我们可以通过<code>DataFrame</code>对象的方法<code>mean</code>、<code>max</code>、<code>min</code>、<code>std</code>、<code>var</code>等方法分别获取每个学生或每门课程的平均分、最高分、最低分、标准差、方差等信息，也可以直接通过<code>describe</code>方法直接获取描述性统计信息，代码如下所示。</p>
<p>计算每门课程成绩的平均分。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.mean()</span><br></pre></td></tr></table></figure>
<p>输出：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">语文    86.2</span><br><span class="line">数学    69.4</span><br><span class="line">英语    78.2</span><br><span class="line">dtype: float64</span><br></pre></td></tr></table></figure>
<p>计算每个学生成绩的平均分。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.mean(axis=<span class="number">1</span>)</span><br></pre></td></tr></table></figure>
<p>输出：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">关羽    80.333333</span><br><span class="line">张飞    79.666667</span><br><span class="line">赵云    68.000000</span><br><span class="line">马超    69.333333</span><br><span class="line">黄忠    92.333333</span><br><span class="line">dtype: float64</span><br></pre></td></tr></table></figure>
<p>计算每门课程成绩的方差。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.var()</span><br></pre></td></tr></table></figure>
<p>输出：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">语文    161.2</span><br><span class="line">数学    379.8</span><br><span class="line">英语    265.7</span><br><span class="line">dtype: float64</span><br></pre></td></tr></table></figure>
<blockquote>
<p><strong>说明</strong>：通过方差可以看出，数学成绩波动最大，两极分化可能更严重。</p>
</blockquote>
<p>获取每门课程的描述性统计信息。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.describe()</span><br></pre></td></tr></table></figure>
<p>输出：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">        语文        数学         英语</span><br><span class="line">count   5.000000	5.000000	5.000000</span><br><span class="line">mean    86.200000	69.400000	78.200000</span><br><span class="line">std     12.696456	19.488458	16.300307</span><br><span class="line">min     72.000000	51.000000	54.000000</span><br><span class="line">25%     74.000000	54.000000	73.000000</span><br><span class="line">50%     89.000000	70.000000	79.000000</span><br><span class="line">75%     96.000000	72.000000	88.000000</span><br><span class="line">max     100.000000	100.000000	97.000000</span><br></pre></td></tr></table></figure>
<h4 id="排序和取头部值"><a class="markdownIt-Anchor" href="#排序和取头部值"></a> 排序和取头部值</h4>
<p>如果需要对数据进行排序，可以使用<code>DataFrame</code>对象的<code>sort_values</code>方法，该方法的<code>by</code>参数可以指定根据哪个列或哪些列进行排序，而<code>ascending</code>参数可以指定升序或是降序。例如，下面的代码展示了如何将学生表按语文成绩排降序。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.sort_values(by=<span class="string">&#x27;语文&#x27;</span>, ascending=<span class="literal">False</span>)</span><br></pre></td></tr></table></figure>
<p>输出：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">      语文   数学   英语</span><br><span class="line">马超	100    54	  54</span><br><span class="line">关羽	96     72     73</span><br><span class="line">黄忠	89     100    88</span><br><span class="line">赵云	74     51     79</span><br><span class="line">张飞	72     70     97</span><br></pre></td></tr></table></figure>
<p>如果<code>DataFrame</code>数据量很大，排序将是一个非常耗费时间的操作。有的时候我们只需要获得排前N名或后N名的数据，这个时候其实没有必要对整个数据进行排序，而是直接利用堆结构找出Top-N的数据。<code>DataFrame</code>的<code>nlargest</code>和<code>nsmallest</code>方法就提供对Top-N操作的支持，代码如下所示。</p>
<p>找出语文成绩前3名的学生信息。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.nlargest(<span class="number">3</span>, <span class="string">&#x27;语文&#x27;</span>)</span><br></pre></td></tr></table></figure>
<p>输出：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">      语文   数学   英语</span><br><span class="line">马超	100    54	  54</span><br><span class="line">关羽	96     72     73</span><br><span class="line">黄忠	89     100    88</span><br></pre></td></tr></table></figure>
<p>找出数学成绩最低的3名学生的信息。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.nsmallest(<span class="number">3</span>, <span class="string">&#x27;数学&#x27;</span>)</span><br></pre></td></tr></table></figure>
<p>输出：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">      语文  数学  英语</span><br><span class="line">赵云  74    51	79</span><br><span class="line">马超  100   54	54</span><br><span class="line">张飞  72    70	97</span><br></pre></td></tr></table></figure>
<h4 id="分组聚合"><a class="markdownIt-Anchor" href="#分组聚合"></a> 分组聚合</h4>
<p>我们先从之前使用过的 Excel 文件中读取2020年销售数据，然后再为大家演示如何进行分组聚合操作。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">df = pd.read_excel(<span class="string">&#x27;data/2020年销售数据.xlsx&#x27;</span>)</span><br><span class="line">df.head()</span><br></pre></td></tr></table></figure>
<p>输出：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">    销售日期	 销售区域   销售渠道  销售订单     品牌    售价  销售数量</span><br><span class="line">0   2020-01-01  上海       拼多多    182894-455  八匹马  99    83</span><br><span class="line">1   2020-01-01  上海       抖音      205635-402  八匹马  219   29</span><br><span class="line">2   2020-01-01  上海       天猫      205654-021  八匹马  169   85</span><br><span class="line">3   2020-01-01  上海       天猫      205654-519  八匹马  169   14</span><br><span class="line">4   2020-01-01  上海       天猫      377781-010  皮皮虾  249   61</span><br></pre></td></tr></table></figure>
<p>如果我们要统计每个销售区域的销售总额，可以先通过“售价”和“销售数量”计算出销售额，为<code>DataFrame</code>添加一个列，代码如下所示。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">df[<span class="string">&#x27;销售额&#x27;</span>] = df[<span class="string">&#x27;售价&#x27;</span>] * df[<span class="string">&#x27;销售数量&#x27;</span>]</span><br><span class="line">df.head()</span><br></pre></td></tr></table></figure>
<p>输出：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">    销售日期	 销售区域   销售渠道  销售订单     品牌    售价  销售数量  销售额</span><br><span class="line">0   2020-01-01  上海       拼多多    182894-455  八匹马  99    83        8217</span><br><span class="line">1   2020-01-01  上海       抖音      205635-402  八匹马  219   29        6351</span><br><span class="line">2   2020-01-01  上海       天猫      205654-021  八匹马  169   85        14365</span><br><span class="line">3   2020-01-01  上海       天猫      205654-519  八匹马  169   14        2366</span><br><span class="line">4   2020-01-01  上海       天猫      377781-010  皮皮虾  249   61        15189</span><br></pre></td></tr></table></figure>
<p>然后再根据“销售区域”列对数据进行分组，这里我们使用的是<code>DataFrame</code>对象的<code>groupby</code>方法。分组之后，我们取“销售额”这个列在分组内进行求和处理，代码和结果如下所示。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.groupby(<span class="string">&#x27;销售区域&#x27;</span>).销售额.<span class="built_in">sum</span>()</span><br></pre></td></tr></table></figure>
<p>输出：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">销售区域</span><br><span class="line">上海    11610489</span><br><span class="line">北京    12477717</span><br><span class="line">安徽      895463</span><br><span class="line">广东     1617949</span><br><span class="line">江苏     2304380</span><br><span class="line">浙江      687862</span><br><span class="line">福建    10178227</span><br><span class="line">Name: 销售额, dtype: int64</span><br></pre></td></tr></table></figure>
<p>如果我们要统计每个月的销售总额，我们可以将“销售日期”作为groupby`方法的参数，当然这里需要先将“销售日期”处理成月，代码和结果如下所示。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.groupby(df[<span class="string">&#x27;销售日期&#x27;</span>].dt.month).销售额.<span class="built_in">sum</span>()</span><br></pre></td></tr></table></figure>
<p>输出：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">销售日期</span><br><span class="line">1     5409855</span><br><span class="line">2     4608455</span><br><span class="line">3     4164972</span><br><span class="line">4     3996770</span><br><span class="line">5     3239005</span><br><span class="line">6     2817936</span><br><span class="line">7     3501304</span><br><span class="line">8     2948189</span><br><span class="line">9     2632960</span><br><span class="line">10    2375385</span><br><span class="line">11    2385283</span><br><span class="line">12    1691973</span><br><span class="line">Name: 销售额, dtype: int64</span><br></pre></td></tr></table></figure>
<p>接下来我们将难度升级，统计每个销售区域每个月的销售总额，这又该如何处理呢？事实上，<code>groupby</code>方法的第一个参数可以是一个列表，列表中可以指定多个分组的依据，大家看看下面的代码和输出结果就明白了。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.groupby([<span class="string">&#x27;销售区域&#x27;</span>, df[<span class="string">&#x27;销售日期&#x27;</span>].dt.month]).销售额.<span class="built_in">sum</span>()</span><br></pre></td></tr></table></figure>
<p>输出：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line">销售区域  销售日期</span><br><span class="line">上海    1       1679125</span><br><span class="line">        2       1689527</span><br><span class="line">        3       1061193</span><br><span class="line">        4       1082187</span><br><span class="line">        5        841199</span><br><span class="line">        6        785404</span><br><span class="line">        7        863906</span><br><span class="line">        8        734937</span><br><span class="line">        9       1107693</span><br><span class="line">        10       412108</span><br><span class="line">       11       825169</span><br><span class="line">       12       528041</span><br><span class="line">北京    1       1878234</span><br><span class="line">        2       1807787</span><br><span class="line">        3       1360666</span><br><span class="line">        4       1205989</span><br><span class="line">        5        807300</span><br><span class="line">        6       1216432</span><br><span class="line">        7       1219083</span><br><span class="line">        8        645727</span><br><span class="line">        9        390077</span><br><span class="line">        10       671608</span><br><span class="line">        11       678668</span><br><span class="line">        12       596146</span><br><span class="line">安徽    4        341308</span><br><span class="line">        5        554155</span><br><span class="line">广东    3        388180</span><br><span class="line">        8        469390</span><br><span class="line">        9        365191</span><br><span class="line">        11       395188</span><br><span class="line">江苏    4        537079</span><br><span class="line">        7        841032</span><br><span class="line">        10       710962</span><br><span class="line">        12       215307</span><br><span class="line">浙江    3        248354</span><br><span class="line">        8        439508</span><br><span class="line">福建    1       1852496</span><br><span class="line">        2       1111141</span><br><span class="line">        3       1106579</span><br><span class="line">        4        830207</span><br><span class="line">        5       1036351</span><br><span class="line">        6        816100</span><br><span class="line">        7        577283</span><br><span class="line">        8        658627</span><br><span class="line">        9        769999</span><br><span class="line">        10       580707</span><br><span class="line">        11       486258</span><br><span class="line">        12       352479</span><br><span class="line">Name: 销售额, dtype: int64</span><br></pre></td></tr></table></figure>
<p>如果希望统计出每个区域的销售总额以及每个区域单笔金额的最高和最低，我们可以在<code>DataFrame</code>或<code>Series</code>对象上使用<code>agg</code>方法并指定多个聚合函数，代码和结果如下所示。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.groupby(<span class="string">&#x27;销售区域&#x27;</span>).销售额.agg([<span class="string">&#x27;sum&#x27;</span>, <span class="string">&#x27;max&#x27;</span>, <span class="string">&#x27;min&#x27;</span>])</span><br></pre></td></tr></table></figure>
<p>输出：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">           sum     max   min</span><br><span class="line">销售区域                        </span><br><span class="line">上海    11610489  116303   948</span><br><span class="line">北京    12477717  133411   690</span><br><span class="line">安徽      895463   68502  1683</span><br><span class="line">广东     1617949  120807   990</span><br><span class="line">江苏     2304380  114312  1089</span><br><span class="line">浙江      687862   90909  3927</span><br><span class="line">福建    10178227   87527   897</span><br></pre></td></tr></table></figure>
<p>如果希望自定义聚合后的列的名字，可以使用如下所示的方法。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.groupby(<span class="string">&#x27;销售区域&#x27;</span>).销售额.agg(销售总额=<span class="string">&#x27;sum&#x27;</span>, 单笔最高=<span class="string">&#x27;max&#x27;</span>, 单笔最低=<span class="string">&#x27;min&#x27;</span>)</span><br></pre></td></tr></table></figure>
<p>输出：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">          销售总额    单笔最高  单笔最低</span><br><span class="line">销售区域                        </span><br><span class="line">上海      11610489     116303     948</span><br><span class="line">北京      12477717     133411     690</span><br><span class="line">安徽        895463      68502    1683</span><br><span class="line">广东       1617949     120807     990</span><br><span class="line">江苏       2304380     114312    1089</span><br><span class="line">浙江        687862      90909    3927</span><br><span class="line">福建      10178227      87527     897</span><br></pre></td></tr></table></figure>
<p>如果需要对多个列使用不同的聚合函数，例如“统计每个销售区域销售额的总和以及销售数量的最低值和最高值”，我们可以按照下面的方式来操作。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">df.groupby(<span class="string">&#x27;销售区域&#x27;</span>)[[<span class="string">&#x27;销售额&#x27;</span>, <span class="string">&#x27;销售数量&#x27;</span>]].agg(&#123;</span><br><span class="line">    <span class="string">&#x27;销售额&#x27;</span>: <span class="string">&#x27;sum&#x27;</span>, <span class="string">&#x27;销售数量&#x27;</span>: [<span class="string">&#x27;max&#x27;</span>, <span class="string">&#x27;min&#x27;</span>]</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p>输出：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">           销售额  销售数量    </span><br><span class="line">           sum    max min</span><br><span class="line">销售区域                   </span><br><span class="line">上海    11610489  100  10</span><br><span class="line">北京    12477717  100  10</span><br><span class="line">安徽      895463   98  16</span><br><span class="line">广东     1617949   98  10</span><br><span class="line">江苏     2304380  100  11</span><br><span class="line">浙江      687862   95  20</span><br><span class="line">福建    10178227  100  10</span><br></pre></td></tr></table></figure>
<h4 id="透视表和交叉表"><a class="markdownIt-Anchor" href="#透视表和交叉表"></a> 透视表和交叉表</h4>
<p>上面的例子中，“统计每个销售区域每个月的销售总额”会产生一个看起来很长的结果，在实际工作中我们通常把那些行很多列很少的表成为“窄表”，如果我们不想得到这样的一个“窄表”，可以使用<code>DataFrame</code>的<code>pivot_table</code>方法或者是<code>pivot_table</code>函数来生成透视表。透视表的本质就是对数据进行分组聚合操作，<strong>根据 A 列对 B 列进行统计</strong>，如果大家有使用 Excel 的经验，相信对透视表这个概念一定不会陌生。例如，我们要“统计每个销售区域的销售总额”，那么“销售区域”就是我们的 A 列，而“销售额”就是我们的 B 列，在<code>pivot_table</code>函数中分别对应<code>index</code>和<code>values</code>参数，这两个参数都可以是单个列或者多个列。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pd.pivot_table(df, index=<span class="string">&#x27;销售区域&#x27;</span>, values=<span class="string">&#x27;销售额&#x27;</span>, aggfunc=<span class="string">&#x27;sum&#x27;</span>)</span><br></pre></td></tr></table></figure>
<p>输出：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">           销售额</span><br><span class="line">销售区域          </span><br><span class="line">上海    11610489</span><br><span class="line">北京    12477717</span><br><span class="line">安徽      895463</span><br><span class="line">广东     1617949</span><br><span class="line">江苏     2304380</span><br><span class="line">浙江      687862</span><br><span class="line">福建    10178227</span><br></pre></td></tr></table></figure>
<blockquote>
<p><strong>注意</strong>：上面的结果操作跟之前用<code>groupby</code>的方式得到的结果有一些区别，<code>groupby</code>操作后，如果对单个列进行聚合，得到的结果是一个<code>Series</code>对象，而上面的结果是一个<code>DataFrame</code> 对象。</p>
</blockquote>
<p>如果要统计每个销售区域每个月的销售总额，也可以使用<code>pivot_table</code>函数，代码如下所示。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">df[<span class="string">&#x27;月份&#x27;</span>] = df[<span class="string">&#x27;销售日期&#x27;</span>].dt.month</span><br><span class="line">pd.pivot_table(df, index=[<span class="string">&#x27;销售区域&#x27;</span>, <span class="string">&#x27;月份&#x27;</span>], values=<span class="string">&#x27;销售额&#x27;</span>, aggfunc=<span class="string">&#x27;sum&#x27;</span>)</span><br></pre></td></tr></table></figure>
<p>上面的操作结果是一个<code>DataFrame</code>，但也是一个长长的“窄表”，如果希望做成一个行比较少列比较多的“宽表”，可以将<code>index</code>参数中的列放到<code>columns</code>参数中，代码如下所示。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pd.pivot_table(df, index=<span class="string">&#x27;销售区域&#x27;</span>, columns=<span class="string">&#x27;月份&#x27;</span>, values=<span class="string">&#x27;销售额&#x27;</span>, aggfunc=<span class="string">&#x27;sum&#x27;</span>, fill_value=<span class="number">0</span>)</span><br></pre></td></tr></table></figure>
<blockquote>
<p><strong>说明</strong>：<code>pivot_table</code>函数的<code>fill_value=0</code>会将空值处理为<code>0</code>。</p>
</blockquote>
<p>输出：</p>
<img src="/images/pivot_table_1.png" style="zoom:50%;">
<p>使用<code>pivot_table</code>函数时，还可以通过添加<code>margins</code>和<code>margins_name</code>参数对分组聚合的结果做一个汇总，具体的操作和效果如下所示。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pd.pivot_table(df, index=<span class="string">&#x27;销售区域&#x27;</span>, columns=<span class="string">&#x27;月份&#x27;</span>, values=<span class="string">&#x27;销售额&#x27;</span>, aggfunc=<span class="string">&#x27;sum&#x27;</span>, fill_value=<span class="number">0</span>, margins=<span class="literal">True</span>, margins_name=<span class="string">&#x27;总计&#x27;</span>)</span><br></pre></td></tr></table></figure>
<p>输出：</p>
<img src="/images/pivot_table_2.png" style="zoom:50%;">
<p>交叉表就是一种特殊的透视表，它不需要先构造一个<code>DataFrame</code>对象，而是直接通过数组或<code>Series</code>对象指定两个或多个因素进行运算得到统计结果。例如，我们要统计每个销售区域的销售总额，也可以按照如下所示的方式来完成，我们先准备三组数据。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sales_area, sales_month, sales_amount = df[<span class="string">&#x27;销售区域&#x27;</span>], df[<span class="string">&#x27;月份&#x27;</span>], df[<span class="string">&#x27;销售额&#x27;</span>]</span><br></pre></td></tr></table></figure>
<p>使用<code>crosstab</code>函数生成交叉表。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pd.crosstab(index=sales_area, columns=sales_month, values=sales_amount, aggfunc=<span class="string">&#x27;sum&#x27;</span>).fillna(<span class="number">0</span>).astype(<span class="string">&#x27;i8&#x27;</span>)</span><br></pre></td></tr></table></figure>
<blockquote>
<p><strong>说明</strong>：上面的代码使用了<code>DataFrame</code>对象的<code>fillna</code>方法将空值处理为0，再使用<code>astype</code>方法将数据类型处理成整数。</p>
</blockquote>
<h3 id="数据呈现"><a class="markdownIt-Anchor" href="#数据呈现"></a> 数据呈现</h3>
<p>一图胜千言，我们对数据进行透视的结果，最终要通过图表的方式呈现出来，因为图表具有极强的表现力，能够让我们迅速的解读数据中隐藏的价值。和<code>Series</code>一样，<code>DataFrame</code>对象提供了<code>plot</code>方法来支持绘图，底层仍然是通过<code>matplotlib</code>库实现图表的渲染。关于<code>matplotlib</code>的内容，我们在下一个章节进行详细的探讨，这里我们只简单的讲解<code>plot</code>方法的用法。</p>
<p>例如，我们想通过一张柱状图来比较“每个销售区域的销售总额”，可以直接在透视表上使用<code>plot</code>方法生成柱状图。我们先导入<code>matplotlib.pyplot</code>模块，通过修改绘图的参数使其支持中文显示。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"></span><br><span class="line">plt.rcParams[<span class="string">&#x27;font.sans-serif&#x27;</span>] = <span class="string">&#x27;FZJKai-Z03S&#x27;</span></span><br></pre></td></tr></table></figure>
<blockquote>
<p><strong>说明</strong>：上面的<code>FZJKai-Z03S</code>是我电脑上已经安装的一种支持中文的字体的名称，字体的名称可以通过查看用户主目录下<code>.matplotlib</code>文件夹下名为<code>fontlist-v330.json</code>的文件来获得，而这个文件在执行上面的命令后就会生成。</p>
</blockquote>
<p>使用魔法指令配置生成矢量图。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">%config InlineBackend.figure_format = <span class="string">&#x27;svg&#x27;</span></span><br></pre></td></tr></table></figure>
<p>绘制“每个销售区域销售总额”的柱状图。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">temp = pd.pivot_table(df, index=<span class="string">&#x27;销售区域&#x27;</span>, values=<span class="string">&#x27;销售额&#x27;</span>, aggfunc=<span class="string">&#x27;sum&#x27;</span>)</span><br><span class="line">temp.plot(figsize=(<span class="number">8</span>, <span class="number">4</span>), kind=<span class="string">&#x27;bar&#x27;</span>)</span><br><span class="line">plt.xticks(rotation=<span class="number">0</span>)</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>
<blockquote>
<p><strong>说明</strong>：上面的第3行代码会将横轴刻度上的文字旋转到0度，第4行代码会显示图像。</p>
</blockquote>
<p>输出：</p>
<img src="/images/sales_bar_graph.png" style="zoom:45%;">
<p>如果要绘制饼图，可以修改<code>plot</code>方法的<code>kind</code>参数为<code>pie</code>，然后使用定制饼图的参数对图表加以定制，代码如下所示。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">temp.sort_values(by=<span class="string">&#x27;销售额&#x27;</span>, ascending=<span class="literal">False</span>).plot(</span><br><span class="line">    figsize=(<span class="number">6</span>, <span class="number">6</span>),</span><br><span class="line">    kind=<span class="string">&#x27;pie&#x27;</span>,</span><br><span class="line">    y=<span class="string">&#x27;销售额&#x27;</span>,</span><br><span class="line">    ylabel=<span class="string">&#x27;&#x27;</span>,</span><br><span class="line">    autopct=<span class="string">&#x27;%.2f%%&#x27;</span>,</span><br><span class="line">    pctdistance=<span class="number">0.8</span>,</span><br><span class="line">    wedgeprops=<span class="built_in">dict</span>(linewidth=<span class="number">1</span>, width=<span class="number">0.35</span>),</span><br><span class="line">    legend=<span class="literal">False</span></span><br><span class="line">)</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>
<p>输出：</p>
<img src="/images/sales_pie_graph.png" style="zoom:35%;">

    </div>

    
    
    
        <div class="reward-container">
  <div>Buy me a coffee please.</div>
  <button onclick="var qr = document.getElementById('qr'); qr.style.display = (qr.style.display === 'none') ? 'block' : 'none';">
    Donate
  </button>
  <div id="qr" style="display: none;">
      
      <div style="display: inline-block;">
        <img src="/images/wechatpay.jpg" alt="lsqyling WeChat Pay">
        <p>WeChat Pay</p>
      </div>

  </div>
</div>


      <footer class="post-footer">
          
          <div class="post-tags">
              <a href="/tags/Python/" rel="tag"><i class="fa fa-tag"></i> Python</a>
          </div>

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/2025/03/03/coroutine/" rel="prev" title="Coroutine-协程">
      <i class="fa fa-chevron-left"></i> Coroutine-协程
    </a></div>
      <div class="post-nav-item"></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E9%87%8D%E8%A6%81%E7%9A%84%E8%AF%9D"><span class="nav-number">1.</span> <span class="nav-text"> 重要的话</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E8%AF%AD%E6%B3%95%E5%9F%BA%E7%A1%80"><span class="nav-number">2.</span> <span class="nav-text"> 语法基础</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%96%87%E4%BB%B6%E6%93%8D%E4%BD%9C"><span class="nav-number">3.</span> <span class="nav-text"> 文件操作</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%87%BD%E6%95%B0"><span class="nav-number">4.</span> <span class="nav-text"> 函数</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%9F%BA%E7%A1%80%E9%83%A8%E5%88%86"><span class="nav-number">4.1.</span> <span class="nav-text"> 基础部分</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%87%BD%E6%95%B0%E7%9A%84%E5%B5%8C%E5%A5%97"><span class="nav-number">4.2.</span> <span class="nav-text"> 函数的嵌套</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%97%AD%E5%8C%85"><span class="nav-number">4.3.</span> <span class="nav-text"> 闭包</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%A3%85%E9%A5%B0%E5%99%A8"><span class="nav-number">4.4.</span> <span class="nav-text"> 装饰器</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%BF%AD%E4%BB%A3%E5%99%A8"><span class="nav-number">4.5.</span> <span class="nav-text"> 迭代器</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%94%9F%E6%88%90%E5%99%A8"><span class="nav-number">4.6.</span> <span class="nav-text"> 生成器</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#lambda%E5%8C%BF%E5%90%8D%E5%87%BD%E6%95%B0"><span class="nav-number">4.7.</span> <span class="nav-text"> lambda匿名函数</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#python%E5%86%85%E7%BD%AE%E5%87%BD%E6%95%B0_%E4%B8%8B"><span class="nav-number">4.8.</span> <span class="nav-text"> python内置函数_下</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1%E7%BC%96%E7%A8%8B"><span class="nav-number">5.</span> <span class="nav-text"> 面向对象编程</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#python-%E8%BF%9B%E9%98%B6"><span class="nav-number">6.</span> <span class="nav-text"> Python 进阶</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#python%E4%B8%AD%E7%9A%84%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B"><span class="nav-number">7.</span> <span class="nav-text"> Python中的并发编程</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%BF%9B%E7%A8%8B%E5%92%8C%E7%BA%BF%E7%A8%8B"><span class="nav-number">7.1.</span> <span class="nav-text"> 进程和线程</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%A4%9A%E7%BA%BF%E7%A8%8B%E7%BC%96%E7%A8%8B"><span class="nav-number">7.2.</span> <span class="nav-text"> 多线程编程</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BD%BF%E7%94%A8-thread-%E7%B1%BB%E5%88%9B%E5%BB%BA%E7%BA%BF%E7%A8%8B%E5%AF%B9%E8%B1%A1"><span class="nav-number">7.3.</span> <span class="nav-text"> 使用 Thread 类创建线程对象</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%BB%A7%E6%89%BF-thread-%E7%B1%BB%E8%87%AA%E5%AE%9A%E4%B9%89%E7%BA%BF%E7%A8%8B"><span class="nav-number">7.4.</span> <span class="nav-text"> 继承 Thread 类自定义线程</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BD%BF%E7%94%A8%E7%BA%BF%E7%A8%8B%E6%B1%A0"><span class="nav-number">7.5.</span> <span class="nav-text"> 使用线程池</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%AE%88%E6%8A%A4%E7%BA%BF%E7%A8%8B"><span class="nav-number">7.6.</span> <span class="nav-text"> 守护线程</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%B5%84%E6%BA%90%E7%AB%9E%E4%BA%89"><span class="nav-number">7.7.</span> <span class="nav-text"> 资源竞争</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#gil%E9%97%AE%E9%A2%98"><span class="nav-number">7.8.</span> <span class="nav-text"> GIL问题</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%88%9B%E5%BB%BA%E8%BF%9B%E7%A8%8B"><span class="nav-number">7.9.</span> <span class="nav-text"> 创建进程</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%A4%9A%E8%BF%9B%E7%A8%8B%E5%92%8C%E5%A4%9A%E7%BA%BF%E7%A8%8B%E7%9A%84%E6%AF%94%E8%BE%83"><span class="nav-number">7.10.</span> <span class="nav-text"> 多进程和多线程的比较</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%BF%9B%E7%A8%8B%E9%97%B4%E9%80%9A%E4%BF%A1"><span class="nav-number">7.11.</span> <span class="nav-text"> 进程间通信</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%B9%B6%E5%8F%91%E4%B8%AD%E5%9B%9B%E4%B8%AA%E9%87%8D%E8%A6%81%E6%A6%82%E5%BF%B5"><span class="nav-number">7.12.</span> <span class="nav-text"> 并发中四个重要概念</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%94%9F%E6%88%90%E5%99%A8%E5%92%8C%E5%8D%8F%E7%A8%8B"><span class="nav-number">7.13.</span> <span class="nav-text"> 生成器和协程</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%BC%82%E6%AD%A5%E5%87%BD%E6%95%B0"><span class="nav-number">7.14.</span> <span class="nav-text"> 异步函数</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#aiohttp%E5%BA%93"><span class="nav-number">7.15.</span> <span class="nav-text"> aiohttp库</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#numpy%E7%9A%84%E5%BA%94%E7%94%A8"><span class="nav-number">8.</span> <span class="nav-text"> NumPy的应用</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%88%9B%E5%BB%BA%E6%95%B0%E7%BB%84%E5%AF%B9%E8%B1%A1"><span class="nav-number">8.1.</span> <span class="nav-text"> 创建数组对象</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%95%B0%E7%BB%84%E5%AF%B9%E8%B1%A1%E7%9A%84%E5%B1%9E%E6%80%A7"><span class="nav-number">8.2.</span> <span class="nav-text"> 数组对象的属性</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%95%B0%E7%BB%84%E7%9A%84%E7%B4%A2%E5%BC%95%E8%BF%90%E7%AE%97"><span class="nav-number">8.3.</span> <span class="nav-text"> 数组的索引运算</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%88%87%E7%89%87%E7%B4%A2%E5%BC%95"><span class="nav-number">8.4.</span> <span class="nav-text"> 切片索引</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%8A%B1%E5%BC%8F%E7%B4%A2%E5%BC%95"><span class="nav-number">8.5.</span> <span class="nav-text"> 花式索引</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%B8%83%E5%B0%94%E7%B4%A2%E5%BC%95"><span class="nav-number">8.6.</span> <span class="nav-text"> 布尔索引</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%A1%88%E4%BE%8B%E9%80%9A%E8%BF%87%E6%95%B0%E7%BB%84%E5%88%87%E7%89%87%E5%A4%84%E7%90%86%E5%9B%BE%E5%83%8F"><span class="nav-number">8.7.</span> <span class="nav-text"> 案例：通过数组切片处理图像</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%95%B0%E7%BB%84%E5%AF%B9%E8%B1%A1%E7%9A%84%E6%96%B9%E6%B3%95"><span class="nav-number">8.8.</span> <span class="nav-text"> 数组对象的方法</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%95%B0%E7%BB%84%E7%9A%84%E8%BF%90%E7%AE%97"><span class="nav-number">8.9.</span> <span class="nav-text"> 数组的运算</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%B9%BF%E6%92%AD%E6%9C%BA%E5%88%B6"><span class="nav-number">8.10.</span> <span class="nav-text"> 广播机制</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%85%B6%E4%BB%96%E5%B8%B8%E7%94%A8%E5%87%BD%E6%95%B0"><span class="nav-number">8.11.</span> <span class="nav-text"> 其他常用函数</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%90%91%E9%87%8F"><span class="nav-number">8.12.</span> <span class="nav-text"> 向量</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9F%A9%E9%98%B5%E5%AF%B9%E8%B1%A1"><span class="nav-number">8.13.</span> <span class="nav-text"> 矩阵对象</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%BA%BF%E6%80%A7%E4%BB%A3%E6%95%B0%E6%A8%A1%E5%9D%97"><span class="nav-number">8.14.</span> <span class="nav-text"> 线性代数模块</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%A4%9A%E9%A1%B9%E5%BC%8F"><span class="nav-number">8.15.</span> <span class="nav-text"> 多项式</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%88%9B%E5%BB%BA%E5%A4%9A%E9%A1%B9%E5%BC%8F%E5%AF%B9%E8%B1%A1"><span class="nav-number">8.15.1.</span> <span class="nav-text"> 创建多项式对象</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%A4%9A%E9%A1%B9%E5%BC%8F%E7%9A%84%E6%93%8D%E4%BD%9C"><span class="nav-number">8.15.2.</span> <span class="nav-text"> 多项式的操作</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%9C%80%E5%B0%8F%E4%BA%8C%E4%B9%98%E8%A7%A3"><span class="nav-number">8.16.</span> <span class="nav-text"> 最小二乘解</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#pandas"><span class="nav-number">9.</span> <span class="nav-text"> Pandas</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%88%9B%E5%BB%BAseries%E5%AF%B9%E8%B1%A1"><span class="nav-number">9.1.</span> <span class="nav-text"> 创建Series对象</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#series%E5%AF%B9%E8%B1%A1%E7%9A%84%E8%BF%90%E7%AE%97"><span class="nav-number">9.2.</span> <span class="nav-text"> Series对象的运算</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%A0%87%E9%87%8F%E8%BF%90%E7%AE%97"><span class="nav-number">9.2.1.</span> <span class="nav-text"> 标量运算</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%9F%A2%E9%87%8F%E8%BF%90%E7%AE%97"><span class="nav-number">9.2.2.</span> <span class="nav-text"> 矢量运算</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%B4%A2%E5%BC%95%E8%BF%90%E7%AE%97"><span class="nav-number">9.2.3.</span> <span class="nav-text"> 索引运算</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E6%99%AE%E9%80%9A%E7%B4%A2%E5%BC%95"><span class="nav-number">9.2.3.1.</span> <span class="nav-text"> 普通索引</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%88%87%E7%89%87%E7%B4%A2%E5%BC%95-2"><span class="nav-number">9.2.3.2.</span> <span class="nav-text"> 切片索引</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E8%8A%B1%E5%BC%8F%E7%B4%A2%E5%BC%95-2"><span class="nav-number">9.2.3.3.</span> <span class="nav-text"> 花式索引</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%B8%83%E5%B0%94%E7%B4%A2%E5%BC%95-2"><span class="nav-number">9.2.3.4.</span> <span class="nav-text"> 布尔索引</span></a></li></ol></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#series%E5%AF%B9%E8%B1%A1%E7%9A%84%E5%B1%9E%E6%80%A7%E5%92%8C%E6%96%B9%E6%B3%95"><span class="nav-number">9.3.</span> <span class="nav-text"> Series对象的属性和方法</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%BB%9F%E8%AE%A1%E7%9B%B8%E5%85%B3"><span class="nav-number">9.3.1.</span> <span class="nav-text"> 统计相关</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%A4%84%E7%90%86%E6%95%B0%E6%8D%AE"><span class="nav-number">9.3.2.</span> <span class="nav-text"> 处理数据</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%8F%96%E5%A4%B4%E9%83%A8%E5%80%BC%E5%92%8C%E6%8E%92%E5%BA%8F"><span class="nav-number">9.3.3.</span> <span class="nav-text"> 取头部值和排序</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%BB%98%E5%88%B6%E5%9B%BE%E8%A1%A8"><span class="nav-number">9.3.4.</span> <span class="nav-text"> 绘制图表</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%88%9B%E5%BB%BAdataframe%E5%AF%B9%E8%B1%A1"><span class="nav-number">9.4.</span> <span class="nav-text"> 创建DataFrame对象</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E9%80%9A%E8%BF%87%E4%BA%8C%E7%BB%B4%E6%95%B0%E7%BB%84%E5%88%9B%E5%BB%BAdataframe%E5%AF%B9%E8%B1%A1"><span class="nav-number">9.4.1.</span> <span class="nav-text"> 通过二维数组创建DataFrame对象</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E9%80%9A%E8%BF%87%E5%AD%97%E5%85%B8%E5%88%9B%E5%BB%BAdataframe%E5%AF%B9%E8%B1%A1"><span class="nav-number">9.4.2.</span> <span class="nav-text"> 通过字典创建DataFrame对象</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%AF%BB%E5%8F%96csv%E6%96%87%E4%BB%B6%E5%88%9B%E5%BB%BAdataframe%E5%AF%B9%E8%B1%A1"><span class="nav-number">9.4.3.</span> <span class="nav-text"> 读取CSV文件创建DataFrame对象</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%AF%BB%E5%8F%96excel%E5%B7%A5%E4%BD%9C%E8%A1%A8%E5%88%9B%E5%BB%BAdataframe%E5%AF%B9%E8%B1%A1"><span class="nav-number">9.4.4.</span> <span class="nav-text"> 读取Excel工作表创建DataFrame对象</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%AF%BB%E5%8F%96%E5%85%B3%E7%B3%BB%E6%95%B0%E6%8D%AE%E5%BA%93%E4%BA%8C%E7%BB%B4%E8%A1%A8%E5%88%9B%E5%BB%BAdataframe%E5%AF%B9%E8%B1%A1"><span class="nav-number">9.4.5.</span> <span class="nav-text"> 读取关系数据库二维表创建DataFrame对象</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%9F%BA%E6%9C%AC%E5%B1%9E%E6%80%A7%E5%92%8C%E6%96%B9%E6%B3%95"><span class="nav-number">9.4.6.</span> <span class="nav-text"> 基本属性和方法</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%93%8D%E4%BD%9C%E6%95%B0%E6%8D%AE"><span class="nav-number">9.4.7.</span> <span class="nav-text"> 操作数据</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E7%B4%A2%E5%BC%95%E5%92%8C%E5%88%87%E7%89%87"><span class="nav-number">9.4.7.1.</span> <span class="nav-text"> 索引和切片</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E6%95%B0%E6%8D%AE%E7%AD%9B%E9%80%89"><span class="nav-number">9.4.7.2.</span> <span class="nav-text"> 数据筛选</span></a></li></ol></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%95%B0%E6%8D%AE%E9%87%8D%E5%A1%91"><span class="nav-number">9.5.</span> <span class="nav-text"> 数据重塑</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%95%B0%E6%8D%AE%E6%B8%85%E6%B4%97"><span class="nav-number">9.6.</span> <span class="nav-text"> 数据清洗</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%BC%BA%E5%A4%B1%E5%80%BC"><span class="nav-number">9.6.1.</span> <span class="nav-text"> 缺失值</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E9%87%8D%E5%A4%8D%E5%80%BC"><span class="nav-number">9.6.2.</span> <span class="nav-text"> 重复值</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%BC%82%E5%B8%B8%E5%80%BC"><span class="nav-number">9.6.3.</span> <span class="nav-text"> 异常值</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E9%A2%84%E5%A4%84%E7%90%86"><span class="nav-number">9.6.4.</span> <span class="nav-text"> 预处理</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%95%B0%E6%8D%AE%E9%80%8F%E8%A7%86"><span class="nav-number">9.7.</span> <span class="nav-text"> 数据透视</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%8E%B7%E5%8F%96%E6%8F%8F%E8%BF%B0%E6%80%A7%E7%BB%9F%E8%AE%A1%E4%BF%A1%E6%81%AF"><span class="nav-number">9.7.1.</span> <span class="nav-text"> 获取描述性统计信息</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%8E%92%E5%BA%8F%E5%92%8C%E5%8F%96%E5%A4%B4%E9%83%A8%E5%80%BC"><span class="nav-number">9.7.2.</span> <span class="nav-text"> 排序和取头部值</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%88%86%E7%BB%84%E8%81%9A%E5%90%88"><span class="nav-number">9.7.3.</span> <span class="nav-text"> 分组聚合</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E9%80%8F%E8%A7%86%E8%A1%A8%E5%92%8C%E4%BA%A4%E5%8F%89%E8%A1%A8"><span class="nav-number">9.7.4.</span> <span class="nav-text"> 透视表和交叉表</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%95%B0%E6%8D%AE%E5%91%88%E7%8E%B0"><span class="nav-number">9.8.</span> <span class="nav-text"> 数据呈现</span></a></li></ol></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="lsqyling"
      src="/images/rabbit_cartoon.jpeg">
  <p class="site-author-name" itemprop="name">lsqyling</p>
  <div class="site-description" itemprop="description">技术分享</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">16</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">21</span>
        <span class="site-state-item-name">tags</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="https://github.com/lsqyling" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;lsqyling" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="/1058018384@qq.com" title="E-Mail → 1058018384@qq.com"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://space.bilibili.com/354741030/favlist" title="Bilibili → https:&#x2F;&#x2F;space.bilibili.com&#x2F;354741030&#x2F;favlist" rel="noopener" target="_blank"><i class="fa custom bilibili fa-fw"></i>Bilibili</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://weibo.com/" title="Weibo → https:&#x2F;&#x2F;weibo.com" rel="noopener" target="_blank"><i class="fab fa-weibo fa-fw"></i>Weibo</a>
      </span>
  </div>



      </div>
        <div class="back-to-top motion-element">
          <i class="fa fa-arrow-up"></i>
          <span>0%</span>
        </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2025</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">lsqyling</span>
</div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/pjax/pjax.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>

  <script>
var pjax = new Pjax({
  selectors: [
    'head title',
    '#page-configurations',
    '.content-wrap',
    '.post-toc-wrap',
    '.languages',
    '#pjax'
  ],
  switches: {
    '.post-toc-wrap': Pjax.switches.innerHTML
  },
  analytics: false,
  cacheBust: false,
  scrollTo : !CONFIG.bookmark.enable
});

window.addEventListener('pjax:success', () => {
  document.querySelectorAll('script[data-pjax], script#page-configurations, #pjax script').forEach(element => {
    var code = element.text || element.textContent || element.innerHTML || '';
    var parent = element.parentNode;
    parent.removeChild(element);
    var script = document.createElement('script');
    if (element.id) {
      script.id = element.id;
    }
    if (element.className) {
      script.className = element.className;
    }
    if (element.type) {
      script.type = element.type;
    }
    if (element.src) {
      script.src = element.src;
      // Force synchronous loading of peripheral JS.
      script.async = false;
    }
    if (element.dataset.pjax !== undefined) {
      script.dataset.pjax = '';
    }
    if (code !== '') {
      script.appendChild(document.createTextNode(code));
    }
    parent.appendChild(script);
  });
  NexT.boot.refresh();
  // Define Motion Sequence & Bootstrap Motion.
  if (CONFIG.motion.enable) {
    NexT.motion.integrator
      .init()
      .add(NexT.motion.middleWares.subMenu)
      .add(NexT.motion.middleWares.postList)
      .bootstrap();
  }
  NexT.utils.updateSidebarPosition();
});
</script>




  




  
<script src="/js/local-search.js"></script>













    <div id="pjax">
  

  

  

    </div>
</body>
</html>
